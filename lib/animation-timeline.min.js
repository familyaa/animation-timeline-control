!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.timelineModule=t():e.timelineModule=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function r(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t);if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===n(t)?t:String(t)}e.r(t),e.d(t,{Timeline:()=>Ue,TimelineCapShape:()=>Ce,TimelineClickEvent:()=>ve,TimelineCursorType:()=>xe,TimelineDragEvent:()=>Re,TimelineDraggableData:()=>P,TimelineElementType:()=>g,TimelineEventSource:()=>W,TimelineEvents:()=>Ee,TimelineEventsEmitter:()=>l,TimelineInteractionMode:()=>ke,TimelineKeyframeChangedEvent:()=>L,TimelineKeyframeShape:()=>i,TimelineScrollSource:()=>Te,TimelineSelectedEvent:()=>oe,TimelineSelectionMode:()=>Me,TimelineStyleUtils:()=>S,TimelineTimeChangedEvent:()=>q,TimelineUtils:()=>d,defaultGroupStyle:()=>y,defaultRowHeight:()=>v,defaultTimelineConsts:()=>De,defaultTimelineKeyframeStyle:()=>p,defaultTimelineOptions:()=>je,defaultTimelineRowStyle:()=>_,defaultTimelineStyle:()=>Oe});var i,l=function(){function e(){var t,n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,o=[],(n=r(n="_subscriptions"))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o}var t,n;return t=e,(n=[{key:"on",value:function(e,t){return!!t&&(this._subscriptions.push({topic:e,callback:t}),!0)}},{key:"off",value:function(e,t){var n=this._subscriptions.length;return this._subscriptions=this._subscriptions.filter((function(n){return n&&n.callback!=t&&n.topic!=e})),n!==this._subscriptions.length}},{key:"offAll",value:function(){this._subscriptions.length=0}},{key:"emit",value:function(e,t){this._subscriptions.forEach((function(n){(null==n?void 0:n.topic)===e&&null!=n&&n.callback&&n.callback(t)}))}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,u(o.key),o)}}function c(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){var t=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===a(t)?t:String(t)}!function(e){e.None="none",e.Rhomb="rhomb",e.Circle="circle",e.Rect="rect"}(i||(i={}));var f=[1,2,5,10],d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"drawLine",value:function(e,t,n,o,r){e.moveTo(t,n),e.lineTo(o,r)}},{key:"isNumber",value:function(e){return!("number"!=typeof e||!e&&0!==e||isNaN(e)||!Number.isFinite(e))}},{key:"deleteElement",value:function(e,t){var n=e.indexOf(t);return-1!==n?e.splice(n,1):e}},{key:"isOverlap",value:function(e,t,n){return!!n&&n.x<=e&&n.x+n.width>=e&&n.y<=t&&n.y+n.height>=t}},{key:"findGoodStep",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t<=0||isNaN(t)||!Number.isFinite(t))return t;for(var o=t,r=null,i=e.getPowArgument(t),l=0;l<f.length;l++){var a=f[l],s=a*Math.pow(10,i);if(!n||n%s==0){var c=e.getDistance(t,s);if(0==c||c<=.1&&i>0){r=c,o=s;break}(!r||r>c)&&(r=c,o=s)}}return o}},{key:"keepInBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.isNumber(t)&&(e.isNumber(n)&&(n||0===n)&&(t=Math.max(t,n)),e.isNumber(o)&&(o||0===o)&&(t=Math.min(t,o))),t}},{key:"setMinMax",value:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n||!t)return t;var r=n?n.min:Number.NaN,i=t.min,l=(r||0===r)&&e.isNumber(r),a=(i||0===i)&&e.isNumber(i);l&&a?t.min=o?Math.min(r,i):Math.max(r,i):l&&(t.min=r);var s=n?n.max:Number.NaN,c=t.max,u=(s||0===s)&&e.isNumber(s),f=(c||0===c)&&e.isNumber(c);return u&&f?t.max=o?Math.max(s,c):Math.min(s,c):u&&(t.max=s),t}},{key:"shrinkSelf",value:function(e,t){return e?(e.x-=t,e.y-=t,e.width+=t,e.height+=t,e):e}},{key:"isRectIntersects",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||!t)return console.log("Rectangles cannot be empty"),!1;var o=t.x+t.width,r=t.y+t.height;return n?e.x<=o&&t.x<=e.x+e.width&&e.y<=r&&t.y<=e.y+e.height:e.x<o&&t.x<e.x+e.width&&e.y<r&&t.y<e.y+e.height}},{key:"getDistance",value:function(e,t,n,o){return null!=n&&null!=o?Math.sqrt(Math.pow(e-n,2)+Math.pow(t-o,2)):Math.abs(e-t)}},{key:"sign",value:function(e){return e>=0?1:-1}},{key:"clearBrowserSelection",value:function(){if(window)if(window.getSelection){var e=window.getSelection();e&&e.removeAllRanges()}else{var t=window.document;t.selection&&t.selection.empty()}}},{key:"getPowArgument",value:function(e){if(!e||0===e||!isFinite(e))return 1;if(e>=10&&e<100)return 1;if(e>=100&&e<1e3)return 2;if(e>=1e3&&e<1e4)return 3;e=Math.abs(e);var t=0,n=this.sign(e);if(e>1){for(;e>=1;)e=Math.floor(e/10),t++;return n*t-1}return e>0?Math.floor(Math.log(e)/Math.log(10)+1)-1:1}},{key:"mergeOptions",value:function(t,n){n=n||{};var o=e.cloneOptions(t);return function e(t,n){if(t&&n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&void 0!==n[o]&&("object"===a(n[o])?"id"===o?n[o]&&n[o]!==t[o]&&(t[o]=n[o]):t[o]?e(t[o],n[o]):t[o]=n[o]:t[o]=n[o])}(o,n),o}}],null&&s(t.prototype,null),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();c(d,"deepClone",(function(e){return JSON.parse(JSON.stringify(e))})),c(d,"cloneOptions",(function(e){var t=JSON.parse(JSON.stringify(e,(function(e,t){return"id"===e?void 0:t})));return t.id=e.id,t}));var v=24,y={height:"auto",marginTop:4,fillColor:"#0B71E6"},p={fillColor:"#FFFFFF",shape:i.Rhomb,selectedFillColor:"#FFEE32",strokeColor:"black",selectedStrokeColor:"black",strokeThickness:.2,height:"auto",width:"auto"},_={height:v,marginBottom:2,fillColor:"#252526",keyframesStyle:p,groupsStyle:y};function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,r=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==m(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key,"string"),"symbol"===m(r)?r:String(r)),o)}var r}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var g,b="undefined",S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"getGroup",value:function(e){return e&&"string"==typeof e?null:e||null}},{key:"getGroupStyle",value:function(t){var n;return(null===(n=e.getGroup(t))||void 0===n?void 0:n.style)||null}},{key:"getFirstSet",value:function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return e.getValue.apply(e,[t,!1].concat(o))}},{key:"getValue",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[],r=!1,i=arguments.length,l=new Array(i>2?i-2:0),a=2;a<i;a++)l[a-2]=arguments[a];l.forEach((function(e){if(!r&&m(e)!==b){if("number"==typeof e){if(!d.isNumber(e))return}else{if("boolean"==typeof e)return o.push(e),void(n&&!1===e&&(r=!0));if(!e)return}o.push(e)}}));var s=o&&o.length>0?o[0]:t;return!r&&e.getValueOrDefault(s,t)}},{key:"getValueOrDefault",value:function(e,t){return m(e)===b?t:"boolean"==typeof e?e:"number"==typeof e?e||0===e?e:t:e||t}},{key:"keyframeWidth",value:function(t,n,o,r){var i,l,a,s,c,u,f,d,v,y,_;return e.getFirstSet(p.width||"",null==t||null===(i=t.style)||void 0===i?void 0:i.width,null===(l=e.getGroupStyle(n))||void 0===l||null===(a=l.keyframesStyle)||void 0===a?void 0:a.width,null==o||null===(s=o.keyframesStyle)||void 0===s?void 0:s.width,null==o||null===(c=o.groupsStyle)||void 0===c||null===(u=c.keyframesStyle)||void 0===u?void 0:u.width,null==r||null===(f=r.rowsStyle)||void 0===f||null===(d=f.groupsStyle)||void 0===d||null===(v=d.keyframesStyle)||void 0===v?void 0:v.width,null==r||null===(y=r.rowsStyle)||void 0===y||null===(_=y.keyframesStyle)||void 0===_?void 0:_.width)}},{key:"keyframeHeight",value:function(t,n,o,r){var i,l,a,s,c,u,f,d,v,y,_;return e.getFirstSet(p.height||"",null==t||null===(i=t.style)||void 0===i?void 0:i.height,null===(l=e.getGroupStyle(n))||void 0===l||null===(a=l.keyframesStyle)||void 0===a?void 0:a.height,null==o||null===(s=o.keyframesStyle)||void 0===s?void 0:s.height,null==o||null===(c=o.groupsStyle)||void 0===c||null===(u=c.keyframesStyle)||void 0===u?void 0:u.height,null==r||null===(f=r.rowsStyle)||void 0===f||null===(d=f.groupsStyle)||void 0===d||null===(v=d.keyframesStyle)||void 0===v?void 0:v.height,null==r||null===(y=r.rowsStyle)||void 0===y||null===(_=y.keyframesStyle)||void 0===_?void 0:_.height)}},{key:"keyframeShape",value:function(t,n,o,r){var l,a,s,c,u,f,d,v,y,_,h,m=p.shape||i.Rhomb;return e.getFirstSet(m,null==t||null===(l=t.style)||void 0===l?void 0:l.shape,null===(a=e.getGroupStyle(n))||void 0===a||null===(s=a.keyframesStyle)||void 0===s?void 0:s.shape,null==o||null===(c=o.groupsStyle)||void 0===c||null===(u=c.keyframesStyle)||void 0===u?void 0:u.shape,null==o||null===(f=o.keyframesStyle)||void 0===f?void 0:f.shape,n?null==r||null===(d=r.rowsStyle)||void 0===d||null===(v=d.groupsStyle)||void 0===v||null===(y=v.keyframesStyle)||void 0===y?void 0:y.shape:void 0,null==r||null===(_=r.rowsStyle)||void 0===_||null===(h=_.keyframesStyle)||void 0===h?void 0:h.shape)}},{key:"keyframeFillColor",value:function(t,n,o,r){var i,l,a,s,c,u,f,d,v,y,_,h=p.fillColor||"";return e.getFirstSet(h,null==t||null===(i=t.style)||void 0===i?void 0:i.fillColor,null===(l=e.getGroupStyle(n))||void 0===l||null===(a=l.keyframesStyle)||void 0===a?void 0:a.fillColor,null==o||null===(s=o.groupsStyle)||void 0===s||null===(c=s.keyframesStyle)||void 0===c?void 0:c.fillColor,null==o||null===(u=o.keyframesStyle)||void 0===u?void 0:u.fillColor,n?null==r||null===(f=r.rowsStyle)||void 0===f||null===(d=f.groupsStyle)||void 0===d||null===(v=d.keyframesStyle)||void 0===v?void 0:v.fillColor:void 0,null==r||null===(y=r.rowsStyle)||void 0===y||null===(_=y.keyframesStyle)||void 0===_?void 0:_.fillColor)}},{key:"keyframeSelectedFillColor",value:function(t,n,o,r){var i,l,a,s,c,u,f,d,v,y,_,h=p.selectedFillColor||"";return e.getFirstSet(h,null==t||null===(i=t.style)||void 0===i?void 0:i.selectedFillColor,null===(l=e.getGroupStyle(n))||void 0===l||null===(a=l.keyframesStyle)||void 0===a?void 0:a.selectedFillColor,null==o||null===(s=o.groupsStyle)||void 0===s||null===(c=s.keyframesStyle)||void 0===c?void 0:c.selectedFillColor,null==o||null===(u=o.keyframesStyle)||void 0===u?void 0:u.selectedFillColor,n?null==r||null===(f=r.rowsStyle)||void 0===f||null===(d=f.groupsStyle)||void 0===d||null===(v=d.keyframesStyle)||void 0===v?void 0:v.selectedFillColor:void 0,null==r||null===(y=r.rowsStyle)||void 0===y||null===(_=y.keyframesStyle)||void 0===_?void 0:_.selectedFillColor)}},{key:"keyframeStrokeThickness",value:function(t,n,o,r){var i,l,a,s,c,u,f,d,v,y,_,h=p.strokeThickness||0;return e.getFirstSet(h,null==t||null===(i=t.style)||void 0===i?void 0:i.strokeThickness,null===(l=e.getGroupStyle(n))||void 0===l||null===(a=l.keyframesStyle)||void 0===a?void 0:a.strokeThickness,null==o||null===(s=o.groupsStyle)||void 0===s||null===(c=s.keyframesStyle)||void 0===c?void 0:c.strokeThickness,null==o||null===(u=o.keyframesStyle)||void 0===u?void 0:u.strokeThickness,n?null==r||null===(f=r.rowsStyle)||void 0===f||null===(d=f.groupsStyle)||void 0===d||null===(v=d.keyframesStyle)||void 0===v?void 0:v.strokeThickness:void 0,null==r||null===(y=r.rowsStyle)||void 0===y||null===(_=y.keyframesStyle)||void 0===_?void 0:_.strokeThickness)}},{key:"keyframeStrokeColor",value:function(t,n,o,r){var i,l,a,s,c,u,f,d,v,y,_,h=p.strokeColor||"";return e.getFirstSet(h,null==t||null===(i=t.style)||void 0===i?void 0:i.strokeColor,null===(l=e.getGroupStyle(n))||void 0===l||null===(a=l.keyframesStyle)||void 0===a?void 0:a.strokeColor,null==o||null===(s=o.groupsStyle)||void 0===s||null===(c=s.keyframesStyle)||void 0===c?void 0:c.strokeColor,null==o||null===(u=o.keyframesStyle)||void 0===u?void 0:u.strokeColor,n?null==r||null===(f=r.rowsStyle)||void 0===f||null===(d=f.groupsStyle)||void 0===d||null===(v=d.keyframesStyle)||void 0===v?void 0:v.strokeColor:void 0,null==r||null===(y=r.rowsStyle)||void 0===y||null===(_=y.keyframesStyle)||void 0===_?void 0:_.strokeColor)}},{key:"keyframeSelectedStrokeColor",value:function(t,n,o,r){var i,l,a,s,c,u,f,d,v,y,_,h=p.selectedStrokeColor||"";return e.getFirstSet(h,null==t||null===(i=t.style)||void 0===i?void 0:i.selectedStrokeColor,null===(l=e.getGroupStyle(n))||void 0===l||null===(a=l.keyframesStyle)||void 0===a?void 0:a.selectedStrokeColor,null==o||null===(s=o.groupsStyle)||void 0===s||null===(c=s.keyframesStyle)||void 0===c?void 0:c.selectedStrokeColor,null==o||null===(u=o.keyframesStyle)||void 0===u?void 0:u.selectedStrokeColor,n?null==r||null===(f=r.rowsStyle)||void 0===f||null===(d=f.groupsStyle)||void 0===d||null===(v=d.keyframesStyle)||void 0===v?void 0:v.selectedStrokeColor:void 0,null==r||null===(y=r.rowsStyle)||void 0===y||null===(_=y.keyframesStyle)||void 0===_?void 0:_.selectedStrokeColor)}},{key:"groupHeight",value:function(t,n,o){var r,i,l,a;return e.getFirstSet(y.height||"auto",null===(r=e.getGroupStyle(n))||void 0===r?void 0:r.height,null==o||null===(i=o.groupsStyle)||void 0===i?void 0:i.height,null==t||null===(l=t.rowsStyle)||void 0===l||null===(a=l.groupsStyle)||void 0===a?void 0:a.height)}},{key:"groupMarginTop",value:function(t,n,o){var r,i,l,a;return e.getFirstSet(y.marginTop||"auto",null===(r=e.getGroupStyle(n))||void 0===r?void 0:r.marginTop,null==o||null===(i=o.groupsStyle)||void 0===i?void 0:i.marginTop,null==t||null===(l=t.rowsStyle)||void 0===l||null===(a=l.groupsStyle)||void 0===a?void 0:a.marginTop)}},{key:"groupFillColor",value:function(t,n,o){var r,i,l,a;return e.getFirstSet(y.fillColor||"",null===(r=e.getGroupStyle(n))||void 0===r?void 0:r.fillColor,null==o||null===(i=o.groupsStyle)||void 0===i?void 0:i.fillColor,null==t||null===(l=t.rowsStyle)||void 0===l||null===(a=l.groupsStyle)||void 0===a?void 0:a.fillColor)}},{key:"getRowHeight",value:function(t,n){var o,r=_.height||0;return e.getFirstSet(r,null==t?void 0:t.height,null==n||null===(o=n.rowsStyle)||void 0===o?void 0:o.height)}},{key:"getRowMarginBottom",value:function(t,n){var o,r=_.marginBottom||0;return e.getFirstSet(r,null==t?void 0:t.marginBottom,null==n||null===(o=n.rowsStyle)||void 0===o?void 0:o.marginBottom)}},{key:"getRowFillColor",value:function(t,n){var o,r=_.fillColor||"";return e.getFirstSet(r,null==t?void 0:t.fillColor,null==n||null===(o=n.rowsStyle)||void 0===o?void 0:o.fillColor)}},{key:"headerHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return(null==e?void 0:e.headerHeight)||t}},{key:"keyframeDraggable",value:function(t,n,o,r){var i,l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!0,s=e.getValue(l,a,null==t?void 0:t.draggable,null===(i=e.getGroup(n))||void 0===i?void 0:i.keyframesDraggable,null==o?void 0:o.keyframesDraggable,null==r?void 0:r.keyframesDraggable);return s}},{key:"groupDraggable",value:function(t,n,o){var r;return e.getValue(!0,!0,null===(r=e.getGroup(t))||void 0===r?void 0:r.draggable,null==n?void 0:n.groupsDraggable,null==o?void 0:o.groupsDraggable)}}],null&&h(t.prototype,null),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,M(o.key),o)}}function x(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function C(e,t,n){return(t=M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e){var t=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==w(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===w(t)?t:String(t)}!function(e){e.Timeline="timeline",e.Keyframe="keyframe",e.Group="group",e.Row="row",e.None="none"}(g||(g={}));var P=x((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),C(this,"changed",!1),C(this,"target",void 0),C(this,"elements",void 0),C(this,"type",g.None),C(this,"val",void 0),C(this,"prevVal",void 0)}));function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,R(o.key),o)}}function R(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==E(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===E(t)?t:String(t)}var D=function(){function e(){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,(n=R(n="_prevented"))in t?Object.defineProperty(t,n,{value:false,enumerable:!0,configurable:!0,writable:!0}):t[n]=false}var t,n;return t=e,(n=[{key:"preventDefault",value:function(){this._prevented=!0}},{key:"isPrevented",value:function(){return this._prevented}}])&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},F(e,t)}function N(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return z(e)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}function K(e,t,n){return(t=V(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e){var t=function(e,t){if("object"!==O(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==O(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===O(t)?t:String(t)}var W,L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(i,e);var t,n,o,r=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(n);if(o){var r=A(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return N(this,e)});function i(){var e;j(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return K(z(e=r.call.apply(r,[this].concat(n))),"val",void 0),K(z(e),"prevVal",void 0),K(z(e),"target",void 0),K(z(e),"source",void 0),e}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(D);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}function H(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return G(e)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},U(e)}function X(e,t,n){return(t=Y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e){var t=function(e,t){if("object"!==B(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==B(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===B(t)?t:String(t)}!function(e){e.User="user",e.Programmatically="programmatically",e.SetTimeMethod="setTimeMethod"}(W||(W={}));var J,q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(i,e);var t,n,o,r=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=U(n);if(o){var r=U(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return H(this,e)});function i(){var e;I(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return X(G(e=r.call.apply(r,[this].concat(n))),"val",0),X(G(e),"prevVal",0),X(G(e),"source",W.User),e}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(D);function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function Q(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ne(o.key),o)}}function ee(e,t,n){return t&&Q(e.prototype,t),n&&Q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function te(e,t,n){return(t=ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e){var t=function(e,t){if("object"!==$(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==$(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===$(t)?t:String(t)}!function(e){e.Keyframes="keyframes"}(J||(J={}));var oe=ee((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),te(this,"selected",[]),te(this,"changed",[]),te(this,"mode",J.Keyframes),te(this,"drag",[])}));function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function le(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,de(o.key),o)}}function ae(e,t){return ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ae(e,t)}function se(e,t){if(t&&("object"===re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ce(e)}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ue(e)}function fe(e,t,n){return(t=de(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function de(e){var t=function(e,t){if("object"!==re(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==re(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===re(t)?t:String(t)}var ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ae(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ue(o);if(r){var n=ue(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return se(this,e)});function l(){var e;ie(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return fe(ce(e=i.call.apply(i,[this].concat(n))),"args",null),fe(ce(e),"elements",[]),fe(ce(e),"target",null),fe(ce(e),"point",null),e}return t=l,(n=[{key:"pos",get:function(){var e;return(null===(e=this.point)||void 0===e?void 0:e.pos)||null}},{key:"val",get:function(){return this.point?this.point.val:NaN}}])&&le(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(D);function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,we(o.key),o)}}function he(e,t){return he=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},he(e,t)}function me(e,t){if(t&&("object"===ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ge(e)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},be(e)}function Se(e,t,n){return(t=we(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e){var t=function(e,t){if("object"!==ye(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==ye(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===ye(t)?t:String(t)}var ke,xe,Ce,Me,Pe,Ee,Te,Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=be(o);if(r){var n=be(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return me(this,e)});function l(){var e;pe(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return Se(ge(e=i.call.apply(i,[this].concat(n))),"args",null),Se(ge(e),"elements",null),Se(ge(e),"target",null),Se(ge(e),"point",null),Se(ge(e),"prevPoint",null),e}return t=l,(n=[{key:"pos",get:function(){var e;return(null===(e=this.point)||void 0===e?void 0:e.pos)||null}}])&&_e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(D);!function(e){e.Selection="selection",e.Pan="pan",e.NonInteractivePan="nonInteractivePan",e.Zoom="zoom",e.None="none"}(ke||(ke={})),function(e){e.Alias="alias",e.AllScroll="all-scroll",e.Auto="auto",e.Cell="cell",e.ContextMenu="context-menu",e.ColResize="col-resize",e.Copy="copy",e.Crosshair="crosshair",e.Default="default",e.EResize="e-resize",e.EWResize="ew-resize",e.Grab="grab",e.Grabbing="grabbing",e.Help="help",e.Move="move",e.NResize="n-resize",e.NEResize="ne-resize",e.NESWResize="nesw-resize",e.NSResize="ns-resize",e.NWResize="nw-resize",e.NWSEResize="nwse-resize",e.NoDrop="no-drop",e.None="none",e.NotAllowed="not-allowed",e.Pointer="pointer",e.Progress="progress",e.RowResize="row-resize",e.SResize="s-resize",e.SEResize="se-resize",e.SWResize="sw-resize",e.Text="text",e.WResize="w-resize",e.Wait="wait",e.ZoomIn="zoom-in",e.ZoomOut="zoom-out"}(xe||(xe={})),function(e){e.None="none",e.Triangle="triangle",e.Rect="rect"}(Ce||(Ce={})),function(e){e.Normal="normal",e.Append="append",e.Revert="revert"}(Me||(Me={})),function(e){e.keyframe="keyframe",e.group="group"}(Pe||(Pe={})),function(e){e.Selected="selected",e.TimeChanged="timechanged",e.KeyframeChanged="keyframeChanged",e.DragStarted="dragStarted",e.Drag="drag",e.DragFinished="dragFinished",e.Scroll="scroll",e.ScrollFinished="scrollFinished",e.DoubleClick="doubleClick",e.MouseDown="mouseDown",e.Zoom="zoom"}(Ee||(Ee={})),function(e){e.DefaultMode="none",e.ZoomMode="zoom",e.ScrollBySelection="scrollBySelection"}(Te||(Te={}));var De={autoPanSpeed:50,scrollByDragSpeed:.12,clickDetectionMs:120,doubleClickTimeoutMs:400,scrollFinishedTimeoutMs:500,autoPanByScrollPadding:10,clickThreshold:3,clickDetectionMinRadius:2,autoPanSpeedLimit:10,defaultGroupHeight:.7},Oe={width:2,marginTop:15,marginBottom:0,strokeColor:"#FFFFFF",fillColor:"#FFFFFF",capStyle:{width:4,height:10,capType:Ce.Rect,strokeColor:"#FFFFFF",fillColor:"#FFFFFF"},cursor:xe.EWResize},je={snapAllKeyframesOnMove:!1,snapEnabled:!0,timelineStyle:Oe,stepPx:120,stepVal:1e3,stepSmallPx:30,snapStep:200,leftMargin:25,headerFillColor:"#101011",fillColor:"#101011",labelsColor:"#D5D5D5",tickColor:"#D5D5D5",selectionColor:"White",rowsStyle:_,keyframesStyle:p,groupsStyle:y,headerHeight:30,font:"11px sans-serif",zoom:1,zoomSpeed:.1,zoomMin:.1,zoomMax:8,controlKeyIsMetaKey:!1,scrollContainerClass:"scroll-container",groupsDraggable:!0,keyframesDraggable:!0,timelineDraggable:!0,min:0,max:Number.MAX_VALUE};function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function Ne(e){return function(e){if(Array.isArray(e))return ze(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ke(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Ge(o.key),o)}}function Ve(e,t){return Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ve(e,t)}function We(e,t){if(t&&("object"===Fe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Le(e)}function Le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Be(){return Be="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=Ie(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Be.apply(this,arguments)}function Ie(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ze(e)););return e}function Ze(e){return Ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ze(e)}function He(e,t,n){return(t=Ge(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ge(e){var t=function(e,t){if("object"!==Fe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!==Fe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===Fe(t)?t:String(t)}var Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ve(e,t)}(a,e);var t,n,o,r,l=(o=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ze(o);if(r){var n=Ze(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return We(this,e)});function a(){var e,t,n,o,r,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ae(this,a),He(Le(r=l.call(this)),"_container",null),He(Le(r),"_canvas",null),He(Le(r),"_scrollContainer",null),He(Le(r),"_scrollContent",null),He(Le(r),"_ctx",null),He(Le(r),"_options",void 0),He(Le(r),"_startPosMouseArgs",null),He(Le(r),"_scrollStartPos",null),He(Le(r),"_currentPos",null),He(Le(r),"_selectionRect",null),He(Le(r),"_selectionRectEnabled",!1),He(Le(r),"_drag",null),He(Le(r),"_startedDragWithCtrl",!1),He(Le(r),"_startedDragWithShiftKey",!1),He(Le(r),"_groupSelected",!1),He(Le(r),"_scrollProgrammatically",!1),He(Le(r),"_clickTimeout",null),He(Le(r),"_lastClickTime",0),He(Le(r),"_lastClickPoint",null),He(Le(r),"_consts",De),He(Le(r),"_clickAllowed",!1),He(Le(r),"_scrollFinishedTimerRef",null),He(Le(r),"_val",0),He(Le(r),"_pixelRatio",1),He(Le(r),"_currentZoom",0),He(Le(r),"_intervalRef",null),He(Le(r),"_autoPanLastActionDate",0),He(Le(r),"_isPanStarted",!1),He(Le(r),"_interactionMode",ke.Selection),He(Le(r),"_lastUsedArgs",null),He(Le(r),"_model",null),He(Le(r),"_scrollAreaClickOrDragStarted",!1),He(Le(r),"initialize",(function(e,t){if(r._model=t,!e||!e.id)throw new Error("Element cannot be empty. Should be string or DOM element.");r._generateContainers(e.id),r._options=d.cloneOptions(je),e&&(r._options=r._setOptions(e)),r._subscribeComponentEvents(),r.rescale(),r.redraw()})),He(Le(r),"_generateContainers",(function(e){if(e instanceof HTMLElement?r._container=e:r._container=document.getElementById(e),!r._container)throw new Error("Element cannot be empty. Should be string or DOM element.");if(r._scrollContainer=document.createElement("div"),r._scrollContent=document.createElement("div"),r._canvas=document.createElement("canvas"),r._canvas&&r._canvas.getContext){r._container.style.position="relative",r._canvas.style.cssText="image-rendering: -moz-crisp-edges;image-rendering: -webkit-crisp-edges;image-rendering: pixelated;image-rendering: crisp-edges;user-select: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-o-user-select: none;user-select: none;touch-action: none;position: relative;-webkit-user-drag: none;-khtml-user-drag: none;-moz-user-drag: none;-o-user-drag: none;user-drag: none;padding: inherit",r._scrollContainer.style.cssText="overflow: scroll;position: absolute;width:  100%;height:  100%;",r._scrollContent.style.width=r._scrollContent.style.height="100%",r._scrollContainer.appendChild(r._scrollContent),r._container.appendChild(r._scrollContainer);var t=r._scrollContainer.offsetWidth-r._scrollContent.clientWidth;r._canvas.style.width=r._canvas.style.height="calc(100% -"+(t||17)+"px)",r._container.appendChild(r._canvas),r._ctx=r._getCtx()}else console.log("Cannot initialize canvas context.")})),He(Le(r),"_subscribeComponentEvents",(function(){if(r._unsubscribeComponentEvents(),!r._container||!r._scrollContainer||!r._canvas)throw Error("Cannot subscribe on scroll events while one of the containers is null or empty. Please call initialize method first");r._container&&r._container.addEventListener("wheel",r._handleWheelEvent),r._scrollContainer&&(r._scrollContainer.addEventListener("scroll",r._handleScrollEvent),r._scrollContainer.addEventListener("touchstart",r._handleScrollMouseDownEvent),r._scrollContainer.addEventListener("mousedown",r._handleScrollMouseDownEvent)),document.addEventListener("keyup",r._handleKeyUp,!1),document.addEventListener("keydown",r._handleKeyDown,!1),window.addEventListener("blur",r._handleBlurEvent,!1),window.addEventListener("resize",r._handleWindowResizeEvent,!1),r._canvas&&(r._canvas.addEventListener("touchstart",r._handleMouseDownEvent,!1),r._canvas.addEventListener("mousedown",r._handleMouseDownEvent,!1)),window.addEventListener("mousemove",r._handleMouseMoveEvent,!1),window.addEventListener("touchmove",r._handleMouseMoveEvent,!1),window.addEventListener("mouseup",r._handleMouseUpEvent,!1),window.addEventListener("touchend",r._handleMouseUpEvent,!1)})),He(Le(r),"_unsubscribeComponentEvents",(function(){var e;null===(e=r._container)||void 0===e||e.removeEventListener("wheel",r._handleWheelEvent),r._scrollContainer?(r._scrollContainer.removeEventListener("scroll",r._handleScrollEvent),r._scrollContainer.removeEventListener("touchstart",r._handleScrollMouseDownEvent),r._scrollContainer.removeEventListener("mousedown",r._handleScrollMouseDownEvent)):console.warn("Cannot unsubscribe scroll while it's already empty"),window.removeEventListener("blur",r._handleBlurEvent),window.removeEventListener("resize",r._handleWindowResizeEvent),document.removeEventListener("keydown",r._handleKeyDown),document.removeEventListener("keyup",r._handleKeyUp),r._canvas?(r._canvas.removeEventListener("touchstart",r._handleMouseDownEvent),r._canvas.removeEventListener("mousedown",r._handleMouseDownEvent)):console.warn("Cannot unsubscribe canvas while it's already empty"),window.removeEventListener("mousemove",r._handleMouseMoveEvent),window.removeEventListener("touchmove",r._handleMouseMoveEvent),window.removeEventListener("mouseup",r._handleMouseUpEvent),window.removeEventListener("touchend",r._handleMouseUpEvent)})),He(Le(r),"dispose",(function(){r.offAll(),r._stopAutoPan(),r._clearScrollFinishedTimer(),r._unsubscribeComponentEvents(),r._container=null,r._canvas=null,r._scrollContainer=null,r._scrollContent=null,r._ctx=null,r._cleanUpSelection()})),He(Le(r),"_handleKeyUp",(function(e){r._interactionMode===ke.Zoom&&r._setZoomCursor(e)})),He(Le(r),"_handleKeyDown",(function(e){r._interactionMode===ke.Zoom&&r._setZoomCursor(e)})),He(Le(r),"_setZoomCursor",(function(e){r._controlKeyPressed(e)?r._setCursor(xe.ZoomOut):r._setCursor(xe.ZoomIn)})),He(Le(r),"_handleBlurEvent",(function(){r._cleanUpSelection(!0)})),He(Le(r),"_handleWindowResizeEvent",(function(){r.rescale(),r.redraw()})),He(Le(r),"_clearScrollFinishedTimer",(function(){r._scrollFinishedTimerRef&&(clearTimeout(r._scrollFinishedTimerRef),r._scrollFinishedTimerRef=null)})),He(Le(r),"_handleScrollMouseDownEvent",(function(){r._scrollAreaClickOrDragStarted=!0})),He(Le(r),"_handleScrollEvent",(function(e){var t=r._scrollProgrammatically;r._scrollProgrammatically&&(r._scrollProgrammatically=!1),r._clearScrollFinishedTimer(),r._scrollFinishedTimerRef=window.setTimeout((function(){r._isPanStarted||r._clearScrollFinishedTimer(),r._emitScrollEvent(e,t,Ee.ScrollFinished)}),r._consts.scrollFinishedTimeoutMs),r.redraw(),r._emitScrollEvent(e,t)})),He(Le(r),"_controlKeyPressed",(function(e){return r._options&&void 0!==r._options.controlKeyIsMetaKey?r._options.controlKeyIsMetaKey||r._options.controlKeyIsMetaKey?e.metaKey:e.ctrlKey:e.metaKey||e.ctrlKey})),He(Le(r),"_handleWheelEvent",(function(e){if(r._scrollContainer&&r._canvas)if(r._controlKeyPressed(e)){e.preventDefault();var t=r._getMousePos(r._canvas,e),n=Math.max(0,t.pos.x||0);r._zoom(d.sign(e.deltaY),r._options.zoomSpeed||0,n)}else r.scrollTop=r._scrollContainer.scrollTop+e.deltaY,e.preventDefault()})),He(Le(r),"_zoom",(function(e,t,n){if(t&&t>0&&t<=1){n+=.2*d.getDistance(r._canvasClientWidth()/2,n);var o=r._canvasClientWidth()/n,i=r._fromScreen(n),l=e*r._currentZoom*t;r._currentZoom=r._setZoom(r._currentZoom+l);var a=r.valToPx(i),s=Math.round(a-r._canvasClientWidth()/o);s<=0&&(s=0),r._rescaleInternal(s+r._canvasClientWidth(),null,Te.ZoomMode),r.scrollLeft=s,r.redraw(),r._emitZoomEvent(null,!0)}})),He(Le(r),"zoomIn",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r._options.zoomSpeed,n=(null===(e=r._scrollContainer)||void 0===e?void 0:e.clientWidth)||0;t&&n&&r._zoom(1,t,n/2)})),He(Le(r),"zoomOut",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r._options.zoomSpeed,n=(null===(e=r._scrollContainer)||void 0===e?void 0:e.clientWidth)||0;t&&n&&r._zoom(-1,t,n/2)})),He(Le(r),"_setZoom",(function(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return o=d.isNumber(o)?o:null===(t=r._options)||void 0===t?void 0:t.zoomMin,i=d.isNumber(i)?i:null===(n=r._options)||void 0===n?void 0:n.zoomMax,d.isNumber(e)?(e=(e=d.keepInBounds(e,o,i))||1,r._currentZoom=e,e):e})),He(Le(r),"setZoom",(function(e){var t=r.getZoom();if(t!==e){var n=r._setZoom(e);if(t!=n)return r.rescale(),r.redraw(),n}return t})),He(Le(r),"getZoom",(function(){return d.isNumber(r._currentZoom)&&r._currentZoom||1})),He(Le(r),"cancelHighlight",(function(){r._selectInternal(null),r.redraw()})),He(Le(r),"_getClickDetectionRadius",(function(e){var t=r._consts.clickDetectionMinRadius||1;return Math.max(t,(null==e?void 0:e.radius)||t)})),He(Le(r),"_handleMouseDownEvent",(function(n){if(d.clearBrowserSelection(),r._canvas&&r._scrollContainer){if(r._startPosMouseArgs=r._trackMousePos(r._canvas,n),r._startPosMouseArgs){var o=Date.now()-r._lastClickTime<r._consts.doubleClickTimeoutMs;r._lastClickPoint&&r._startPosMouseArgs&&d.getDistance(r._lastClickPoint.x,r._lastClickPoint.y,r._startPosMouseArgs.pos.x,r._startPosMouseArgs.pos.y)>r._consts.clickThreshold&&(o=!1),r._lastClickPoint=r._startPosMouseArgs.pos,r._scrollStartPos={x:r._scrollContainer.scrollLeft,y:r._scrollContainer.scrollTop},r._clickAllowed=!0;var i=null;r._interactionMode!==ke.NonInteractivePan&&r._interactionMode!==ke.None||(i=[g.Timeline]);var l=r._getClickDetectionRadius(r._startPosMouseArgs),s=r.elementFromPoint(r._startPosMouseArgs.pos,l,i),c=r._findDraggableElement(s,r._startPosMouseArgs.val),u=new ve;if(u.point=r._startPosMouseArgs,u.args=n,u.elements=s,u.target=c,o)Be((e=Le(r),Ze(a.prototype)),"emit",e).call(e,Ee.DoubleClick,u);else if(Be((t=Le(r),Ze(a.prototype)),"emit",t).call(t,Ee.MouseDown,u),r._clickTimeout=Date.now(),r._lastClickTime=Date.now(),u.isPrevented())r._cleanUpSelection();else{var f;if(r._currentPos=r._startPosMouseArgs,c&&r._interactionMode!==ke.Zoom)if(r._drag=new P,r._drag.val=c.val,r._drag.type=c.type,r._drag.target=r._setElementDragState(c,c.val),c.type===g.Keyframe)r._groupSelected=!1,r._startedDragWithCtrl=r._controlKeyPressed(n),r._startedDragWithShiftKey=n.shiftKey,null==c||!c.keyframe||null!=c&&null!==(f=c.keyframe)&&void 0!==f&&f.selected||r._controlKeyPressed(n)||r._selectInternal(c.keyframe),r._drag.elements=r.getSelectedElements().map((function(e){return r._setElementDragState(e,e.val)}));else if(c.type===g.Group){var v=c.keyframes;r._startedDragWithCtrl=r._controlKeyPressed(n),r._groupSelected=!0,v&&!r._controlKeyPressed(n)&&r._selectInternal(v),v&&Array.isArray(v)&&(r._drag.elements=v.map((function(e){var t;return r._setElementDragState(r._convertToTimelineElement((null===(t=r._drag)||void 0===t?void 0:t.target.row)||null,e),e.val)})))}else r._drag.elements=[r._drag.target];r.redraw()}}}else r._cleanUpSelection()})),He(Le(r),"_setElementDragState",(function(e,t){var n=e;return n.prevVal=n.val,void 0!==n.startedVal&&null!==n.startedVal||(n.startedVal=t),void 0!==n.prevVal&&null!==n.prevVal||(n.prevVal=t),n.val=t,n})),He(Le(r),"isLeftButtonClicked",(function(e){return!!e&&1==e.buttons})),He(Le(r),"_handleMouseMoveEvent",(function(e){if(e?r._lastUsedArgs=e:e=r._lastUsedArgs,e&&r._canvas){var t=e,n=t.changedTouches&&t.changedTouches.length>0;r._currentPos=r._trackMousePos(r._canvas,e),!r._isPanStarted&&r._selectionRect&&r._clickTimeoutIsOver()?r._interactionMode===ke.None||r._interactionMode===ke.Zoom||r._interactionMode===ke.NonInteractivePan?r._selectionRectEnabled=!1:r._selectionRectEnabled=!0:r._selectionRectEnabled=!1;var o=r.isLeftButtonClicked(e);if(o||(r._scrollAreaClickOrDragStarted=!1),r._startPosMouseArgs)if(o||n){if(r._drag&&!r._startedDragWithCtrl){var i=r._currentPos.val;if(r._drag.type===g.Timeline)r._setTimeInternal(i,W.User);else if((r._drag.type==g.Keyframe||r._drag.type==g.Group)&&r._drag.elements){var l=Math.floor(i-r._drag.val);if(0!==r._moveElements(l,r._drag.elements,W.User)){if(!r._drag.changed){r._drag.prevVal=r._drag.val;var a=r._emitDragStartedEvent(r._drag);if(!a||a.isPrevented())return r._cleanUpSelection(!0),void(r._drag=null)}r._drag.changed=!0,r._drag.val+=l,r._emitDragEvent(r._drag)}}}r._interactionMode!==ke.Pan&&r._interactionMode!==ke.NonInteractivePan||r._drag?r._interactionMode!==ke.None&&r._scrollBySelectionOutOfBounds(r._currentPos.pos):(r._isPanStarted=!0,r._setCursor(xe.Grabbing),r._scrollByPan(r._startPosMouseArgs.pos,r._currentPos.pos,r._scrollStartPos)),r.redraw()}else r._cleanUpSelection(!0),r.redraw();else if(!n){var s=null;r._interactionMode!==ke.NonInteractivePan&&r._interactionMode!==ke.None||(s=[g.Timeline]);var c=r._getClickDetectionRadius(r._currentPos),u=r.elementFromPoint(r._currentPos.pos,c,s),f=r._findDraggableElement(u,r._currentPos.val);if(r._isPanStarted||r._interactionMode===ke.Pan||r._interactionMode===ke.NonInteractivePan)o?r._setCursor(xe.Grabbing):r._setCursor(xe.Grab);else{if(r._interactionMode===ke.Zoom)return void r._setZoomCursor(e);r._setCursor(xe.Default)}if(f){var d=null;if(f.type===g.Group)d=d||xe.EWResize;else if(f.type==g.Keyframe)d=d||xe.Pointer;else if(f.type==g.Timeline){var v,y;d=d||(null===(v=r._options)||void 0===v||null===(y=v.timelineStyle)||void 0===y?void 0:y.cursor)||null}d&&r._setCursor(d)}}n&&e.preventDefault()}})),He(Le(r),"_handleMouseUpEvent",(function(e){if(r._scrollAreaClickOrDragStarted=!1,r._canvas&&r._startPosMouseArgs){var t=r._trackMousePos(r._canvas,e);if(r._clickAllowed||!r._clickTimeoutIsOver()||r._drag&&(r._startedDragWithCtrl||r._startedDragWithShiftKey))if(r._options&&r._interactionMode===ke.Zoom){var n=r._controlKeyPressed(e)?1:-1,o=r._getMousePos(r._canvas,e),i=Math.max(0,o.pos.x||0);r._zoom(n,r._options.zoomSpeed||0,i)}else r._performClick(t,r._drag);else if(!r._drag&&r._selectionRect&&r._selectionRectEnabled)if(r._interactionMode===ke.Zoom);else if(r._interactionMode!==ke.None){var l=r._getKeyframesByRectangle(r._selectionRect),a=e.shiftKey?Me.Append:Me.Normal;r.select(l,a)}r._cleanUpSelection(),r.redraw()}})),He(Le(r),"_canvasClientHeight",(function(){return r._canvas?r._canvas.clientHeight:0})),He(Le(r),"_canvasClientWidth",(function(){return r._canvas?r._canvas.clientWidth:0})),He(Le(r),"_getKeyframesByRectangle",(function(e){var t=[];return r._forEachKeyframe((function(n){(n.shape===i.Rect?d.isRectIntersects(n.size,e):d.isOverlap(n.size.x,n.size.y,e))&&t.push(n.model)})),t})),He(Le(r),"_performClick",(function(e,t){var n=!1;if(!t||t.type!==g.Keyframe&&t.type!==g.Group){var o;e.args instanceof MouseEvent&&0==e.args.button&&(n=r._selectInternal(null).selectionChanged||n),!1!==(null===(o=r._options)||void 0===o?void 0:o.timelineDraggable)&&(n=r._setTimeInternal(e.val,W.User)||n)}else{var i,l=Me.Normal;r._groupSelected&&(l=Me.Revert),r._startedDragWithCtrl&&r._controlKeyPressed(e.args)?r._controlKeyPressed(e.args)&&(l=Me.Revert):r._startedDragWithShiftKey&&e.args.shiftKey&&(l=Me.Append);var a=r._groupSelected?t.target.keyframes:t.target.keyframe;a&&r._controlKeyPressed(e.args)&&(n=r._selectInternal(a||null,l).selectionChanged||n),e.args.shiftKey&&!1!==(null===(i=r._options)||void 0===i?void 0:i.timelineDraggable)&&(n=r._setTimeInternal(e.val,W.User)||n)}return n})),He(Le(r),"_setKeyframePos",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:W.Programmatically;if(!e||!e.keyframe)return t;if(t=Math.floor(t),e.keyframe&&e.keyframe.val!=t){e.prevVal=e.val,e.val=t,e.keyframe.val=t;var o=r._emitKeyframeChanged(e,n);return o.isPrevented()&&(e.val=o.prevVal,e.keyframe.val=o.prevVal),t}return t})),He(Le(r),"_setCursor",(function(e){r._canvas&&r._canvas.style.cursor!=e&&(r._canvas.style.cursor=e)})),He(Le(r),"setInteractionMode",(function(e){r._interactionMode!=e&&(r._interactionMode=e,r._cleanUpSelection(!0),r.redraw())})),He(Le(r),"getInteractionMode",(function(){return r._interactionMode})),He(Le(r),"_convertToTimelineElement",(function(e,t){return{type:g.Keyframe,val:t.val,keyframe:t,row:e}})),He(Le(r),"getSelectedKeyframes",(function(){return r.getSelectedElements().map((function(e){return e.keyframe}))})),He(Le(r),"getSelectedElements",(function(){var e=[];return r._forEachKeyframe((function(t){t&&t.model.selected&&e.push(r._convertToTimelineElement(t.rowViewModel.model,t.model))})),e})),He(Le(r),"getAllKeyframes",(function(){var e=[];return r._forEachKeyframe((function(t){e.push(t.model)})),e})),He(Le(r),"selectAllKeyframes",(function(){return r.select(r.getAllKeyframes(),Me.Normal)})),He(Le(r),"deselectAll",(function(){return r.select(null)})),He(Le(r),"_changeNodeState",(function(e,t,n){if(t.selected!==n){var o="boolean"!=typeof t.selectable||t.selectable;if(!n||n&&o)return t.selected=n,e.changed.push(t),!0}return!1})),He(Le(r),"select",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Me.Normal,n=r._selectInternal(e,t);return n.selectionChanged&&r.redraw(),n})),He(Le(r),"_selectInternal",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Me.Normal;arguments.length>2&&void 0!==arguments[2]||Pe.keyframe,e||(e=[]),Array.isArray(e)||(e=[e]);var n={selectionChanged:!1,selected:r.getSelectedKeyframes(),changed:[]},o=e;if(o&&t===Me.Append)e.forEach((function(e){r._changeNodeState(n,e,!0)&&e.selected&&n.selected.push(e)}));else if(o&&t===Me.Revert)e.forEach((function(e){n.selected.indexOf(e)>=0?(r._changeNodeState(n,e,!1),d.deleteElement(n.selected,e)):(r._changeNodeState(n,e,!0),e.selected&&n.selected.push(e))}));else if(t===Me.Normal){var i=[];e&&e.forEach((function(e){r._changeNodeState(n,e,!0),e.selected&&i.push(e)})),n.selected.forEach((function(e){o.indexOf(e)>=0||r._changeNodeState(n,e,!1)})),n.changed.length>0&&(i?n.selected=i:n.selected.length=0)}return n.changed.length>0&&(n.selectionChanged=!0,r._emitKeyframesSelected(n)),n})),He(Le(r),"_startAutoPan",(function(){r._consts.autoPanSpeed&&(r._intervalRef||(r._intervalRef=window.setInterval((function(){r._handleMouseMoveEvent(null)}),r._consts.autoPanSpeed)))})),He(Le(r),"_stopAutoPan",(function(){r._intervalRef&&(clearInterval(r._intervalRef),r._intervalRef=null),r._autoPanLastActionDate=0})),He(Le(r),"_toScreenPx",(function(e){return r.valToPx(e)-r.scrollLeft+r._leftMargin()})),He(Le(r),"_fromScreen",(function(e){return r.pxToVal(r.scrollLeft+e-r._leftMargin())})),He(Le(r),"valToPx",(function(e){if(!r._options||!r._options.stepPx)return e;var t=r._options.min||0;d.isNumber(t)||(t=0),t*=r._currentZoom||1;var n=(r._options.stepVal||0)*r._currentZoom||1;return(-t+e)*(r._options.stepPx/n)})),He(Le(r),"_mousePosToVal",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Math.min(e,r._canvasClientWidth()),o=r._fromScreen(n);return o=Math.round(o),t&&(o=r.snapVal(o)),o})),He(Le(r),"_formatUnitsText",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=d.sign(e)<0?"-":"",o=(e=Math.abs(e))/1e3;t&&(o=e);var r=Math.floor(o/31536e3);o%=31536e3;var i=Math.floor(o/86400);o%=86400;var l=Math.floor(o/3600);o%=3600;var a=Math.floor(o/60);o%=60;var s="";return r&&(s+=r+":"),i&&(s+=i+":"),l&&(s+=l+":"),a&&(s+=a+":"),isNaN(o)||(s+=o),n+s})),He(Le(r),"_leftMargin",(function(){var e;return(null===(e=r._options)||void 0===e?void 0:e.leftMargin)||0})),He(Le(r),"_renderTicks",(function(){if(!(!r._ctx||!r._ctx.canvas||r._ctx.canvas.clientWidth<=0||r._ctx.canvas.clientHeight<=0)&&r._options&&r._options.stepPx){var e=r._canvasClientWidth()-r._leftMargin(),t=r.pxToVal(r.scrollLeft),n=r.pxToVal(r.scrollLeft+e);if(!isNaN(t)&&!isNaN(n)&&t!==n){if(n<t){var o=n;n=t,t=o}var i=d.getDistance(t,n);if(!(i<=0)){var l=d.findGoodStep(i/(e/r._options.stepPx)),a=Math.floor(t/l)*l,s=Math.ceil(n/l)*l+l;if(d.isNumber(l)&&!(l<=0)&&0!==Math.abs(s-a)){var c=0;r._options.stepSmallPx&&(c=d.findGoodStep(i/(e/r._options.stepSmallPx)));var u=0;r._ctx.save();for(var f=S.headerHeight(r._options),v=f/2,y=f/1.3,p=a;p<=s;p+=l){var _=r._getSharp(r._toScreenPx(p));r._ctx.save(),r._ctx.beginPath(),r._ctx.setLineDash([4]),r._ctx.lineWidth=1,r._options.tickColor&&(r._ctx.strokeStyle=r._options.tickColor),d.drawLine(r._ctx,_,v,_,f),r._ctx.stroke(),r._options.labelsColor&&(r._ctx.fillStyle=r._options.labelsColor),r._options.font&&(r._ctx.font=r._options.font);var h=r._formatUnitsText(p),m=r._ctx.measureText(h),g=_-m.width/2;if((isNaN(u)||u<=g)&&(u=g+m.width,r._ctx.fillText(h,g,10)),r._ctx.restore(),d.isNumber(c)&&!(c<=0))for(var b=p+c;b<p+l;b+=c){var w=r._getSharp(r._toScreenPx(b));r._ctx.beginPath(),r._ctx.lineWidth=r._pixelRatio,r._options.tickColor&&(r._ctx.strokeStyle=r._options.tickColor),d.drawLine(r._ctx,w,y,w,f),r._ctx.stroke()}}r._ctx.restore()}}}}})),He(Le(r),"_generateViewModel",(function(){var e={size:{x:0,y:0,width:0,height:0},min:null,max:null,rowsViewModels:[],keyframesViewModels:[]};if(!r._model)return e;var t=r._model.rows;if(!t||!Array.isArray(t)||t.length<=0)return e;var n=S.headerHeight(r._options);return t.forEach((function(t,o){if(t&&!t.hidden){var i=S.getRowHeight(t.style||null,r._options),l=S.getRowMarginBottom(t.style||null,r._options),a=n-(r._scrollContainer?r._scrollContainer.scrollTop:0);n+=i+l,0==o&&(e.size.y=a),e.size.height=Math.max(n+i,e.size.height);var s={size:{x:0,y:a,width:r._canvasClientWidth(),height:i},marginBottom:l,model:t,index:o,min:null,max:null,groupsViewModels:[],keyframesViewModels:[]};e.rowsViewModels.push(s),!t.keyframes||!t.keyframes.forEach||t.keyframes.length<=0||(t&&t.keyframes&&t.keyframes.forEach((function(n){var o;if(n&&d.isNumber(n.val)){if(!n.hidden){var i=(null===(o=s.groupsViewModels)||void 0===o?void 0:o.find((function(e){return n.group===e.groupModel})))||null;i||(i={min:n.val,max:n.val,size:null,groupModel:n.group,keyframesViewModels:[]},s.groupsViewModels.push(i));var l=S.keyframeShape(n,n.group,t.style||null,r._options),a=r._getKeyframePosition(n,i,s,l),c={model:n,rowViewModel:s,groupViewModel:i,size:a,shape:l},u=null===i.min?n.val:Math.min(n.val,i.min),f=null===i.max?n.val:Math.max(n.val,i.max);d.isNumber(u)&&(i.min=u),d.isNumber(f)&&(i.max=f),s.keyframesViewModels.push(c),i.keyframesViewModels.push(c),e.keyframesViewModels.push(c)}}else console.log("Unexpected null keyframe or having invalid value")})),s.groupsViewModels.forEach((function(e){d.setMinMax(s,e,!0);var t=r._getKeyframesGroupSize(e,s);e.size=t})),d.setMinMax(e,s,!0))}})),d.isNumber(e.max)&&(e.max||0===e.max)&&(e.size.width=r.valToPx(e.max)),e})),He(Le(r),"_renderRows",(function(){if(r._ctx){var e=r._generateViewModel();if(null!=e&&e.rowsViewModels)try{r._ctx.save(),e.rowsViewModels.forEach((function(e){if(e&&r._ctx){r._ctx.fillStyle=e.model.style?e.model.style:S.getRowFillColor(e.model.style||null,r._options);var t=r._cutBounds(e.size);if(null!=t&&t.rect){var n=null==t?void 0:t.rect;r._ctx.fillRect(n.x,n.y,n.width,n.height),e.model.moveStyle&&(r._ctx.strokeStyle=e.model.moveStyle,r._ctx.lineWidth=1,r._ctx.strokeRect(n.x,n.y,n.width,n.height))}r._renderGroupBounds(e)}}))}finally{r._ctx.restore()}}})),He(Le(r),"_renderGroupBounds",(function(e){var t;e&&r._ctx&&(null==e||null===(t=e.groupsViewModels)||void 0===t||t.forEach((function(t){var n;if(r._ctx){var o=S.groupFillColor(r._options,t.groupModel,null==e||null===(n=e.model)||void 0===n?void 0:n.style);if(o)if(t.size){var i=0;t.keyframesViewModels.forEach((function(e){e.model.selected&&i++}));var l=i==t.keyframesViewModels.length,a=r._cutBounds(t.size);if(null!=a&&a.rect){r._ctx.fillStyle=o;var s=a.rect;r._ctx.fillRect(s.x,s.y,s.width,s.height),r._ctx.strokeStyle=l?"#FFEE32":o,s.width&&(r._ctx.lineWidth=2,r._ctx.strokeRect(s.x,s.y,s.width,s.height))}}else console.log("Size of the group cannot be calculated")}})))})),He(Le(r),"_cutBounds",(function(e){if(!e)return null;var t=r._canvasClientWidth()-0,n=S.headerHeight(r._options)+0,o=r._canvasClientHeight()-0;return r._cutBoundsWhenOverlap(e,0,t,n,o)})),He(Le(r),"_cutBoundsWhenOverlap",(function(e,t,n,o,r){if(!e)return null;if(d.isRectIntersects(e,{x:t,y:o,width:d.getDistance(t,n),height:d.getDistance(o,r)})){var i=Math.max(e.y,o),l=Math.max(e.x,t),a=e.x-l,s=e.y-i;return{rect:{height:e.height+s,width:e.width+a,x:l,y:i},overlapY:Math.abs(s)>0,overlapX:Math.abs(a)>0}}return null})),He(Le(r),"_getKeyframesGroupSize",(function(e,t){var n,o,i=t.size.y,l=t.size.height,a=e.groupModel||null,s=S.groupHeight(r._options,a,null==t||null===(n=t.model)||void 0===n?void 0:n.style),c=S.groupMarginTop(r._options,a,null==t||null===(o=t.model)||void 0===o?void 0:o.style),u="auto"===s;s&&!u||(s=Math.floor(l)),(s="string"==typeof s?parseInt(s):s)>l&&(s=l);var f="auto"===c;"string"==typeof c&&(c=f?(l-s)/2:parseInt(c)||0),f||u&&(s-=2*c);var v=r._toScreenPx(e.min),y=r._toScreenPx(e.max);return{x:v,y:i+c,height:s,width:d.getDistance(v,y)}})),He(Le(r),"_getKeyframePosition",(function(e,t,n,o){var l,a;if(!e)return console.log("keyframe should be defined."),null;var s=e.val;if(!d.isNumber(s))return null;var c=n.size,u=c.y+c.height/2,f=(null==t?void 0:t.groupModel)||null,v=S.keyframeHeight(e,f,null==n||null===(l=n.model)||void 0===l?void 0:l.style,r._options),y=S.keyframeWidth(e,f,null==n||null===(a=n.model)||void 0===a?void 0:a.style,r._options);if("auto"===v&&(v=c.height/3),"auto"===y&&(y=v),v>0){var p={x:Math.floor(r._toScreenPx(s)),y:u=Math.floor(u),height:v,width:y};return o===i.Rect&&(p.y=p.y-p.height/2,p.x=p.x-p.width/2),p}return null})),He(Le(r),"_renderKeyframes",(function(){r._forEachKeyframe((function(e){if(r._ctx){var t=e.rowViewModel.model,n=e.size,o=e.model;if(n){var l,a=r._getSharp(n.x),s=n.y,c=r._cutBounds({x:a-n.width/2,y:s-n.height/2,width:n.width,height:n.height});if(!c)return;r._ctx.save(),c&&c.overlapY&&(r._ctx.beginPath(),r._ctx.rect(0,S.headerHeight(r._options),r._canvasClientWidth(),r._canvasClientWidth()),r._ctx.clip());var u=e.shape;if(u===i.None)return;var f=t.style||null,d=(null==e||null===(l=e.groupViewModel)||void 0===l?void 0:l.groupModel)||null,v=o.selected?S.keyframeSelectedFillColor(o,d,f,r._options):S.keyframeFillColor(o,d,f,r._options),y=S.keyframeStrokeThickness(o,d,f,r._options),p="";y>0&&(p=o.selected?S.keyframeSelectedStrokeColor(o,d,f,r._options):S.keyframeStrokeColor(o,d,f,r._options)),u==i.Rhomb?(r._ctx.beginPath(),r._ctx.translate(a,s),r._ctx.rotate(45*Math.PI/180),y>0&&p&&(r._ctx.fillStyle=p,r._ctx.rect(-n.width/2,-n.height/2,n.width,n.height),r._ctx.fill()),r._ctx.fillStyle=v,r._ctx.translate(y,y),r._ctx.rect(-n.width/2,-n.height/2,n.width-2*y,n.height-2*y),r._ctx.fill()):u==i.Circle?(r._ctx.beginPath(),y>0&&p&&(r._ctx.fillStyle=p,r._ctx.arc(a,s,n.height,0,2*Math.PI)),r._ctx.fillStyle=v,r._ctx.arc(a,s,n.height-y,0,2*Math.PI),r._ctx.fill()):u==i.Rect&&(r._ctx.beginPath(),y>0&&p&&(r._ctx.fillStyle=p,r._ctx.rect(a,s,n.width,n.height),r._ctx.fill()),r._ctx.fillStyle=v,r._ctx.rect(a+y,s+y,n.width-y,n.height-y),r._ctx.fill()),r._ctx.restore()}}}))})),He(Le(r),"_renderSelectionRect",(function(){if(!r._drag&&r._ctx&&r._canvas){if(r._ctx.save(),r._selectionRect&&r._selectionRectEnabled){r._ctx.setLineDash([4]),r._ctx.lineWidth=r._pixelRatio;var e=r._options.selectionColor;e&&(r._ctx.strokeStyle=e),r._ctx.strokeRect(r._getSharp(r._selectionRect.x,1),r._getSharp(r._selectionRect.y,1),Math.floor(r._selectionRect.width),Math.floor(r._selectionRect.height))}r._ctx.restore()}})),He(Le(r),"_renderBackground",(function(){r._ctx&&r._canvas&&(r._options.fillColor?(r._ctx.save(),r._ctx.beginPath(),r._ctx.rect(0,0,r._canvasClientWidth(),r._canvasClientHeight()),r._ctx.fillStyle=r._options.fillColor,r._ctx.fill(),r._ctx.restore()):r._ctx.clearRect(0,0,r._canvas.width,r._canvas.height))})),He(Le(r),"_renderTimeline",(function(){if(r._ctx&&r._options&&r._options.timelineStyle){var e=r._options.timelineStyle;r._ctx.save();try{var t=e.width||1;r._ctx.lineWidth=t*r._pixelRatio;var n=r._getSharp(r._toScreenPx(r._val),t);e.strokeColor&&(r._ctx.strokeStyle=e.strokeColor),e.fillColor&&(r._ctx.fillStyle=e.fillColor);var o=e.marginTop||0,i=e.marginBottom||0;r._ctx.beginPath();var l=r._canvasClientHeight()-i;d.drawLine(r._ctx,n,o,n,l),r._ctx.stroke(),r._renderTimelineCap(n,o)}finally{r._ctx.restore()}}})),He(Le(r),"_renderTimelineCap",(function(e,t){var n,o,i=null===(n=r._options)||void 0===n||null===(o=n.timelineStyle)||void 0===o?void 0:o.capStyle;if(r._ctx&&i&&i.capType!==Ce.None){r._ctx.save();try{var l=i.width||0,a=i.height||0;l&&a&&(r._ctx.strokeStyle=i.strokeColor,r._ctx.fillStyle=i.fillColor,i.capType===Ce.Triangle?(r._ctx.beginPath(),r._ctx.moveTo(e-l/2,t),r._ctx.lineTo(e+l/2,t),r._ctx.lineTo(e,a),r._ctx.closePath(),r._ctx.stroke()):i.capType===Ce.Rect&&(r._ctx.fillRect(e-l/2,t,l,a),r._ctx.fill()))}finally{r._ctx.restore()}}})),He(Le(r),"_renderHeaderBackground",(function(){r._ctx&&r._options&&S.headerHeight(r._options)&&(r._ctx.save(),r._ctx.lineWidth=r._pixelRatio,r._options.headerFillColor?(r._ctx.lineWidth=r._pixelRatio,r._ctx.fillStyle=r._options.headerFillColor,r._ctx.fillRect(0,0,r._canvasClientWidth(),S.headerHeight(r._options))):r._ctx.clearRect(0,0,r._canvasClientWidth(),S.headerHeight(r._options)),r._ctx.restore())})),He(Le(r),"redraw",(function(){window.requestAnimationFrame?window.requestAnimationFrame(r._redrawInternal):r._redrawInternal()})),He(Le(r),"scrollToRightBounds",(function(){r._scrollContainer&&r._scrollContainer.scrollLeft!==r._scrollContainer.scrollWidth&&(r.scrollLeft=r._scrollContainer.scrollWidth)})),He(Le(r),"_redrawInternal",(function(){r._ctx&&r._scrollContainer?(r.valToPx(r._val)>r._scrollContainer.scrollWidth&&(r.rescale(),!r._isPanStarted&&r._drag&&r._drag.type!==g.Timeline&&r.scrollToRightBounds()),r._renderBackground(),r._renderRows(),r._renderHeaderBackground(),r._renderTicks(),r._renderKeyframes(),r._renderSelectionRect(),r._renderTimeline()):console.log("Context is not initialized")})),He(Le(r),"_getSharp",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=Math.round(e),t%2==0?e:e+r._pixelRatio/2})),He(Le(r),"getTime",(function(){return r._val})),He(Le(r),"_setTimeInternal",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.Programmatically;if(!r._options)return!1;if(e=Math.round(e),e=d.keepInBounds(e,r._options.min),r._val!=e){var n=r._val,o=new q;return o.val=e,o.prevVal=n,o.source=t,r._val=e,r.emit(Ee.TimeChanged,o),!o.isPrevented()||(r._val=n,!1)}return!1})),He(Le(r),"setTime",(function(e){if(r._drag&&r._drag.type===g.Timeline)return!1;var t=r._setTimeInternal(e,W.SetTimeMethod);return t&&(r.rescale(),r.redraw()),t})),He(Le(r),"getOptions",(function(){return r._options})),He(Le(r),"setOptions",(function(e){return r._options=r._setOptions(e),r.rescale(),r.redraw(),r._options})),He(Le(r),"_applyContainersStyles",(function(){if(r._scrollContainer&&r._options){var e=r._scrollContainer.classList;r._options.scrollContainerClass&&!e.contains(r._options.scrollContainerClass)&&e.add(r._options.scrollContainerClass),r._options.fillColor&&(r._scrollContainer.style.background=r._options.fillColor)}})),He(Le(r),"_setOptions",(function(e){return e?(r._options=d.mergeOptions(r._options,e),r._options.snapStep=d.keepInBounds(r._options.snapStep||0,0,r._options.stepVal||0),r._currentZoom=r._setZoom(r._options.zoom||0,r._options.zoomMin,r._options.zoomMax),r._options.min=d.isNumber(r._options.min)?r._options.min:0,r._options.max=d.isNumber(r._options.max)?r._options.max:Number.MAX_VALUE,r._applyContainersStyles(),!1===e.timelineDraggable&&r._drag&&r._drag.type===g.Timeline&&r._cleanUpSelection(),r._options):r._options||{}})),He(Le(r),"getModel",(function(){return r._model})),He(Le(r),"setModel",(function(e){r._model=e,r.rescale(),r.redraw()})),He(Le(r),"_getMousePos",(function(e,t){var n=1,o=0,i=0;if(t.changedTouches&&t.changedTouches.length>0){var l=t.changedTouches[0];o=l.clientX,i=l.clientY,n=Math.max(n,l.radiusX,l.radiusY)}else o=t.clientX,i=t.clientY;var a=e.getBoundingClientRect(),s=e.width/r._pixelRatio/a.width,c=e.height/r._pixelRatio/a.height;return{pos:{x:(o-a.left)*s,y:(i-a.top)*c},radius:n,args:t}})),He(Le(r),"_updateCanvasScale",(function(){if(!r._scrollContainer||!r._container||!r._ctx)return console.log("Component should be initialized first."),!1;var e=!1,t=r._scrollContainer.clientWidth*r._pixelRatio,n=r._scrollContainer.clientHeight*r._pixelRatio;return Math.floor(t)!=Math.floor(r._ctx.canvas.width)&&(r._ctx.canvas.width=t,e=!0),Math.floor(n)!=Math.floor(r._ctx.canvas.height)&&(r._ctx.canvas.height=n,e=!0),e&&r._ctx.setTransform(r._pixelRatio,0,0,r._pixelRatio,0,0),e})),He(Le(r),"rescale",(function(){return r._rescaleInternal()})),He(Le(r),"_rescaleInternal",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Te.DefaultMode,o=r._updateCanvasScale();if(!r._scrollContent)return o;var i=r._generateViewModel();if(i&&i.size){var l,a=r._options.stepPx||0;e=e||0;var s=r.valToPx(r._val)+r._leftMargin(),c=0,u=r.scrollLeft+r.getClientWidth();s>=u&&(c=n==Te.ScrollBySelection?Math.floor(s+r._leftMargin()):Math.floor(s+r.getClientWidth()+r._leftMargin()));var f=i.size.width+r._leftMargin()+a;e=Math.max(e,f,u,c);var d=Math.floor(e)+"px";d!=r._scrollContent.style.minWidth&&(r._scrollContent.style.minWidth=d,o=!0),t=Math.max(Math.floor(i.size.height+.2*r._canvasClientHeight()),((null===(l=r._scrollContainer)||void 0===l?void 0:l.scrollTop)||0)+r._canvasClientHeight()-1,Math.round(t||0));var v=Math.floor(t)+"px";if(r._scrollContent.style.minHeight!=v)return r._scrollContent.style.minHeight=v,o}return o})),He(Le(r),"_filterDraggableElements",(function(e){return e.filter((function(e){if(!e)return!1;var t;if(e.type===g.Keyframe){if(!S.keyframeDraggable(e.keyframe||null,(null===(t=e.keyframe)||void 0===t?void 0:t.group)||null,(null==e?void 0:e.row)||null,r._options))return!1}else if(e.type===g.Group){if(!S.groupDraggable(e.group||null,e.row||null,r._options))return!1}else if(e.type===g.Timeline){var n;if(!1===(null===(n=r._options)||void 0===n?void 0:n.timelineDraggable))return!1}else if(e.type===g.Row)return!1;return!0}))})),He(Le(r),"_findDraggableElement",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=function(e){return e===g.Timeline?1:e===g.Keyframe?2:e===g.Group?3:-1},o=function(e,o){var r=n(e.type),i=n(o.type);return r!==i||null!==t&&(r=d.getDistance(e.val,t))!==(i=d.getDistance(o.val,t))?r<i?1:-1:0},i=r._filterDraggableElements(e).sort(o);return i.length>0?i[i.length-1]:null})),He(Le(r),"elementFromPoint",(function(e,t,n){var o;t=Math.max(t,1);var l=[];if(!e)return l;var a,s=S.headerHeight(r._options),c=r._toScreenPx(r._val),u=0,f=null===(o=r._options)||void 0===o?void 0:o.timelineStyle;f&&(u=Math.max((f.width||1)*r._pixelRatio,((null==f||null===(a=f.capStyle)||void 0===a?void 0:a.width)||0)*r._pixelRatio||1)+t),(e.y<=.5*s||e.x>=c-u/2&&e.x<=c+u/2)&&l.push({val:r._val,type:g.Timeline});var v=r._options.snapEnabled;return e.y>=s&&r._options.keyframesDraggable&&r._forEachKeyframe((function(n,o,a){var s=n.rowViewModel;if(a){if(d.isOverlap(e.x,e.y,s.size)){var c={val:r._mousePosToVal(e.x,v),keyframes:s.model.keyframes,type:g.Row,row:s.model};l.push(c)}s.groupsViewModels&&s.groupsViewModels.forEach((function(t){if(null!=t&&t.size&&d.isOverlap(e.x,e.y,t.size)){var n=(null==t?void 0:t.keyframesViewModels.map((function(e){return e.model})))||[],o={val:r._mousePosToVal(e.x,v),type:g.Group,group:t.groupModel,row:s.model,keyframes:n},i=r.snapVal(t.min);o.val+=t.min-i,l.push(o)}}))}var u=n.size;if(u){var f=!1;if(n.shape===i.Rect){var y=d.shrinkSelf({x:e.x,y:e.y,height:t,width:t},t);f=d.isRectIntersects(y,u,!0)}else f=d.getDistance(u.x,u.y,e.x,e.y)<=u.height+t;f&&l.push({keyframe:n.model,keyframes:[n.model],val:n.model.val,row:n.rowViewModel.model,type:g.Keyframe})}})),n&&0!==n.length?l.filter((function(e){return n&&n.includes(e.type)})):l})),He(Le(r),"onTimeChanged",(function(e){r.on(Ee.TimeChanged,e)})),He(Le(r),"onDragStarted",(function(e){r.on(Ee.DragStarted,e)})),He(Le(r),"onDrag",(function(e){r.on(Ee.Drag,e)})),He(Le(r),"onDragFinished",(function(e){r.on(Ee.DragFinished,e)})),He(Le(r),"onDoubleClick",(function(e){r.on(Ee.DoubleClick,e)})),He(Le(r),"onKeyframeChanged",(function(e){r.on(Ee.KeyframeChanged,e)})),He(Le(r),"onMouseDown",(function(e){r.on(Ee.MouseDown,e)})),He(Le(r),"onSelected",(function(e){r.on(Ee.Selected,e)})),He(Le(r),"onScroll",(function(e){r.on(Ee.Scroll,e)})),He(Le(r),"onZoom",(function(e){r.on(Ee.Zoom,e)})),He(Le(r),"onScrollFinished",(function(e){r.on(Ee.ScrollFinished,e)})),He(Le(r),"_emitScrollEvent",(function(e,t){var o,i,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ee.Scroll,s={args:e,scrollProgrammatically:t,scrollLeft:r.scrollLeft,scrollTop:r.scrollTop,scrollHeight:(null===(o=r._scrollContainer)||void 0===o?void 0:o.scrollHeight)||0,scrollWidth:(null===(i=r._scrollContainer)||void 0===i?void 0:i.scrollWidth)||0};return Be((n=Le(r),Ze(a.prototype)),"emit",n).call(n,l,s),s})),He(Le(r),"_emitZoomEvent",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ee.Zoom,i={args:e};return Be((o=Le(r),Ze(a.prototype)),"emit",o).call(o,n,i),i})),He(Le(r),"_emitKeyframeChanged",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W.Programmatically,n=new L;return n.val=e.val,n.prevVal=e.prevVal,n.target=e,n.source=t,r.emit(Ee.KeyframeChanged,n),n})),He(Le(r),"_emitDragStartedEvent",(function(e){if(!e)return null;var t=r._getDragEventArgs(e,r._currentPos);return r.emit(Ee.DragStarted,t),t.isPrevented()&&r._preventDrag(t,e,!0),t})),He(Le(r),"_emitDragFinishedEvent",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||!e.changed)return null;var n=r._getDragEventArgs(e,r._currentPos);return t&&n.preventDefault(),r.emit(Ee.DragFinished,n),n.isPrevented()&&r._preventDrag(n,e,!0),n})),He(Le(r),"_preventDrag",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.elements&&e.elements.forEach((function(e){var t=n?e.startedVal:e.prevVal;r._setKeyframePos(e,t)})),t.val=t.prevVal,e.point=e.prevPoint})),He(Le(r),"_emitDragEvent",(function(e){if(!e)return null;var t=r._getDragEventArgs(e,r._currentPos);return r.emit(Ee.Drag,t),t.isPrevented()&&r._preventDrag(t,e,!1),t})),He(Le(r),"_emitGroupSelected",(function(e){var t=new oe;return t.selected=e.selected,t.changed=e.changed,t.drag=e.drag,t.mode=e.mode,r.emit(Ee.Selected,t),t})),He(Le(r),"_emitKeyframesSelected",(function(e){var t=new oe;return t.selected=e.selected,t.changed=e.changed,r.emit(Ee.Selected,t),t})),He(Le(r),"_getDragEventArgs",(function(e,t){var n=new Re;return n.point=t,n.elements=Ne(e.elements||[]),n.target=(null==e?void 0:e.target)||null,n})),r._options=d.cloneOptions(je),(s||c)&&r.initialize(s,c),r}return t=a,n=[{key:"_getCtx",value:function(){return this._canvas?(this._ctx||(this._ctx=this._canvas.getContext("2d")),this._ctx):null}},{key:"_moveElements",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:W.Programmatically;if(!t)return 0;var r=!1;if(Math.abs(e)>0){var i={min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER};if(i=d.setMinMax(i,this._options),t.forEach((function(t){var o;if(t&&t.keyframe){var r=d.setMinMax(d.setMinMax({min:i.min,max:i.max},t.keyframe),t.row||null),l=(null!==(o=n._options)&&void 0!==o&&o.snapAllKeyframesOnMove?n.snapVal(t.keyframe.val):t.keyframe.val)+e;(r.min||0===r.min)&&d.isNumber(r.min)&&l<r.min&&(e+=d.getDistance(r.min,l)),(r.max||0===r.max)&&d.isNumber(r.max)&&l>r.max&&(e-=d.getDistance(r.max,l))}})),Math.abs(e)>0&&t.forEach((function(t){if(null!=t&&t.keyframe){var i=t.keyframe.val,l=i+e,a=n._setKeyframePos(t,l,o);r=a!==i}})),r)return e}return 0}},{key:"_forEachKeyframe",value:function(e){var t;if(e&&this._model){var n=this._generateViewModel();n&&(null==n||null===(t=n.rowsViewModels)||void 0===t||t.forEach((function(t){if(t){var n=!0;t.keyframesViewModels.forEach((function(t,o){t&&e(t,o,n),n=!1}))}})))}}},{key:"_trackMousePos",value:function(e,t){var n=this._getMousePos(e,t),o=n.pos;if(n.originalVal=this._mousePosToVal(o.x,!1),n.snapVal=this._mousePosToVal(o.x,!0),n.val=n.originalVal,this._options&&this._options.snapEnabled&&(n.val=n.snapVal),this._startPosMouseArgs){var r,i;this._selectionRect||(this._selectionRect={});var l=this._startPosMouseArgs.pos,a=Math.floor(l.x+(((null===(r=this._scrollStartPos)||void 0===r?void 0:r.x)||0)-this.scrollLeft)),s=Math.floor(l.y+(((null===(i=this._scrollStartPos)||void 0===i?void 0:i.y)||0)-this.scrollTop));this._selectionRect.x=Math.min(a,o.x),this._selectionRect.y=Math.min(s,o.y),this._selectionRect.width=Math.max(a,o.x)-this._selectionRect.x,this._selectionRect.height=Math.max(s,o.y)-this._selectionRect.y,this._clickAllowed&&(this._clickAllowed=this._selectionRect.height<=this._consts.clickThreshold&&this._selectionRect.width<=this._consts.clickThreshold)}return n}},{key:"getClientWidth",value:function(){var e;return(null===(e=this._scrollContainer)||void 0===e?void 0:e.clientWidth)||0}},{key:"getClientHeight",value:function(){var e;return(null===(e=this._scrollContainer)||void 0===e?void 0:e.clientHeight)||0}},{key:"_cleanUpSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._drag&&this._emitDragFinishedEvent(this._drag,e),this._startPosMouseArgs=null,this._drag=null,this._scrollAreaClickOrDragStarted=!1,this._startedDragWithCtrl=!1,this._startedDragWithShiftKey=!1,this._selectionRect=null,this._clickTimeout=null,this._scrollStartPos=null,this._isPanStarted=!1,this._clickAllowed=!1,this._stopAutoPan()}},{key:"_clickTimeoutIsOver",value:function(){return!!(this._clickTimeout&&Date.now()-this._clickTimeout>this._consts.clickDetectionMs)}},{key:"_checkUpdateSpeedTooFast",value:function(){return!!(this._autoPanLastActionDate&&Date.now()-this._autoPanLastActionDate<=this._consts.autoPanSpeedLimit)||(this._autoPanLastActionDate=Date.now(),!1)}},{key:"_scrollByPan",value:function(e,t,n){if(e&&t&&this._scrollContainer){var o=0,r=0;n&&(o=n.x,r=n.y);var i=Math.round(e.x-t.x),l=o+i;i>0&&this._rescaleInternal(l+this._canvasClientWidth()),i>0&&l+this._canvasClientWidth()>=this._scrollContainer.scrollWidth-5?this.scrollLeft=this._scrollContainer.scrollWidth:this.scrollLeft=l,this.scrollTop=Math.round(r+e.y-t.y)}}},{key:"_scrollBySelectionOutOfBounds",value:function(e){if(!this._scrollContainer)return!1;var t=e.x,n=e.y,o=!1,r=0,i=0,l=this._consts.autoPanByScrollPadding,a=t<=l,s=t>=this._canvasClientWidth()-l,c=n<=l,u=n>=this._canvasClientHeight()-l,f=null,v=null;if(a||s||c||u){if(this._startAutoPan(),this._checkUpdateSpeedTooFast())return!1;var y=isNaN(this._consts.scrollByDragSpeed)?1:this._consts.scrollByDragSpeed;a?r=-d.getDistance(t,l)*y:s&&(r=d.getDistance(t,this._canvasClientWidth()-l)*y,f=this.scrollLeft+this._canvasClientWidth()+r),c?i=-d.getDistance(t,l)*y/4:u&&(i=d.getDistance(t,this._canvasClientHeight()-l)*y/4,v=this._scrollContainer.scrollTop+this._canvasClientHeight())}else this._stopAutoPan();return(f||v)&&this._rescaleInternal(f,v,Te.ScrollBySelection),Math.abs(r)>0&&(this.scrollLeft=this._scrollContainer.scrollLeft+r,o=!0),Math.abs(i)>0&&(this.scrollTop=this._scrollContainer.scrollTop+i,o=!0),o}},{key:"pxToVal",value:function(e){if(!this._options)return e;var t=this._options.min||0;d.isNumber(t)||(t=0);var n=this._options.stepPx||0;return 0===n?e:(t*=this._currentZoom||1)+e/n*((this._options.stepVal||0)*this._currentZoom||1)}},{key:"snapVal",value:function(e){if(this._options&&this._options.snapEnabled&&this._options.snapStep){var t=this._options.snapStep,n=e/t,o=Math.round(n),r=Math.abs(this._options.min||0)/this._options.snapStep,i=d.sign(this._options.min||1)*(r-Math.floor(r))*this._options.snapStep;e=Math.round(i)+Math.round(o*t)}return d.keepInBounds(e,this._options.min,this._options.max)}},{key:"scrollLeft",get:function(){var e;return(null===(e=this._scrollContainer)||void 0===e?void 0:e.scrollLeft)||0},set:function(e){this._scrollContainer&&this._scrollContainer.scrollLeft!==e&&(this._scrollProgrammatically=!0,this._scrollContainer.scrollLeft=e)}},{key:"scrollTop",get:function(){var e;return(null===(e=this._scrollContainer)||void 0===e?void 0:e.scrollTop)||0},set:function(e){this._scrollContainer&&this._scrollContainer.scrollTop!==e&&(this._scrollProgrammatically=!0,this._scrollContainer.scrollTop=e)}}],n&&Ke(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(l);return t})()));