{"version":3,"file":"animation-timeline.js","mappings":"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C,sBAAsB,GAAG;EACpC;AACF;AACA;EACEC,sBAAsB,EAAE,KAAK;EAE7B;AACF;AACA;EACEC,WAAW,EAAE,IAAI;EAEjB;AACF;AACA;EACEC,aAAa,EAAET,oBAAoB;EACnC;AACF;AACA;EACEU,MAAM,EAAE,GAAG;EACX;AACF;AACA;EACEC,OAAO,EAAE,IAAI;EACbC,WAAW,EAAE,EAAE;EACf;AACF;AACA;EACEC,QAAQ,EAAE,GAAG;EACb;AACF;AACA;EACEC,UAAU,EAAE,EAAE;EACdC,eAAe,EAAE,SAAS;EAC1BxF,SAAS,EAAE,SAAS;EAEpByF,WAAW,EAAE,SAAS;EACtB;AACF;AACA;EACEC,SAAS,EAAE,SAAS;EACpB;AACF;AACA;EACEC,cAAc,EAAE,OAAO;EAEvB;AACF;AACA;AACA;EACE5D,SAAS,EAAEvB,uBAAuB;EAElC;AACF;AACA;AACA;EACEE,cAAc,EAAET,4BAA4B;EAC5C;AACF;AACA;EACEU,WAAW,EAAEb,iBAAiB;EAC9B;AACF;AACA;EACEkC,YAAY,EAAE,EAAE;EAChB4D,IAAI,EAAE,iBAAiB;EACvB;AACF;AACA;EACEC,IAAI,EAAE,CAAC;EACP;AACF;AACA;EACEC,SAAS,EAAE,GAAG;EACd;AACF;AACA;EACEC,OAAO,EAAE,GAAG;EACZ;AACF;AACA;EACEC,OAAO,EAAE,CAAC;EACV;AACF;AACA;EACEC,mBAAmB,EAAE,KAAK;EAC1B;AACF;AACA;EACEC,oBAAoB,EAAE,kBAAkB;EACxC;AACF;AACA;EACE5D,eAAe,EAAE,IAAI;EACrB;AACF;AACA;EACED,kBAAkB,EAAE,IAAI;EACxB;AACF;AACA;EACE8D,iBAAiB,EAAE,IAAI;EACvB;AACF;AACA;AACA;EACE7J,GAAG,EAAE,CAAC;EACN;AACF;AACA;EACEC,GAAG,EAAE1B,MAAM,CAACuL;AACd,CAAoB;;;;;;;;;;;;;;;;;;;;;;;;ACpHpB;AACA;;AAEgE;AAWA;AACV;AAQgB;;AAEtE;;AAMA;AAC2F;AACR;AACN;AAEN;AACF;;AAErE;AACsE;AACI;AACR;AACF;AACJ;AACM;AACI;AACA;AAEd;AACxD;;AAEoE;AACc;AACE;AAE7E,IAAMC,QAAQ;EAAA;EAAA;EACnB;AACF;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;AACA;;EAGE;AACF;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;;EAUE;AACF;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;AACA;;EAGE;AACF;AACA;;EAEE;AACF;AACA;;EAEE;AACF;AACA;AACA;;EAEE;AACF;AACA;AACA;;EAEE;AACF;AACA;AACA;;EAIE;AACF;AACA;AACA;;EAEE;AACF;AACA;AACA;;EAEE;AACF;AACA;AACA;AACA;EACE,oBAAwF;IAAA;IAAA,IAA5EzE,QAA+B,uEAAG,IAAI;IAAA,IAAE0E,MAA2B,uEAAG,IAAI;IAAA;IACpF;IAAQ,6EA/GuB,IAAI;IAAA,0EAID,IAAI;IAAA,mFAID,IAAI;IAAA,iFAKN,IAAI;IAAA,uEAID,IAAI;IAAA;IAAA,qFAQG,IAAI;IAAA,kFAIhB,IAAI;IAAA,8EAKC,IAAI;IAAA,iFAKX,IAAI;IAAA,wFAIb,KAAK;IAAA,wEAIS,IAAI;IAAA,uFACnB,KAAK;IAAA,2FACD,KAAK;IAAA,iFACf,KAAK;IAAA,0FACI,KAAK;IAAA,gFACA,IAAI;IAAA,iFAClB,CAAC;IAAA,kFACiB,IAAI;IAAA,0EACbxC,qBAAqB;IAAA,gFAI/B,KAAK;IAAA,0FAIqB,IAAI;IAAA,uEAKvC,CAAC;IAAA,8EACM,CAAC;IAAA,+EAIA,CAAC;IAAA,+EAIe,IAAI;IAAA,yFAKV,CAAC;IAAA,gFAKV,KAAK;IAAA,mFAKFP,iCAAiC;IAAA,gFAEJ,IAAI;IAAA,yEAKrB,IAAI;IAAA,gGAKH,KAAK;IAAA,6EAoBjB,UAAC3B,OAA+B,EAAE0E,KAA2B,EAAW;MAC1F,MAAKE,MAAM,GAAGF,KAAK;MACnB,IAAI,CAAC1E,OAAO,IAAI,CAACA,OAAO,CAACjC,EAAE,EAAE;QAC3B,MAAM,IAAI8G,KAAK,6DAA6D;MAC9E;MAEA,MAAKC,mBAAmB,CAAC9E,OAAO,CAACjC,EAAE,CAAC;MACpC,MAAKgH,QAAQ,GAAGxM,0BAA0B,CAAC4K,sBAAsB,CAAC;MAClE,IAAInD,OAAO,EAAE;QACX,MAAK+E,QAAQ,GAAG,MAAKC,WAAW,CAAChF,OAAO,CAAC;MAC3C;MACA,MAAKiF,yBAAyB,EAAE;MAChC,MAAKC,OAAO,EAAE;MACd,MAAKC,MAAM,EAAE;IACf,CAAC;IAAA,sFAMqB,UAACpH,EAAwB,EAAW;MACxD,IAAIA,EAAE,YAAYqH,WAAW,EAAE;QAC7B,MAAKC,UAAU,GAAGtH,EAAiB;MACrC,CAAC,MAAM;QACL,MAAKsH,UAAU,GAAG5I,QAAQ,CAAC6I,cAAc,CAACvH,EAAE,CAAC;MAC/C;MAEA,IAAI,CAAC,MAAKsH,UAAU,EAAE;QACpB,MAAM,IAAIR,KAAK,6DAA6D;MAC9E;MAEA,MAAKU,gBAAgB,GAAG9I,QAAQ,CAAC+I,aAAa,CAAC,KAAK,CAAC;MACrD,MAAKC,cAAc,GAAGhJ,QAAQ,CAAC+I,aAAa,CAAC,KAAK,CAAC;MACnD,MAAKE,OAAO,GAAGjJ,QAAQ,CAAC+I,aAAa,CAAC,QAAQ,CAAC;MAE/C,IAAI,CAAC,MAAKE,OAAO,IAAI,CAAC,MAAKA,OAAO,CAACC,UAAU,EAAE;QAC7C/J,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;QAChD;MACF;MAEA,MAAKwJ,UAAU,CAAClG,KAAK,CAACyG,QAAQ,GAAG,UAAU;MAC3C;MACA,MAAKF,OAAO,CAACvG,KAAK,CAAC0G,OAAO,GACxB,oCAAoC,GACpC,uCAAuC,GACvC,6BAA6B,GAC7B,+BAA+B,GAC/B,oBAAoB,GACpB,4BAA4B,GAC5B,2BAA2B,GAC3B,yBAAyB,GACzB,uBAAuB,GACvB,oBAAoB,GACpB,qBAAqB,GACrB,qBAAqB,GACrB,0BAA0B,GAC1B,yBAAyB,GACzB,uBAAuB,GACvB,qBAAqB,GACrB,kBAAkB,GAClB,kBAAkB;;MAEpB;MACA,MAAKN,gBAAgB,CAACpG,KAAK,CAAC0G,OAAO,GAAG,mBAAmB,GAAG,qBAAqB,GAAG,eAAe,GAAG,gBAAgB;MACtH,MAAKJ,cAAc,CAACtG,KAAK,CAACxF,KAAK,GAAG,MAAK8L,cAAc,CAACtG,KAAK,CAACvF,MAAM,GAAG,MAAM;;MAE3E;MACA,MAAK2L,gBAAgB,CAACO,WAAW,CAAC,MAAKL,cAAc,CAAC;MACtD,MAAKJ,UAAU,CAACS,WAAW,CAAC,MAAKP,gBAAgB,CAAC;MAClD,IAAMQ,cAAc,GAAG,MAAKR,gBAAgB,CAACS,WAAW,GAAG,MAAKP,cAAc,CAACQ,WAAW;MAC1F;MACA,MAAKP,OAAO,CAACvG,KAAK,CAACxF,KAAK,GAAG,MAAK+L,OAAO,CAACvG,KAAK,CAACvF,MAAM,GAAG,aAAa,IAAImM,cAAc,IAAI,EAAE,CAAC,GAAG,KAAK;MAErG,MAAKV,UAAU,CAACS,WAAW,CAAC,MAAKJ,OAAO,CAAC;MACzC,MAAKQ,IAAI,GAAG,MAAKC,OAAO,EAAE;IAC5B,CAAC;IAAA,4FAkB2B,YAAY;MACtC;MACA,MAAKC,2BAA2B,EAAE;MAClC,IAAI,CAAC,MAAKf,UAAU,IAAI,CAAC,MAAKE,gBAAgB,IAAI,CAAC,MAAKG,OAAO,EAAE;QAC/D,MAAMb,KAAK,uHAAuH;MACpI;MACA,IAAI,MAAKQ,UAAU,EAAE;QACnB,MAAKA,UAAU,CAACgB,gBAAgB,CAAC,OAAO,EAAE,MAAKC,iBAAiB,CAAC;MACnE;MACA,IAAI,MAAKf,gBAAgB,EAAE;QACzB,MAAKA,gBAAgB,CAACc,gBAAgB,CAAC,QAAQ,EAAE,MAAKE,kBAAkB,CAAC;QACzE,MAAKhB,gBAAgB,CAACc,gBAAgB,CAAC,YAAY,EAAE,MAAKG,2BAA2B,CAAC;QACtF,MAAKjB,gBAAgB,CAACc,gBAAgB,CAAC,WAAW,EAAE,MAAKG,2BAA2B,CAAC;MACvF;MACA/J,QAAQ,CAAC4J,gBAAgB,CAAC,OAAO,EAAE,MAAKI,YAAY,EAAE,KAAK,CAAC;MAC5DhK,QAAQ,CAAC4J,gBAAgB,CAAC,SAAS,EAAE,MAAKK,cAAc,EAAE,KAAK,CAAC;MAChEtK,MAAM,CAACiK,gBAAgB,CAAC,MAAM,EAAE,MAAKM,gBAAgB,EAAE,KAAK,CAAC;MAC7DvK,MAAM,CAACiK,gBAAgB,CAAC,QAAQ,EAAE,MAAKO,wBAAwB,EAAE,KAAK,CAAC;MACvE,IAAI,MAAKlB,OAAO,EAAE;QAChB,MAAKA,OAAO,CAACW,gBAAgB,CAAC,YAAY,EAAE,MAAKQ,qBAAqB,EAAE,KAAK,CAAC;QAC9E,MAAKnB,OAAO,CAACW,gBAAgB,CAAC,WAAW,EAAE,MAAKQ,qBAAqB,EAAE,KAAK,CAAC;MAC/E;MACAzK,MAAM,CAACiK,gBAAgB,CAAC,WAAW,EAAE,MAAKS,qBAAqB,EAAE,KAAK,CAAC;MACvE1K,MAAM,CAACiK,gBAAgB,CAAC,WAAW,EAAE,MAAKS,qBAAqB,EAAE,KAAK,CAAC;MACvE1K,MAAM,CAACiK,gBAAgB,CAAC,SAAS,EAAE,MAAKU,mBAAmB,EAAE,KAAK,CAAC;MACnE3K,MAAM,CAACiK,gBAAgB,CAAC,UAAU,EAAE,MAAKU,mBAAmB,EAAE,KAAK,CAAC;IACtE,CAAC;IAAA,8FAK6B,YAAY;MAAA;MACxC,0BAAK1B,UAAU,qDAAf,iBAAiB2B,mBAAmB,CAAC,OAAO,EAAE,MAAKV,iBAAiB,CAAC;MAErE,IAAI,MAAKf,gBAAgB,EAAE;QACzB,MAAKA,gBAAgB,CAACyB,mBAAmB,CAAC,QAAQ,EAAE,MAAKT,kBAAkB,CAAC;QAC5E,MAAKhB,gBAAgB,CAACyB,mBAAmB,CAAC,YAAY,EAAE,MAAKR,2BAA2B,CAAC;QACzF,MAAKjB,gBAAgB,CAACyB,mBAAmB,CAAC,WAAW,EAAE,MAAKR,2BAA2B,CAAC;MAC1F,CAAC,MAAM;QACL5K,OAAO,CAACqL,IAAI,sDAAsD;MACpE;MACA7K,MAAM,CAAC4K,mBAAmB,CAAC,MAAM,EAAE,MAAKL,gBAAgB,CAAC;MACzDvK,MAAM,CAAC4K,mBAAmB,CAAC,QAAQ,EAAE,MAAKJ,wBAAwB,CAAC;MACnEnK,QAAQ,CAACuK,mBAAmB,CAAC,SAAS,EAAE,MAAKN,cAAc,CAAC;MAC5DjK,QAAQ,CAACuK,mBAAmB,CAAC,OAAO,EAAE,MAAKP,YAAY,CAAC;MACxD,IAAI,MAAKf,OAAO,EAAE;QAChB,MAAKA,OAAO,CAACsB,mBAAmB,CAAC,YAAY,EAAE,MAAKH,qBAAqB,CAAC;QAC1E,MAAKnB,OAAO,CAACsB,mBAAmB,CAAC,WAAW,EAAE,MAAKH,qBAAqB,CAAC;MAC3E,CAAC,MAAM;QACLjL,OAAO,CAACqL,IAAI,sDAAsD;MACpE;MACA7K,MAAM,CAAC4K,mBAAmB,CAAC,WAAW,EAAE,MAAKF,qBAAqB,CAAC;MACnE1K,MAAM,CAAC4K,mBAAmB,CAAC,WAAW,EAAE,MAAKF,qBAAqB,CAAC;MACnE1K,MAAM,CAAC4K,mBAAmB,CAAC,SAAS,EAAE,MAAKD,mBAAmB,CAAC;MAC/D3K,MAAM,CAAC4K,mBAAmB,CAAC,UAAU,EAAE,MAAKD,mBAAmB,CAAC;IAClE,CAAC;IAAA,0EAIgB,YAAY;MAC3B;MACA,MAAKG,MAAM,EAAE;MACb;MACA,MAAKC,YAAY,EAAE;MACnB,MAAKC,yBAAyB,EAAE;MAChC,MAAKhB,2BAA2B,EAAE;MAClC,MAAKf,UAAU,GAAG,IAAI;MACtB,MAAKK,OAAO,GAAG,IAAI;MACnB,MAAKH,gBAAgB,GAAG,IAAI;MAC5B,MAAKE,cAAc,GAAG,IAAI;MAC1B,MAAKS,IAAI,GAAG,IAAI;MAChB,MAAKmB,iBAAiB,EAAE;IAC1B,CAAC;IAAA,+EAIc,UAACnP,KAAoB,EAAW;MAC7C,IAAI,MAAKoP,gBAAgB,KAAK3F,4BAA4B,EAAE;QAC1D,MAAK6F,cAAc,CAACtP,KAAK,CAAC;MAC5B;IACF,CAAC;IAAA,iFAIgB,UAACA,KAAoB,EAAW;MAC/C,IAAI,MAAKoP,gBAAgB,KAAK3F,4BAA4B,EAAE;QAC1D,MAAK6F,cAAc,CAACtP,KAAK,CAAC;MAC5B;IACF,CAAC;IAAA,iFACgB,UAACuP,CAA6B,EAAW;MACxD,IAAI,MAAKC,kBAAkB,CAACD,CAAC,CAAC,EAAE;QAC9B,MAAKE,UAAU,CAAC/F,0BAA0B,CAAC;MAC7C,CAAC,MAAM;QACL,MAAK+F,UAAU,CAAC/F,yBAAyB,CAAC;MAC5C;IACF,CAAC;IAAA,mFACkB,YAAY;MAC7B,MAAKyF,iBAAiB,CAAC,IAAI,CAAC;IAC9B,CAAC;IAAA,2FAC0B,YAAY;MACrC;MACA,MAAKnC,OAAO,EAAE;MACd,MAAKC,MAAM,EAAE;IACf,CAAC;IAAA,4FAE2B,YAAY;MACtC,IAAI,MAAK2C,uBAAuB,EAAE;QAChCC,YAAY,CAAC,MAAKD,uBAAuB,CAAC;QAC1C,MAAKA,uBAAuB,GAAG,IAAI;MACrC;IACF,CAAC;IAAA,8FAC6B,YAAY;MACxC,MAAKE,6BAA6B,GAAG,IAAI;IAC3C,CAAC;IAAA,qFACoB,UAAC7P,IAAW,EAAW;MAC1C,IAAM8P,sBAAsB,GAAG,MAAKC,uBAAuB;MAC3D,IAAI,MAAKA,uBAAuB,EAAE;QAChC,MAAKA,uBAAuB,GAAG,KAAK;MACtC;MACA;MACA,MAAKd,yBAAyB,EAAE;MAChC;MACA;MACA,MAAKU,uBAAuB,GAAG1L,MAAM,CAAC+L,UAAU,CAAC,YAAM;QACrD,IAAI,CAAC,MAAKC,aAAa,EAAE;UACvB,MAAKhB,yBAAyB,EAAE;;UAEhC;UACA;QACF;;QACA,MAAKiB,gBAAgB,CAAClQ,IAAI,EAAE8P,sBAAsB,EAAEjG,6BAA6B,CAAC;MACpF,CAAC,EAAE,MAAKuG,OAAO,CAAChG,uBAAuB,CAAC;MAExC,MAAK4C,MAAM,EAAE;MACb,MAAKkD,gBAAgB,CAAClQ,IAAI,EAAE8P,sBAAsB,CAAC;IACrD,CAAC;IAAA,qFACoB,UAACR,CAA0C,EAAc;MAC5E,IAAI,CAAC,MAAK1C,QAAQ,IAAI,MAAKA,QAAQ,CAACV,mBAAmB,KAAKrI,SAAS,EAAE;QACrE,OAAOyL,CAAC,CAACe,OAAO,IAAIf,CAAC,CAACgB,OAAO;MAC/B;MACA,OAAO,MAAK1D,QAAQ,CAACV,mBAAmB,IAAI,MAAKU,QAAQ,CAACV,mBAAmB,GAAGoD,CAAC,CAACe,OAAO,GAAGf,CAAC,CAACgB,OAAO;IACvG,CAAC;IAAA,oFACmB,UAACvQ,KAAiB,EAAW;MAC/C,IAAI,CAAC,MAAKqN,gBAAgB,IAAI,CAAC,MAAKG,OAAO,EAAE;QAC3C;QACA;MACF;MACA,IAAI,MAAKgC,kBAAkB,CAACxP,KAAK,CAAC,EAAE;QAClCA,KAAK,CAACwQ,cAAc,EAAE;QACtB,IAAMC,iBAAiB,GAAG,MAAKC,YAAY,CAAC,MAAKlD,OAAO,EAAExN,KAAK,CAAC;QAChE,IAAM2Q,QAAQ,GAAGvO,IAAI,CAACK,GAAG,CAAC,CAAC,EAAEgO,iBAAiB,CAAClH,GAAG,CAACjI,CAAC,IAAI,CAAC,CAAC;QAC1D,MAAKsP,KAAK,CAACvQ,kBAAkB,CAACL,KAAK,CAAC6Q,MAAM,CAAC,EAAE,MAAKhE,QAAQ,CAACb,SAAS,IAAI,CAAC,EAAE2E,QAAQ,CAAC;MACtF,CAAC,MAAM;QACL,MAAKG,SAAS,GAAG,MAAKzD,gBAAgB,CAACyD,SAAS,GAAG9Q,KAAK,CAAC6Q,MAAM;QAC/D7Q,KAAK,CAACwQ,cAAc,EAAE;MACxB;IACF,CAAC;IAAA,wEACO,UAACO,SAAiB,EAAEC,KAAa,EAAE1P,CAAS,EAAW;MAC7D,IAAI0P,KAAK,IAAIA,KAAK,GAAG,CAAC,IAAIA,KAAK,IAAI,CAAC,EAAE;QACpC,IAAMC,UAAU,GAAG5Q,yBAAyB,CAAC,MAAK6Q,kBAAkB,EAAE,GAAG,CAAC,EAAE5P,CAAC,CAAC,GAAG,GAAG;QACpFA,CAAC,GAAGA,CAAC,GAAG2P,UAAU;QAClB,IAAME,IAAI,GAAG,MAAKD,kBAAkB,EAAE,GAAG5P,CAAC;QAC1C,IAAMT,GAAG,GAAG,MAAKuQ,WAAW,CAAC9P,CAAC,CAAC;QAC/B,IAAMyK,IAAI,GAAGgF,SAAS,GAAG,MAAKM,YAAY,GAAGL,KAAK;QAClD;QACA,MAAKK,YAAY,GAAG,MAAKC,QAAQ,CAAC,MAAKD,YAAY,GAAGtF,IAAI,CAAC;QAC3D;QACA,IAAMwF,UAAU,GAAG,MAAKC,OAAO,CAAC3Q,GAAG,CAAC;QACpC,IAAI4Q,aAAa,GAAGrP,IAAI,CAACsP,KAAK,CAACH,UAAU,GAAG,MAAKL,kBAAkB,EAAE,GAAGC,IAAI,CAAC;QAC7E,IAAIM,aAAa,IAAI,CAAC,EAAE;UACtBA,aAAa,GAAG,CAAC;QACnB;QAEA,MAAKE,gBAAgB,CAACF,aAAa,GAAG,MAAKP,kBAAkB,EAAE,EAAE,IAAI,EAAEnH,6BAA6B,CAAC;QACrG,MAAK8H,UAAU,GAAGJ,aAAa;QAE/B,MAAKxE,MAAM,EAAE;QACb,MAAK6E,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC;MACjC;IACF,CAAC;IAAA,yEAKe,YAA2C;MAAA;MAAA,IAA1Cd,KAAK,uEAAG,MAAKnE,QAAQ,CAACb,SAAS;MAC9C,IAAMvK,KAAK,GAAG,gCAAK4L,gBAAgB,0DAArB,sBAAuBU,WAAW,KAAI,CAAC;MACrD,IAAIiD,KAAK,IAAIvP,KAAK,EAAE;QAClB,MAAKmP,KAAK,CAAC,CAAC,EAAEI,KAAK,EAAEvP,KAAK,GAAG,CAAC,CAAC;MACjC;IACF,CAAC;IAAA,0EAKgB,YAA2C;MAAA;MAAA,IAA1CuP,KAAK,uEAAG,MAAKnE,QAAQ,CAACb,SAAS;MAC/C,IAAMvK,KAAK,GAAG,iCAAK4L,gBAAgB,2DAArB,uBAAuBU,WAAW,KAAI,CAAC;MACrD,IAAIiD,KAAK,IAAIvP,KAAK,EAAE;QAClB,MAAKmP,KAAK,CAAC,CAAC,CAAC,EAAEI,KAAK,EAAEvP,KAAK,GAAG,CAAC,CAAC;MAClC;IACF,CAAC;IAAA,2EAQU,UAACsK,IAAY,EAA2F;MAAA;MAAA,IAAzFvJ,GAA8B,uEAAG,IAAI;MAAA,IAAEC,GAA8B,uEAAG,IAAI;MACpGD,GAAG,GAAGnC,sBAAsB,CAACmC,GAAG,CAAC,GAAGA,GAAG,qBAAG,MAAKqK,QAAQ,mDAAb,eAAeZ,OAAO;MAChExJ,GAAG,GAAGpC,sBAAsB,CAACoC,GAAG,CAAC,GAAGA,GAAG,sBAAG,MAAKoK,QAAQ,oDAAb,gBAAeX,OAAO;MAChE,IAAI7L,sBAAsB,CAAC0L,IAAI,CAAC,EAAE;QAChCA,IAAI,GAAG1L,0BAA0B,CAAC0L,IAAI,EAAEvJ,GAAG,EAAEC,GAAG,CAAC;QACjDsJ,IAAI,GAAGA,IAAI,IAAI,CAAC;QAChB,MAAKsF,YAAY,GAAGtF,IAAI;QACxB,OAAOA,IAAI;MACb;MAEA,OAAOA,IAAI;IACb,CAAC;IAAA,0EAQS,UAACA,IAAY,EAAa;MAClC,IAAMiG,QAAQ,GAAG,MAAKC,OAAO,EAAE;MAC/B,IAAID,QAAQ,KAAKjG,IAAI,EAAE;QACrB,IAAMmG,OAAO,GAAG,MAAKZ,QAAQ,CAACvF,IAAI,CAAC;QACnC,IAAIiG,QAAQ,IAAIE,OAAO,EAAE;UACvB,MAAKlF,OAAO,EAAE;UACd,MAAKC,MAAM,EAAE;UACb,OAAOiF,OAAO;QAChB;MACF;MACA,OAAOF,QAAQ;IACjB,CAAC;IAAA,0EAIS,YAAc;MACtB,IAAI3R,sBAAsB,CAAC,MAAKgR,YAAY,CAAC,EAAE;QAC7C,OAAO,MAAKA,YAAY,IAAI,CAAC;MAC/B;MACA,OAAO,CAAC;IACV,CAAC;IAAA,kFAIiB,YAAW;MAC3B,MAAKc,eAAe,CAAC,IAAI,CAAC;MAC1B,MAAKlF,MAAM,EAAE;IACf,CAAC;IAAA,2FAE0B,UAAC3D,KAAwB,EAAa;MAC/D,IAAMnC,YAAY,GAAG,MAAKkJ,OAAO,CAAC7F,uBAAuB,IAAI,CAAC;MAC9D,OAAOpI,IAAI,CAACK,GAAG,CAAC0E,YAAY,EAAE,CAAAmC,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAE8I,MAAM,KAAIjL,YAAY,CAAC;IAC9D,CAAC;IAAA,wFAIuB,UAAClH,IAA6B,EAAW;MAC/D;MACAI,mCAAmC,EAAE;MACrC,IAAI,CAAC,MAAKmN,OAAO,IAAI,CAAC,MAAKH,gBAAgB,EAAE;QAC3C,MAAK8B,iBAAiB,EAAE;QACxB;MACF;MACA,MAAKmD,kBAAkB,GAAG,MAAKC,cAAc,CAAC,MAAK/E,OAAO,EAAEvN,IAAI,CAAC;MAEjE,IAAI,CAAC,MAAKqS,kBAAkB,EAAE;QAC5B;MACF;MACA,IAAIE,aAAa,GAAGC,IAAI,CAACC,GAAG,EAAE,GAAG,MAAKC,cAAc,GAAG,MAAKtC,OAAO,CAACjG,oBAAoB;MACxF;MACA,IACE,MAAKwI,eAAe,IACpB,MAAKN,kBAAkB,IACvBjS,yBAAyB,CAAC,MAAKuS,eAAe,CAACtR,CAAC,EAAE,MAAKsR,eAAe,CAACrR,CAAC,EAAE,MAAK+Q,kBAAkB,CAAC/I,GAAG,CAACjI,CAAC,EAAE,MAAKgR,kBAAkB,CAAC/I,GAAG,CAAChI,CAAC,CAAC,GAAG,MAAK8O,OAAO,CAAC9F,cAAc,EACrK;QACAiI,aAAa,GAAG,KAAK;MACvB;MAEA,MAAKI,eAAe,GAAG,MAAKN,kBAAkB,CAAC/I,GAAG;MAClD,MAAKsJ,eAAe,GAAG;QAAEvR,CAAC,EAAE,MAAK+L,gBAAgB,CAACwE,UAAU;QAAEtQ,CAAC,EAAE,MAAK8L,gBAAgB,CAACyD;MAAU,CAAa;MAC9G,MAAKgC,aAAa,GAAG,IAAI;MACzB,IAAIC,YAA0C,GAAG,IAAI;MACrD,IAAI,MAAK3D,gBAAgB,KAAK3F,yCAAyC,IAAI,MAAK2F,gBAAgB,KAAK3F,4BAA4B,EAAE;QACjI;QACAsJ,YAAY,GAAG,CAACtK,4BAA4B,CAAC;MAC/C;MACA,IAAMwK,WAAW,GAAG,MAAKC,wBAAwB,CAAC,MAAKZ,kBAAkB,CAAC;MAC1E,IAAMa,QAAQ,GAAG,MAAKC,gBAAgB,CAAC,MAAKd,kBAAkB,CAAC/I,GAAG,EAAE0J,WAAW,EAAEF,YAAY,CAAC;MAE9F,IAAMM,MAAM,GAAG,MAAKC,qBAAqB,CAACH,QAAQ,EAAE,MAAKb,kBAAkB,CAACzR,GAAG,CAAC;MAChF;MACA,IAAMb,KAAK,GAAG,IAAIqJ,kBAAkB,EAAE;MACtCrJ,KAAK,CAACsJ,KAAK,GAAG,MAAKgJ,kBAAkB;MACrCtS,KAAK,CAACC,IAAI,GAAGA,IAAI;MACjB;MACAD,KAAK,CAACmT,QAAQ,GAAGA,QAAQ;MACzB;MACAnT,KAAK,CAACqT,MAAM,GAAGA,MAAM;MAErB,IAAIb,aAAa,EAAE;QACjB,6IAAW1I,0BAA0B,EAAE9J,KAAK;QAC5C;MACF;MAEA,gJAAW8J,wBAAwB,EAAE9J,KAAK;MAE1C,MAAKyT,aAAa,GAAGhB,IAAI,CAACC,GAAG,EAAE;MAC/B,MAAKC,cAAc,GAAGF,IAAI,CAACC,GAAG,EAAE;MAChC,IAAI1S,KAAK,CAAC0T,WAAW,EAAE,EAAE;QACvB;QACA,MAAKvE,iBAAiB,EAAE;QACxB;MACF;MAEA,MAAKwE,WAAW,GAAG,MAAKrB,kBAAkB;;MAE1C;MACA,IAAIe,MAAM,IAAI,MAAKjE,gBAAgB,KAAK3F,4BAA4B,EAAE;QACpE,MAAKmK,KAAK,GAAG,IAAIlL,qBAAqB,EAAE;QACxC,MAAKkL,KAAK,CAAC/S,GAAG,GAAGwS,MAAM,CAACxS,GAAG;QAC3B,MAAK+S,KAAK,CAACC,IAAI,GAAGR,MAAM,CAACQ,IAAI;QAC7B,MAAKD,KAAK,CAACP,MAAM,GAAG,MAAKS,oBAAoB,CAACT,MAAM,EAAEA,MAAM,CAACxS,GAAG,CAAC;QAEjE,IAAIwS,MAAM,CAACQ,IAAI,KAAKpL,4BAA4B,EAAE;UAAA;UAChD,MAAKuL,cAAc,GAAG,KAAK;UAC3B,MAAKC,oBAAoB,GAAG,MAAKzE,kBAAkB,CAACvP,IAAI,CAAC;UACzD,MAAKiU,wBAAwB,GAAGjU,IAAI,CAACkU,QAAQ;UAC7C;UACA,IAAId,MAAM,aAANA,MAAM,eAANA,MAAM,CAAE1L,QAAQ,IAAI,EAAC0L,MAAM,aAANA,MAAM,mCAANA,MAAM,CAAE1L,QAAQ,6CAAhB,iBAAkByM,QAAQ,KAAI,CAAC,MAAK5E,kBAAkB,CAACvP,IAAI,CAAC,EAAE;YACrF,MAAKkS,eAAe,CAACkB,MAAM,CAAC1L,QAAQ,CAAC;UACvC;UACA;UACA,MAAKiM,KAAK,CAACT,QAAQ,GAAG,MAAKkB,mBAAmB,EAAE,CAACC,GAAG,CAAC,UAACpT,OAAO,EAAK;YAChE,OAAO,MAAK4S,oBAAoB,CAAC5S,OAAO,EAAEA,OAAO,CAACL,GAAG,CAAC;UACxD,CAAC,CAAC;QACJ,CAAC,MAAM,IAAIwS,MAAM,CAACQ,IAAI,KAAKpL,yBAAyB,EAAE;UACpD,IAAM+L,SAAS,GAAGnB,MAAM,CAACmB,SAAS;UAClC,MAAKP,oBAAoB,GAAG,MAAKzE,kBAAkB,CAACvP,IAAI,CAAC;UACzD,MAAK+T,cAAc,GAAG,IAAI;UAC1B;UACA,IAAIQ,SAAS,IAAI,CAAC,MAAKhF,kBAAkB,CAACvP,IAAI,CAAC,EAAE;YAC/C,MAAKkS,eAAe,CAACqC,SAAS,CAAC;UACjC;UACA,IAAIA,SAAS,IAAIC,KAAK,CAACC,OAAO,CAACF,SAAS,CAAC,EAAE;YACzC,MAAKZ,KAAK,CAACT,QAAQ,GAAGqB,SAAS,CAACF,GAAG,CAAC,UAAC3M,QAAQ,EAAK;cAAA;cAChD,OAAO,MAAKmM,oBAAoB,CAAC,MAAKa,yBAAyB,CAAC,sBAAKf,KAAK,gDAAV,YAAYP,MAAM,CAAClL,GAAG,KAAI,IAAI,EAAER,QAAQ,CAAC,EAAEA,QAAQ,CAAC9G,GAAG,CAAC;YAC1H,CAAC,CAAC;UACJ;QACF,CAAC,MAAM;UACL,MAAK+S,KAAK,CAACT,QAAQ,GAAG,CAAC,MAAKS,KAAK,CAACP,MAAM,CAAC;QAC3C;MACF;MAEA,MAAKpG,MAAM,EAAE;IACf,CAAC;IAAA,uFACsB,UAAC/L,OAAmD,EAAEL,GAAW,EAA+B;MACrH,IAAM+T,KAAK,GAAG1T,OAAmC;MACjD0T,KAAK,CAACC,OAAO,GAAGD,KAAK,CAAC/T,GAAG;MACzB,IAAI+T,KAAK,CAACE,UAAU,KAAKhR,SAAS,IAAI8Q,KAAK,CAACE,UAAU,KAAK,IAAI,EAAE;QAC/DF,KAAK,CAACE,UAAU,GAAGjU,GAAG;MACxB;MACA,IAAI+T,KAAK,CAACC,OAAO,KAAK/Q,SAAS,IAAI8Q,KAAK,CAACC,OAAO,KAAK,IAAI,EAAE;QACzDD,KAAK,CAACC,OAAO,GAAGhU,GAAG;MACrB;MACA+T,KAAK,CAAC/T,GAAG,GAAGA,GAAG;MACf,OAAO+T,KAAK;IACd,CAAC;IAAA,sFAIqB,UAAC3U,IAAmC,EAAc;MACtE,OAAO,CAAC,CAACA,IAAI,IAAIA,IAAI,CAAC8U,OAAO,IAAI,CAAC;IACpC,CAAC;IAAA,wFAKuB,UAAC9U,IAAoC,EAAW;MACtE,IAAI,CAACA,IAAI,EAAE;QACTA,IAAI,GAAG,MAAK+U,aAAa;MAC3B,CAAC,MAAM;QACL,MAAKA,aAAa,GAAG/U,IAAI;MAC3B;MACA,IAAI,CAACA,IAAI,IAAI,CAAC,MAAKuN,OAAO,EAAE;QAC1B;MACF;MACA,IAAMyH,cAAc,GAAGhV,IAAkB;MACzC,IAAMiV,OAAO,GAAGD,cAAc,CAACE,cAAc,IAAIF,cAAc,CAACE,cAAc,CAACrV,MAAM,GAAG,CAAC;MACzF,MAAK6T,WAAW,GAAG,MAAKpB,cAAc,CAAC,MAAK/E,OAAO,EAAEvN,IAAI,CAAC;MAC1D,IAAI,CAAC,MAAKiQ,aAAa,IAAI,MAAKkF,cAAc,IAAI,MAAKC,mBAAmB,EAAE,EAAE;QAC5E;QACA,IAAI,MAAKjG,gBAAgB,KAAK3F,4BAA4B,IAAI,MAAK2F,gBAAgB,KAAK3F,4BAA4B,IAAI,MAAK2F,gBAAgB,KAAK3F,yCAAyC,EAAE;UAC3L,MAAK6L,qBAAqB,GAAG,KAAK;QACpC,CAAC,MAAM;UACL,MAAKA,qBAAqB,GAAG,IAAI;QACnC;MACF,CAAC,MAAM;QACL,MAAKA,qBAAqB,GAAG,KAAK;MACpC;MAEArV,IAAI,GAAGA,IAAkB;MACzB,IAAMsV,aAAa,GAAG,MAAKC,mBAAmB,CAACvV,IAAI,CAAC;MACpD,IAAI,CAACsV,aAAa,EAAE;QAClB,MAAKzF,6BAA6B,GAAG,KAAK;MAC5C;MACA;MACA,IAAI,MAAKwC,kBAAkB,EAAE;QAC3B;QACA,IAAIiD,aAAa,IAAIL,OAAO,EAAE;UAC5B,IAAI,MAAKtB,KAAK,IAAI,CAAC,MAAKK,oBAAoB,EAAE;YAC5C,IAAMwB,YAAY,GAAG,MAAK9B,WAAW,CAAC9S,GAAG;YACzC,IAAI,MAAK+S,KAAK,CAACC,IAAI,KAAKpL,4BAA4B,EAAE;cACpD,MAAKiN,gBAAgB,CAACD,YAAY,EAAE1M,wBAAwB,CAAC;YAC/D,CAAC,MAAM,IAAI,CAAC,MAAK6K,KAAK,CAACC,IAAI,IAAIpL,4BAA4B,IAAI,MAAKmL,KAAK,CAACC,IAAI,IAAIpL,yBAAyB,KAAK,MAAKmL,KAAK,CAACT,QAAQ,EAAE;cACnI,IAAMwC,MAAM,GAAGvT,IAAI,CAACyC,KAAK,CAAC4Q,YAAY,GAAG,MAAK7B,KAAK,CAAC/S,GAAG,CAAC;cACxD,IAAM+U,WAAW,GAAG,MAAKC,aAAa,CAACF,MAAM,EAAE,MAAK/B,KAAK,CAACT,QAAQ,EAAEpK,wBAAwB,CAAC;cAC7F,IAAI6M,WAAW,KAAK,CAAC,EAAE;gBACrB,IAAI,CAAC,MAAKhC,KAAK,CAACkC,OAAO,EAAE;kBACvB,MAAKlC,KAAK,CAACiB,OAAO,GAAG,MAAKjB,KAAK,CAAC/S,GAAG;kBACnC,IAAMkV,UAAS,GAAG,MAAKC,qBAAqB,CAAC,MAAKpC,KAAK,CAAC;kBACxD,IAAI,CAACmC,UAAS,IAAIA,UAAS,CAACrC,WAAW,EAAE,EAAE;oBACzC;oBACA,MAAKvE,iBAAiB,CAAC,IAAI,CAAC;oBAC5B,MAAKyE,KAAK,GAAG,IAAI;oBACjB;kBACF;gBACF;gBAEA,MAAKA,KAAK,CAACkC,OAAO,GAAG,IAAI;gBACzB,MAAKlC,KAAK,CAAC/S,GAAG,IAAI8U,MAAM;gBACxB,MAAKM,cAAc,CAAC,MAAKrC,KAAK,CAAC;cACjC;YACF;UACF;UAEA,IAAI,CAAC,MAAKxE,gBAAgB,KAAK3F,2BAA2B,IAAI,MAAK2F,gBAAgB,KAAK3F,yCAAyC,KAAK,CAAC,MAAKmK,KAAK,EAAE;YACjJ,MAAK1D,aAAa,GAAG,IAAI;YACzB,MAAKT,UAAU,CAAC/F,2BAA2B,CAAC;YAC5C;YACA,MAAK0M,YAAY,CAAC,MAAK9D,kBAAkB,CAAC/I,GAAG,EAAE,MAAKoK,WAAW,CAACpK,GAAG,EAAE,MAAKsJ,eAAe,CAAC;UAC5F,CAAC,MAAM;YACL,IAAI,MAAKzD,gBAAgB,KAAK3F,4BAA4B,EAAE;cAC1D;cACA,MAAK4M,6BAA6B,CAAC,MAAK1C,WAAW,CAACpK,GAAG,CAAC;YAC1D;UACF;UAEA,MAAK0D,MAAM,EAAE;QACf,CAAC,MAAM;UACL;UACA,MAAKkC,iBAAiB,CAAC,IAAI,CAAC;UAC5B,MAAKlC,MAAM,EAAE;QACf;MACF,CAAC,MAAM,IAAI,CAACiI,OAAO,EAAE;QACnB;QACA,IAAInC,YAA0C,GAAG,IAAI;QACrD,IAAI,MAAK3D,gBAAgB,KAAK3F,yCAAyC,IAAI,MAAK2F,gBAAgB,KAAK3F,4BAA4B,EAAE;UACjI;UACAsJ,YAAY,GAAG,CAACtK,4BAA4B,CAAC;QAC/C;QACA,IAAMwK,WAAW,GAAG,MAAKC,wBAAwB,CAAC,MAAKS,WAAW,CAAC;QACnE,IAAMR,QAAQ,GAAG,MAAKC,gBAAgB,CAAC,MAAKO,WAAW,CAACpK,GAAG,EAAE0J,WAAW,EAAEF,YAAY,CAAC;QACvF,IAAMM,MAAM,GAAG,MAAKC,qBAAqB,CAACH,QAAQ,EAAE,MAAKQ,WAAW,CAAC9S,GAAG,CAAC;QACzE,IAAI,MAAKqP,aAAa,IAAI,MAAKd,gBAAgB,KAAK3F,2BAA2B,IAAI,MAAK2F,gBAAgB,KAAK3F,yCAAyC,EAAE;UACtJ,IAAI8L,aAAa,EAAE;YACjB,MAAK9F,UAAU,CAAC/F,2BAA2B,CAAC;UAC9C,CAAC,MAAM;YACL,MAAK+F,UAAU,CAAC/F,uBAAuB,CAAC;UAC1C;QACF,CAAC,MAAM;UACL,IAAI,MAAK0F,gBAAgB,KAAK3F,4BAA4B,EAAE;YAC1D,MAAK6F,cAAc,CAACrP,IAAI,CAAC;YACzB;UACF,CAAC,MAAM;YACL,MAAKwP,UAAU,CAAC/F,0BAA0B,CAAC;UAC7C;QACF;QAEA,IAAI2J,MAAM,EAAE;UACV,IAAItI,MAAiC,GAAG,IAAI;UAC5C,IAAIsI,MAAM,CAACQ,IAAI,KAAKpL,yBAAyB,EAAE;YAC7CsC,MAAM,GAAGA,MAAM,IAAIrB,2BAA2B;UAChD,CAAC,MAAM,IAAI2J,MAAM,CAACQ,IAAI,IAAIpL,4BAA4B,EAAE;YACtDsC,MAAM,GAAGA,MAAM,IAAIrB,0BAA0B;UAC/C,CAAC,MAAM,IAAI2J,MAAM,CAACQ,IAAI,IAAIpL,4BAA4B,EAAE;YAAA;YACtDsC,MAAM,GAAGA,MAAM,wBAAI,MAAK8B,QAAQ,6EAAb,gBAAezB,aAAa,0DAA5B,sBAA8BL,MAAM,KAAI,IAAI;UACjE;UAEA,IAAIA,MAAM,EAAE;YACV,MAAK0E,UAAU,CAAC1E,MAAM,CAAC;UACzB;QACF;MACF;MAEA,IAAImK,OAAO,EAAE;QACXjV,IAAI,CAACuQ,cAAc,EAAE;MACvB;IACF,CAAC;IAAA,sFA8DqB,UAACvQ,IAA6B,EAAW;MAC7D,MAAK6P,6BAA6B,GAAG,KAAK;MAC1C,IAAI,CAAC,MAAKtC,OAAO,EAAE;QACjB;MACF;MACA,IAAI,MAAK8E,kBAAkB,EAAE;QAC3B;QACA,IAAM/I,GAAG,GAAG,MAAKgJ,cAAc,CAAC,MAAK/E,OAAO,EAAEvN,IAAI,CAAC;;QAEnD;QACA,IAAI,MAAK6S,aAAa,IAAI,CAAC,MAAKuC,mBAAmB,EAAE,IAAK,MAAKzB,KAAK,KAAK,MAAKK,oBAAoB,IAAI,MAAKC,wBAAwB,CAAE,EAAE;UACrI,IAAI,MAAKrH,QAAQ,IAAI,MAAKuC,gBAAgB,KAAK3F,4BAA4B,EAAE;YAC3E,IAAMsH,SAAS,GAAG,MAAKvB,kBAAkB,CAACvP,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YACxD,IAAMwW,SAAS,GAAG,MAAK/F,YAAY,CAAC,MAAKlD,OAAO,EAAEvN,IAAI,CAAC;YACvD,IAAM0Q,QAAQ,GAAGvO,IAAI,CAACK,GAAG,CAAC,CAAC,EAAEgU,SAAS,CAAClN,GAAG,CAACjI,CAAC,IAAI,CAAC,CAAC;YAClD,MAAKsP,KAAK,CAACG,SAAS,EAAE,MAAKlE,QAAQ,CAACb,SAAS,IAAI,CAAC,EAAE2E,QAAQ,CAAC;UAC/D,CAAC,MAAM;YACL,MAAK+F,aAAa,CAACnN,GAAG,EAAE,MAAKqK,KAAK,CAAC;UACrC;QACF,CAAC,MAAM,IAAI,CAAC,MAAKA,KAAK,IAAI,MAAKwB,cAAc,IAAI,MAAKE,qBAAqB,EAAE;UAC3E,IAAI,MAAKlG,gBAAgB,KAAK3F,4BAA4B,EAAE;YAC1D;UAAA,CACD,MAAM,IAAI,MAAK2F,gBAAgB,KAAK3F,4BAA4B,EAAE;YACjE,IAAM+K,SAAS,GAAG,MAAKmC,wBAAwB,CAAC,MAAKvB,cAAc,CAAC;YACpE,IAAMwB,aAAa,GAAG3W,IAAI,CAACkU,QAAQ,GAAGvK,4BAA4B,GAAGA,4BAA4B;YACjG,MAAKmN,MAAM,CAACvC,SAAS,EAAEoC,aAAa,CAAC;UACvC;QACF;QAEA,MAAKzH,iBAAiB,EAAE;QACxB,MAAKlC,MAAM,EAAE;MACf;IACF,CAAC;IAAA,sFAKqB,YAAc;MAClC,IAAI,MAAKO,OAAO,EAAE;QAChB,OAAO,MAAKA,OAAO,CAACwJ,YAAY;MAClC;MACA,OAAO,CAAC;IACV,CAAC;IAAA,qFAKoB,YAAc;MACjC,IAAI,MAAKxJ,OAAO,EAAE;QAChB,OAAO,MAAKA,OAAO,CAACO,WAAW;MACjC;MACA,OAAO,CAAC;IACV,CAAC;IAAA,2FAM0B,UAACkJ,UAAmB,EAAyB;MACtE,IAAMC,eAAwC,GAAG,EAAE;MACnD,MAAKC,gBAAgB,CAAC,UAACC,iBAAiB,EAAK;QAC3C,IAAMC,UAAU,GACdD,iBAAiB,CAAChR,KAAK,KAAKjG,0BAA0B,GAClDE,8BAA8B,CAAC+W,iBAAiB,CAACG,IAAI,EAAEN,UAAU,CAAC,GAClE5W,uBAAuB,CAAC+W,iBAAiB,CAACG,IAAI,CAACjW,CAAC,EAAE8V,iBAAiB,CAACG,IAAI,CAAChW,CAAC,EAAE0V,UAAU,CAAC;QAE7F,IAAII,UAAU,EAAE;UACdH,eAAe,CAACtX,IAAI,CAACwX,iBAAiB,CAAC5K,KAAK,CAAC;QAC/C;MACF,CAAC,CAAC;MACF,OAAO0K,eAAe;IACxB,CAAC;IAAA,gFAMe,UAAC3N,GAAsB,EAAEkO,IAAkC,EAAc;MACvF,IAAIC,SAAS,GAAG,KAAK;MACrB,IAAID,IAAI,KAAKA,IAAI,CAAC5D,IAAI,KAAKpL,4BAA4B,IAAIgP,IAAI,CAAC5D,IAAI,KAAKpL,yBAAyB,CAAC,EAAE;QAAA;QACnG,IAAIkP,IAAI,GAAG/N,4BAA4B;QACvC,IAAI,MAAKoK,cAAc,EAAE;UACvB2D,IAAI,GAAG/N,4BAA4B;QACrC;QACA,IAAI,MAAKqK,oBAAoB,IAAI,MAAKzE,kBAAkB,CAACjG,GAAG,CAACtJ,IAAI,CAAC,EAAE;UAClE,IAAI,MAAKuP,kBAAkB,CAACjG,GAAG,CAACtJ,IAAI,CAAC,EAAE;YACrC0X,IAAI,GAAG/N,4BAA4B;UACrC;QACF,CAAC,MAAM,IAAI,MAAKsK,wBAAwB,IAAI3K,GAAG,CAACtJ,IAAI,CAACkU,QAAQ,EAAE;UAC7DwD,IAAI,GAAG/N,4BAA4B;QACrC;QACA;QACA,IAAM4K,SAAS,GAAG,MAAKR,cAAc,GAAGyD,IAAI,CAACpE,MAAM,CAACmB,SAAS,GAAGiD,IAAI,CAACpE,MAAM,CAAC1L,QAAQ;QACpF,IAAI6M,SAAS,IAAI,MAAKhF,kBAAkB,CAACjG,GAAG,CAACtJ,IAAI,CAAC,EAAE;UAClDyX,SAAS,GAAG,MAAKvF,eAAe,CAACqC,SAAS,IAAI,IAAI,EAAEmD,IAAI,CAAC,CAACE,gBAAgB,IAAIH,SAAS;QACzF;QAGA,IAAInO,GAAG,CAACtJ,IAAI,CAACkU,QAAQ,IAAI,0BAAKtH,QAAQ,oDAAb,gBAAeR,iBAAiB,MAAK,KAAK,EAAE;UACnE;UACAqL,SAAS,GAAG,MAAKhC,gBAAgB,CAACnM,GAAG,CAAC1I,GAAG,EAAEkI,wBAAwB,CAAC,IAAI2O,SAAS;QACnF;MACF,CAAC,MAAM;QAAA;QACL;;QAEA,IAAInO,GAAG,CAACtJ,IAAI,YAAY6X,UAAU,IAAIvO,GAAG,CAACtJ,IAAI,CAAC8X,MAAM,IAAI,CAAC,EAAE;UAC1DL,SAAS,GAAG,MAAKvF,eAAe,CAAC,IAAI,CAAC,CAAC0F,gBAAgB,IAAIH,SAAS;QACtE;QAEA,IAAI,0BAAK7K,QAAQ,oDAAb,gBAAeR,iBAAiB,MAAK,KAAK,EAAE;UAC9C;UACA;UACAqL,SAAS,GAAG,MAAKhC,gBAAgB,CAACnM,GAAG,CAAC1I,GAAG,EAAEkI,wBAAwB,CAAC,IAAI2O,SAAS;QACnF;MACF;MAEA,OAAOA,SAAS;IAClB,CAAC;IAAA,kFAOiB,UAACxW,OAAiC,EAAEqB,KAAa,EAAiF;MAAA,IAA/EyV,MAA2B,uEAAGjP,oCAAoC;MACrI,IAAI,CAAC7H,OAAO,IAAI,CAACA,OAAO,CAACyG,QAAQ,EAAE;QACjC,OAAOpF,KAAK;MACd;MACAA,KAAK,GAAGH,IAAI,CAACyC,KAAK,CAACtC,KAAK,CAAC;MACzB,IAAIrB,OAAO,CAACyG,QAAQ,IAAIzG,OAAO,CAACyG,QAAQ,CAAC9G,GAAG,IAAI0B,KAAK,EAAE;QACrDrB,OAAO,CAAC2T,OAAO,GAAG3T,OAAO,CAACL,GAAG;QAC7BK,OAAO,CAACL,GAAG,GAAG0B,KAAK;QACnBrB,OAAO,CAACyG,QAAQ,CAAC9G,GAAG,GAAG0B,KAAK;QAC5B,IAAMvC,KAAK,GAAG,MAAKkY,oBAAoB,CAAChX,OAAO,EAAE8W,MAAM,CAAC;QACxD,IAAIhY,KAAK,CAAC0T,WAAW,EAAE,EAAE;UACvBxS,OAAO,CAACL,GAAG,GAAGb,KAAK,CAAC6U,OAAO;UAC3B3T,OAAO,CAACyG,QAAQ,CAAC9G,GAAG,GAAGb,KAAK,CAAC6U,OAAO;QACtC;QAEA,OAAOtS,KAAK;MACd;MAEA,OAAOA,KAAK;IACd,CAAC;IAAA,6EAKY,UAACwI,MAAc,EAAW;MACrC,IAAI,MAAKyC,OAAO,IAAI,MAAKA,OAAO,CAACvG,KAAK,CAAC8D,MAAM,IAAIA,MAAM,EAAE;QACvD,MAAKyC,OAAO,CAACvG,KAAK,CAAC8D,MAAM,GAAGA,MAAM;MACpC;IACF,CAAC;IAAA,qFAK2B,UAAC4M,IAA6B,EAAW;MACnE,IAAI,MAAKvI,gBAAgB,IAAIuI,IAAI,EAAE;QACjC,MAAKvI,gBAAgB,GAAGuI,IAAI;QAC5B;QACA,MAAKxI,iBAAiB,CAAC,IAAI,CAAC;QAC5B,MAAKlC,MAAM,EAAE;MACf;IACF,CAAC;IAAA,qFAI2B,YAA+B;MACzD,OAAO,MAAKmC,gBAAgB;IAC9B,CAAC;IAAA,4FAK2B,UAAC+I,QAA4B,EAAExQ,QAA0B,EAAsB;MACzG,IAAMyQ,IAAI,GAAG;QACXvE,IAAI,EAAEpL,4BAA4B;QAClC5H,GAAG,EAAE8G,QAAQ,CAAC9G,GAAG;QACjB8G,QAAQ,EAAEA,QAAQ;QAClBQ,GAAG,EAAEgQ;MACP,CAAoB;MACpB,OAAOC,IAAI;IACb,CAAC;IAAA,uFAE6B,YAA0B;MACtD,IAAMhE,QAAQ,GAAG,MAAKC,mBAAmB,EAAE;MAC3C,OAAOD,QAAQ,CAACE,GAAG,CAAC,UAACrQ,CAAC;QAAA,OAAKA,CAAC,CAAC0D,QAAQ;MAAA,EAAC;IACxC,CAAC;IAAA,sFAK4B,YAAyB;MACpD,IAAMyM,QAA2B,GAAG,EAAE;MACtC,MAAK+C,gBAAgB,CAAC,UAACxP,QAAQ,EAAW;QACxC,IAAIA,QAAQ,IAAIA,QAAQ,CAAC6E,KAAK,CAAC4H,QAAQ,EAAE;UACvCA,QAAQ,CAACxU,IAAI,CAAC,MAAK+U,yBAAyB,CAAChN,QAAQ,CAAC0Q,YAAY,CAAC7L,KAAK,EAAE7E,QAAQ,CAAC6E,KAAK,CAAC,CAAC;QAC5F;QACA;MACF,CAAC,CAAC;MAEF,OAAO4H,QAAQ;IACjB,CAAC;IAAA,kFAIwB,YAA0B;MACjD,IAAMI,SAA6B,GAAG,EAAE;MACxC,MAAK2C,gBAAgB,CAAC,UAACxP,QAAQ,EAAW;QACxC6M,SAAS,CAAC5U,IAAI,CAAC+H,QAAQ,CAAC6E,KAAK,CAAC;MAChC,CAAC,CAAC;MAEF,OAAOgI,SAAS;IAClB,CAAC;IAAA,qFAE2B,YAAgC;MAC1D,OAAO,MAAKuC,MAAM,CAAC,MAAKuB,eAAe,EAAE,EAAE1O,4BAA4B,CAAC;IAC1E,CAAC;IAAA,8EACoB,YAAgC;MACnD,OAAO,MAAKmN,MAAM,CAAC,IAAI,CAAC;IAC1B,CAAC;IAAA,mFAE0B,UAACnC,KAA+B,EAAE2D,IAAsB,EAAEhW,KAAc,EAAc;MAC/G,IAAIgW,IAAI,CAACnE,QAAQ,KAAK7R,KAAK,EAAE;QAC3B,IAAMiW,UAAU,GAAG,OAAOD,IAAI,CAACC,UAAU,KAAK,SAAS,GAAGD,IAAI,CAACC,UAAU,GAAG,IAAI;QAChF,IAAI,CAACjW,KAAK,IAAKA,KAAK,IAAIiW,UAAW,EAAE;UACnCD,IAAI,CAACnE,QAAQ,GAAG7R,KAAK;UACrBqS,KAAK,CAACkB,OAAO,CAAClW,IAAI,CAAC2Y,IAAI,CAAC;UACxB,OAAO,IAAI;QACb;MACF;MAEA,OAAO,KAAK;IACd,CAAC;IAAA,yEAEe,UAACE,KAAmD,EAAoE;MAAA,IAAlEd,IAAI,uEAAG/N,4BAA4B;MACvG,IAAM8O,OAAO,GAAG,MAAKvG,eAAe,CAACsG,KAAK,EAAEd,IAAI,CAAC;MACjD,IAAIe,OAAO,CAACb,gBAAgB,EAAE;QAC5B,MAAK5K,MAAM,EAAE;MACf;MACA,OAAOyL,OAAO;IAChB,CAAC;IAAA,kFAOwB,UAACD,KAAmD,EAA2G;MAAA,IAAzGd,IAAI,uEAAG/N,4BAA4B;MAAA,IAAEiK,IAAI,uEAAGhK,8BAA8B;MACvJ,IAAI,CAAC4O,KAAK,EAAE;QACVA,KAAK,GAAG,EAAE;MACZ;MACA,IAAI,CAAChE,KAAK,CAACC,OAAO,CAAC+D,KAAK,CAAC,EAAE;QACzBA,KAAK,GAAG,CAACA,KAAK,CAAC;MACjB;MAEA,IAAM7D,KAAK,GAAG;QACZiD,gBAAgB,EAAE,KAAK;QACvBzD,QAAQ,EAAE,MAAKuE,oBAAoB,EAAE;QACrC7C,OAAO,EAAE;MACX,CAA6B;MAC7B,IAAM8C,UAAU,GAAGH,KAA2B;MAC9C;MACA,IAAIG,UAAU,IAAIjB,IAAI,KAAK/N,4BAA4B,EAAE;QACvD6O,KAAK,CAACvY,OAAO,CAAC,UAACqY,IAAI,EAAK;UACtB,IAAMzC,OAAO,GAAG,MAAK+C,gBAAgB,CAACjE,KAAK,EAAE2D,IAAI,EAAE,IAAI,CAAC;UACxD,IAAIzC,OAAO,IAAIyC,IAAI,CAACnE,QAAQ,EAAE;YAC5BQ,KAAK,CAACR,QAAQ,CAACxU,IAAI,CAAC2Y,IAAI,CAAC;UAC3B;QACF,CAAC,CAAC;MACJ,CAAC,MAAM,IAAIK,UAAU,IAAIjB,IAAI,KAAK/N,4BAA4B,EAAE;QAC9D6O,KAAK,CAACvY,OAAO,CAAC,UAACqY,IAAI,EAAK;UACtB,IAAI3D,KAAK,CAACR,QAAQ,CAAChT,OAAO,CAACmX,IAAI,CAAC,IAAI,CAAC,EAAE;YACrC,MAAKM,gBAAgB,CAACjE,KAAK,EAAE2D,IAAI,EAAE,KAAK,CAAC;YACzClY,2BAA2B,CAAmBuU,KAAK,CAACR,QAAQ,EAAEmE,IAAI,CAAC;UACrE,CAAC,MAAM;YACL,MAAKM,gBAAgB,CAACjE,KAAK,EAAE2D,IAAI,EAAE,IAAI,CAAC;YACxC,IAAIA,IAAI,CAACnE,QAAQ,EAAE;cACjBQ,KAAK,CAACR,QAAQ,CAACxU,IAAI,CAAC2Y,IAAI,CAAC;YAC3B;UACF;QACF,CAAC,CAAC;MACJ,CAAC,MAAM,IAAIZ,IAAI,KAAK/N,4BAA4B,EAAE;QAChD,IAAMmP,aAAsC,GAAG,EAAE;QACjD,IAAIN,KAAK,EAAE;UACTA,KAAK,CAACvY,OAAO,CAAC,UAACqY,IAAI,EAAK;YACtB,MAAKM,gBAAgB,CAACjE,KAAK,EAAE2D,IAAI,EAAE,IAAI,CAAC;YACxC,IAAIA,IAAI,CAACnE,QAAQ,EAAE;cACjB2E,aAAa,CAACnZ,IAAI,CAAC2Y,IAAI,CAAC;YAC1B;UACF,CAAC,CAAC;QACJ;QAEA3D,KAAK,CAACR,QAAQ,CAAClU,OAAO,CAAC,UAACqY,IAAI,EAAK;UAC/B,IAAMS,MAAM,GAAGJ,UAAU,CAACxX,OAAO,CAACmX,IAAI,CAAC,IAAI,CAAC;UAC5C;UACA,IAAI,CAACS,MAAM,EAAE;YACX,MAAKH,gBAAgB,CAACjE,KAAK,EAAE2D,IAAI,EAAE,KAAK,CAAC;UAC3C;QACF,CAAC,CAAC;QAEF,IAAI3D,KAAK,CAACkB,OAAO,CAAChW,MAAM,GAAG,CAAC,EAAE;UAC5B,IAAIiZ,aAAa,EAAE;YACjBnE,KAAK,CAACR,QAAQ,GAAG2E,aAAa;UAChC,CAAC,MAAM;YACLnE,KAAK,CAACR,QAAQ,CAACtU,MAAM,GAAG,CAAC;UAC3B;QACF;MACF;MAEA,IAAI8U,KAAK,CAACkB,OAAO,CAAChW,MAAM,GAAG,CAAC,EAAE;QAC5B8U,KAAK,CAACiD,gBAAgB,GAAG,IAAI;QAE7B,MAAKoB,sBAAsB,CAACrE,KAAK,CAAC;MAEpC;MAEA,OAAOA,KAAK;IACd,CAAC;IAAA,gFAiHe,YAAY;MAC1B,IAAI,MAAKvE,OAAO,CAACpG,YAAY,EAAE;QAC7B,IAAI,CAAC,MAAKiP,YAAY,EAAE;UACtB;UACA,MAAKA,YAAY,GAAGhV,MAAM,CAACiV,WAAW,CAAC,YAAM;YAC3C,MAAKvK,qBAAqB,CAAC,IAAI,CAAC;UAClC,CAAC,EAAE,MAAKyB,OAAO,CAACpG,YAAY,CAAC;QAC/B;MACF;IACF,CAAC;IAAA,+EAKc,YAAY;MACzB,IAAI,MAAKiP,YAAY,EAAE;QACrBE,aAAa,CAAC,MAAKF,YAAY,CAAC;QAChC,MAAKA,YAAY,GAAG,IAAI;MAC1B;MAEA,MAAKG,sBAAsB,GAAG,CAAC;IACjC,CAAC;IAAA,8EAmIa,UAACxY,GAAW,EAAa;MACrC,OAAO,MAAK2Q,OAAO,CAAC3Q,GAAG,CAAC,GAAG,MAAKgR,UAAU,GAAG,MAAKyH,WAAW,EAAE;IACjE,CAAC;IAAA,8EAIa,UAACC,EAAU,EAAa;MACpC,OAAO,MAAKC,OAAO,CAAC,MAAK3H,UAAU,GAAG0H,EAAE,GAAG,MAAKD,WAAW,EAAE,CAAC;IAChE,CAAC;IAAA,0EAIgB,UAACzY,GAAW,EAAa;MACxC,IAAI,CAAC,MAAKgM,QAAQ,IAAI,CAAC,MAAKA,QAAQ,CAACxB,MAAM,EAAE;QAC3C,OAAOxK,GAAG;MACZ;MACA,IAAI2B,GAAG,GAAG,MAAKqK,QAAQ,CAACrK,GAAG,IAAI,CAAC;MAChC,IAAI,CAACnC,sBAAsB,CAACmC,GAAG,CAAC,EAAE;QAChCA,GAAG,GAAG,CAAC;MACT;MACAA,GAAG,IAAI,MAAK6O,YAAY,IAAI,CAAC;MAC7B,IAAMoI,KAAK,GAAG,CAAC,MAAK5M,QAAQ,CAACvB,OAAO,IAAI,CAAC,IAAI,MAAK+F,YAAY,IAAI,CAAC;MACnE,OAAO,CAAC,CAAC7O,GAAG,GAAG3B,GAAG,KAAK,MAAKgM,QAAQ,CAACxB,MAAM,GAAGoO,KAAK,CAAC;IACtD,CAAC;IAAA,iFAuBgB,UAACnY,CAAS,EAAkC;MAAA,IAAhC6J,WAAW,uEAAG,KAAK;MAC9C,IAAMwF,QAAQ,GAAGvO,IAAI,CAACI,GAAG,CAAClB,CAAC,EAAE,MAAK4P,kBAAkB,EAAE,CAAC;MACvD,IAAIuE,YAAY,GAAG,MAAKrE,WAAW,CAACT,QAAQ,CAAC;MAC7C8E,YAAY,GAAGrT,IAAI,CAACsP,KAAK,CAAC+D,YAAY,CAAC;MACvC,IAAItK,WAAW,EAAE;QACfsK,YAAY,GAAG,MAAKiE,OAAO,CAACjE,YAAY,CAAC;MAC3C;MAEA,OAAOA,YAAY;IACrB,CAAC;IAAA,mFAQkB,UAACkE,EAAU,EAAgC;MAAA,IAA9BC,SAAS,uEAAG,KAAK;MAC/C,IAAMhV,IAAI,GAAGvE,kBAAkB,CAACsZ,EAAE,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,EAAE;MAClDA,EAAE,GAAGvX,IAAI,CAAC4B,GAAG,CAAC2V,EAAE,CAAC;MACjB;MACA,IAAIE,OAAO,GAAGF,EAAE,GAAG,IAAI;MACvB,IAAIC,SAAS,EAAE;QACbC,OAAO,GAAGF,EAAE;MACd;MAEA,IAAMG,IAAI,GAAG1X,IAAI,CAACyC,KAAK,CAACgV,OAAO,IAAI,GAAG,GAAG,KAAK,CAAC,CAAC;MAChDA,OAAO,GAAGA,OAAO,IAAI,GAAG,GAAG,KAAK,CAAC;MAEjC,IAAME,IAAI,GAAG3X,IAAI,CAACyC,KAAK,CAACgV,OAAO,GAAG,KAAK,CAAC;MACxCA,OAAO,GAAGA,OAAO,GAAG,KAAK;;MAEzB;MACA,IAAMG,KAAK,GAAG5X,IAAI,CAACyC,KAAK,CAACgV,OAAO,GAAG,IAAI,CAAC,CAAC,CAAC;MAC1CA,OAAO,GAAGA,OAAO,GAAG,IAAI,CAAC,CAAC;MAC1B;MACA,IAAMI,OAAO,GAAG7X,IAAI,CAACyC,KAAK,CAACgV,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC;MAC1C;MACAA,OAAO,GAAGA,OAAO,GAAG,EAAE;MACtB,IAAIK,GAAG,GAAG,EAAE;MACZ,IAAIJ,IAAI,EAAE;QACRI,GAAG,IAAIJ,IAAI,GAAG,GAAG;MACnB;MAEA,IAAIC,IAAI,EAAE;QACRG,GAAG,IAAIH,IAAI,GAAG,GAAG;MACnB;MAEA,IAAIC,KAAK,EAAE;QACTE,GAAG,IAAIF,KAAK,GAAG,GAAG;MACpB;MAEA,IAAIC,OAAO,EAAE;QACXC,GAAG,IAAID,OAAO,GAAG,GAAG;MACtB;MAEA,IAAI,CAACnZ,KAAK,CAAC+Y,OAAO,CAAC,EAAE;QACnBK,GAAG,IAAIL,OAAO;MAChB;MAEA,OAAOjV,IAAI,GAAGsV,GAAG;IACnB,CAAC;IAAA,8EAIa,YAAc;MAAA;MAC1B,OAAO,0BAAKrN,QAAQ,oDAAb,gBAAepB,UAAU,KAAI,CAAC;IACvC,CAAC;IAAA,+EAKc,YAAY;MACzB,IAAI,CAAC,MAAKuC,IAAI,IAAI,CAAC,MAAKA,IAAI,CAACmM,MAAM,IAAI,MAAKnM,IAAI,CAACmM,MAAM,CAACpM,WAAW,IAAI,CAAC,IAAI,MAAKC,IAAI,CAACmM,MAAM,CAACnD,YAAY,IAAI,CAAC,IAAI,CAAC,MAAKnK,QAAQ,IAAI,CAAC,MAAKA,QAAQ,CAACxB,MAAM,EAAE;QACzJ;MACF;MACA,IAAM+O,WAAW,GAAG,MAAKlJ,kBAAkB,EAAE,GAAG,MAAKoI,WAAW,EAAE;MAClE,IAAI1W,IAAI,GAAG,MAAK4W,OAAO,CAAC,MAAK3H,UAAU,CAAC;MACxC,IAAIlP,EAAE,GAAG,MAAK6W,OAAO,CAAC,MAAK3H,UAAU,GAAGuI,WAAW,CAAC;MACpD,IAAItZ,KAAK,CAAC8B,IAAI,CAAC,IAAI9B,KAAK,CAAC6B,EAAE,CAAC,IAAIC,IAAI,KAAKD,EAAE,EAAE;QAC3C;MACF;MAEA,IAAIA,EAAE,GAAGC,IAAI,EAAE;QACb,IAAMyX,QAAQ,GAAG1X,EAAE;QACnBA,EAAE,GAAGC,IAAI;QACTA,IAAI,GAAGyX,QAAQ;MACjB;MAEA,IAAMC,WAAW,GAAGja,yBAAyB,CAACuC,IAAI,EAAED,EAAE,CAAC;MACvD,IAAI2X,WAAW,IAAI,CAAC,EAAE;QACpB;MACF;;MAEA;MACA;MACA,IAAMzY,IAAI,GAAGxB,0BAA0B,CAACia,WAAW,IAAIF,WAAW,GAAG,MAAKvN,QAAQ,CAACxB,MAAM,CAAC,CAAC;;MAE3F;MACA,IAAMmP,OAAO,GAAGpY,IAAI,CAACyC,KAAK,CAACjC,IAAI,GAAGf,IAAI,CAAC,GAAGA,IAAI;;MAE9C;MACA,IAAM4Y,KAAK,GAAGrY,IAAI,CAACsY,IAAI,CAAC/X,EAAE,GAAGd,IAAI,CAAC,GAAGA,IAAI,GAAGA,IAAI;MAEhD,IAAI,CAACxB,sBAAsB,CAACwB,IAAI,CAAC,IAAIA,IAAI,IAAI,CAAC,IAAIO,IAAI,CAAC4B,GAAG,CAACyW,KAAK,GAAGD,OAAO,CAAC,KAAK,CAAC,EAAE;QACjF;MACF;MACA,IAAIG,SAAS,GAAG,CAAC;MACjB,IAAI,MAAK9N,QAAQ,CAACtB,WAAW,EAAE;QAC7BoP,SAAS,GAAGta,0BAA0B,CAACia,WAAW,IAAIF,WAAW,GAAG,MAAKvN,QAAQ,CAACtB,WAAW,CAAC,CAAC;MACjG;MAEA,IAAIqP,aAAa,GAAG,CAAC;MACrB,MAAK5M,IAAI,CAAC6M,IAAI,EAAE;MAChB,IAAM3S,YAAY,GAAGnB,+BAA+B,CAAC,MAAK8F,QAAQ,CAAC;MACnE,IAAMiO,UAAU,GAAG5S,YAAY,GAAG,CAAC;MACnC,IAAM6S,eAAe,GAAG7S,YAAY,GAAG,GAAG;MAC1C,KAAK,IAAIjG,CAAC,GAAGuY,OAAO,EAAEvY,CAAC,IAAIwY,KAAK,EAAExY,CAAC,IAAIJ,IAAI,EAAE;QAC3C;QACA,IAAMmZ,QAAQ,GAAG,MAAKC,SAAS,CAAC,MAAKC,WAAW,CAACjZ,CAAC,CAAC,CAAC;QACpD,MAAK+L,IAAI,CAAC6M,IAAI,EAAE;QAChB,MAAK7M,IAAI,CAACmN,SAAS,EAAE;QACrB,MAAKnN,IAAI,CAACoN,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;QAC1B,MAAKpN,IAAI,CAACqN,SAAS,GAAG,CAAC;QACvB,IAAI,MAAKxO,QAAQ,CAACjB,SAAS,EAAE;UAC3B,MAAKoC,IAAI,CAACsN,WAAW,GAAG,MAAKzO,QAAQ,CAACjB,SAAS;QACjD;QACAvL,sBAAsB,CAAC,MAAK2N,IAAI,EAAEgN,QAAQ,EAAEF,UAAU,EAAEE,QAAQ,EAAE9S,YAAY,CAAC;QAC/E,MAAK8F,IAAI,CAACwN,MAAM,EAAE;QAClB,IAAI,MAAK3O,QAAQ,CAAClB,WAAW,EAAE;UAC7B,MAAKqC,IAAI,CAACyN,SAAS,GAAG,MAAK5O,QAAQ,CAAClB,WAAW;QACjD;QACA,IAAI,MAAKkB,QAAQ,CAACf,IAAI,EAAE;UACtB,MAAKkC,IAAI,CAAClC,IAAI,GAAG,MAAKe,QAAQ,CAACf,IAAI;QACrC;QAEA,IAAM4P,IAAI,GAAG,MAAKC,gBAAgB,CAAC1Z,CAAC,CAAC;QACrC,IAAM2Z,QAAQ,GAAG,MAAK5N,IAAI,CAAC6N,WAAW,CAACH,IAAI,CAAC;QAE5C,IAAMI,KAAK,GAAGd,QAAQ,GAAGY,QAAQ,CAACna,KAAK,GAAG,CAAC;QAC3C;QACA,IAAIX,KAAK,CAAC8Z,aAAa,CAAC,IAAIA,aAAa,IAAIkB,KAAK,EAAE;UAClDlB,aAAa,GAAGkB,KAAK,GAAGF,QAAQ,CAACna,KAAK;UACtC,MAAKuM,IAAI,CAAC+N,QAAQ,CAACL,IAAI,EAAEI,KAAK,EAAE,EAAE,CAAC;QACrC;QAEA,MAAK9N,IAAI,CAACgO,OAAO,EAAE;QACnB,IAAI,CAAC3b,sBAAsB,CAACsa,SAAS,CAAC,IAAIA,SAAS,IAAI,CAAC,EAAE;UACxD;QACF;QACA;QACA,KAAK,IAAIrZ,CAAC,GAAGW,CAAC,GAAG0Y,SAAS,EAAErZ,CAAC,GAAGW,CAAC,GAAGJ,IAAI,EAAEP,CAAC,IAAIqZ,SAAS,EAAE;UACxD;UACA,IAAMsB,YAAY,GAAG,MAAKhB,SAAS,CAAC,MAAKC,WAAW,CAAC5Z,CAAC,CAAC,CAAC;UACxD,MAAK0M,IAAI,CAACmN,SAAS,EAAE;UACrB,MAAKnN,IAAI,CAACqN,SAAS,GAAG,MAAKa,WAAW;UACtC,IAAI,MAAKrP,QAAQ,CAACjB,SAAS,EAAE;YAC3B,MAAKoC,IAAI,CAACsN,WAAW,GAAG,MAAKzO,QAAQ,CAACjB,SAAS;UACjD;UACAvL,sBAAsB,CAAC,MAAK2N,IAAI,EAAEiO,YAAY,EAAElB,eAAe,EAAEkB,YAAY,EAAE/T,YAAY,CAAC;UAC5F,MAAK8F,IAAI,CAACwN,MAAM,EAAE;QACpB;MACF;MAEA,MAAKxN,IAAI,CAACgO,OAAO,EAAE;IACrB,CAAC;IAAA,qFAOoB,YAAyB;MAC5C,IAAMvU,QAAQ,GAAG;QACf8P,IAAI,EAAE;UACJjW,CAAC,EAAE,CAAC;UACJC,CAAC,EAAE,CAAC;UACJE,KAAK,EAAE,CAAC;UACRC,MAAM,EAAE;QACV,CAAY;QACZc,GAAG,EAAE,IAAI;QACTC,GAAG,EAAE,IAAI;QACT0Z,cAAc,EAAE,EAAE;QAClBC,mBAAmB,EAAE;MACvB,CAAsB;MAEtB,IAAI,CAAC,MAAK1P,MAAM,EAAE;QAChB,OAAOjF,QAAQ;MACjB;MACA,IAAM4U,IAAI,GAAG,MAAK3P,MAAM,CAAC2P,IAAI;MAC7B,IAAI,CAACA,IAAI,IAAI,CAAC5H,KAAK,CAACC,OAAO,CAAC2H,IAAI,CAAC,IAAIA,IAAI,CAACvc,MAAM,IAAI,CAAC,EAAE;QACrD,OAAO2H,QAAQ;MACjB;MACA,IAAI6U,iBAAiB,GAAGvV,+BAA+B,CAAC,MAAK8F,QAAQ,CAAC;MACtEwP,IAAI,CAACnc,OAAO,CAAC,UAACiI,GAAG,EAAEhH,KAAK,EAAK;QAC3B,IAAI,CAACgH,GAAG,IAAIA,GAAG,CAACoU,MAAM,EAAE;UACtB;QACF;;QAEA;QACA,IAAMC,SAAS,GAAGzV,+BAA+B,CAACoB,GAAG,CAAClB,KAAK,IAAI,IAAI,EAAE,MAAK4F,QAAQ,CAAC;QACnF,IAAMlG,YAAY,GAAGI,qCAAqC,CAACoB,GAAG,CAAClB,KAAK,IAAI,IAAI,EAAE,MAAK4F,QAAQ,CAAC;QAC5F,IAAM8P,WAAW,GAAGL,iBAAiB,IAAI,MAAKjP,gBAAgB,GAAG,MAAKA,gBAAgB,CAACyD,SAAS,GAAG,CAAC,CAAC;QACrGwL,iBAAiB,IAAIE,SAAS,GAAG7V,YAAY;QAC7C,IAAIxF,KAAK,IAAI,CAAC,EAAE;UACdsG,QAAQ,CAAC8P,IAAI,CAAChW,CAAC,GAAGob,WAAW;QAC/B;QAEAlV,QAAQ,CAAC8P,IAAI,CAAC7V,MAAM,GAAGU,IAAI,CAACK,GAAG,CAAC6Z,iBAAiB,GAAGE,SAAS,EAAE/U,QAAQ,CAAC8P,IAAI,CAAC7V,MAAM,CAAC;QACpF,IAAMkb,OAAO,GAAG;UAAEtb,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAEob,WAAW;UAAElb,KAAK,EAAE,MAAKyP,kBAAkB,EAAE;UAAExP,MAAM,EAAE8a;QAAU,CAAY;QACxG,IAAMnE,YAAY,GAAG;UACnBd,IAAI,EAAEqF,OAAO;UACbjW,YAAY,EAAEA,YAAY;UAC1B6F,KAAK,EAAErE,GAAG;UACVhH,KAAK,EAAEA,KAAK;UACZqB,GAAG,EAAE,IAAI;UACTC,GAAG,EAAE,IAAI;UACToa,gBAAgB,EAAE,EAAE;UACpBT,mBAAmB,EAAE;QACvB,CAAyB;QACzB3U,QAAQ,CAAC0U,cAAc,CAACvc,IAAI,CAACyY,YAAY,CAAC;QAC1C,IAAI,CAAClQ,GAAG,CAACqM,SAAS,IAAI,CAACrM,GAAG,CAACqM,SAAS,CAACtU,OAAO,IAAIiI,GAAG,CAACqM,SAAS,CAAC1U,MAAM,IAAI,CAAC,EAAE;UACzE;QACF;;QAEA;QACA,IAAIqI,GAAG,IAAIA,GAAG,CAACqM,SAAS,EAAE;UACxBrM,GAAG,CAACqM,SAAS,CAACtU,OAAO,CAAC,UAACyH,QAAQ,EAAK;YAAA;YAClC,IAAI,CAACA,QAAQ,IAAI,CAACtH,sBAAsB,CAACsH,QAAQ,CAAC9G,GAAG,CAAC,EAAE;cACtD6C,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC;cAC/D;YACF;YACA,IAAIgE,QAAQ,CAAC4U,MAAM,EAAE;cACnB;YACF;YACA,IAAIO,cAA6C,GAAG,0BAAAzE,YAAY,CAACwE,gBAAgB,0DAA7B,sBAA+BE,IAAI,CAAC,UAAC9Y,CAAC;cAAA,OAAK0D,QAAQ,CAACC,KAAK,KAAK3D,CAAC,CAAC+C,UAAU;YAAA,EAAC,KAAI,IAAI;YACvI,IAAI,CAAC8V,cAAc,EAAE;cACnBA,cAAc,GAAG;gBACfta,GAAG,EAAEmF,QAAQ,CAAC9G,GAAG;gBACjB4B,GAAG,EAAEkF,QAAQ,CAAC9G,GAAG;gBACjB0W,IAAI,EAAE,IAAI;gBACVvQ,UAAU,EAAEW,QAAQ,CAACC,KAAK;gBAC1BwU,mBAAmB,EAAE;cACvB,CAA2B;cAC3B;cACA/D,YAAY,CAACwE,gBAAgB,CAACjd,IAAI,CAACkd,cAAc,CAAC;YACpD;YACA,IAAME,aAAa,GAAGjW,gCAAgC,CAACY,QAAQ,EAAEA,QAAQ,CAACC,KAAK,EAAEO,GAAG,CAAClB,KAAK,IAAI,IAAI,EAAE,MAAK4F,QAAQ,CAAC;YAClH,IAAMoQ,YAAY,GAAG,MAAKC,oBAAoB,CAACvV,QAAQ,EAAEmV,cAAc,EAAEzE,YAAY,EAAE2E,aAAa,CAAC;YACrG,IAAM5F,iBAAiB,GAAG;cACxB5K,KAAK,EAAE7E,QAAQ;cACf0Q,YAAY,EAAEA,YAAY;cAC1ByE,cAAc,EAAEA,cAAc;cAC9BvF,IAAI,EAAE0F,YAAY;cAClB7W,KAAK,EAAE4W;YACT,CAA8B;YAE9B,IAAMxa,GAAG,GAAGsa,cAAc,CAACta,GAAG,KAAK,IAAI,GAAGmF,QAAQ,CAAC9G,GAAG,GAAGuB,IAAI,CAACI,GAAG,CAACmF,QAAQ,CAAC9G,GAAG,EAAEic,cAAc,CAACta,GAAG,CAAC;YACnG,IAAMC,GAAG,GAAGqa,cAAc,CAACra,GAAG,KAAK,IAAI,GAAGkF,QAAQ,CAAC9G,GAAG,GAAGuB,IAAI,CAACK,GAAG,CAACkF,QAAQ,CAAC9G,GAAG,EAAEic,cAAc,CAACra,GAAG,CAAC;YACnG,IAAIpC,sBAAsB,CAACmC,GAAG,CAAC,EAAE;cAC/Bsa,cAAc,CAACta,GAAG,GAAGA,GAAG;YAC1B;YACA,IAAInC,sBAAsB,CAACoC,GAAG,CAAC,EAAE;cAC/Bqa,cAAc,CAACra,GAAG,GAAGA,GAAG;YAC1B;YACA;YACA4V,YAAY,CAAC+D,mBAAmB,CAACxc,IAAI,CAACwX,iBAAiB,CAAC;YACxD;YACA0F,cAAc,CAACV,mBAAmB,CAACxc,IAAI,CAACwX,iBAAiB,CAAC;YAC1D;YACA3P,QAAQ,CAAC2U,mBAAmB,CAACxc,IAAI,CAACwX,iBAAiB,CAAC;UACtD,CAAC,CAAC;QACJ;QAEAiB,YAAY,CAACwE,gBAAgB,CAAC3c,OAAO,CAAC,UAAC4c,cAAc,EAAK;UACxD;UACAzc,uBAAuB,CAACgY,YAAY,EAAEyE,cAAc,EAAE,IAAI,CAAC;UAC3D;UACA,IAAMM,SAAS,GAAG,MAAKC,sBAAsB,CAACP,cAAc,EAAEzE,YAAY,CAAC;UAC3EyE,cAAc,CAACvF,IAAI,GAAG6F,SAAS;QACjC,CAAC,CAAC;;QAEF;QACA/c,uBAAuB,CAACoH,QAAQ,EAAE4Q,YAAY,EAAE,IAAI,CAAC;MACvD,CAAC,CAAC;MACF,IAAIhY,sBAAsB,CAACoH,QAAQ,CAAChF,GAAG,CAAC,KAAKgF,QAAQ,CAAChF,GAAG,IAAIgF,QAAQ,CAAChF,GAAG,KAAK,CAAC,CAAC,EAAE;QAChFgF,QAAQ,CAAC8P,IAAI,CAAC9V,KAAK,GAAG,MAAK+P,OAAO,CAAC/J,QAAQ,CAAChF,GAAG,CAAC;MAClD;MACA,OAAOgF,QAAQ;IACjB,CAAC;IAAA,8EAKa,YAAY;MACxB,IAAI,CAAC,MAAKuG,IAAI,EAAE;QACd;MACF;MACA,IAAMsP,SAAS,GAAG,MAAKC,kBAAkB,EAAE;MAC3C,IAAI,EAACD,SAAS,aAATA,SAAS,eAATA,SAAS,CAAEnB,cAAc,GAAE;QAC9B;MACF;MACA,IAAI;QACF,MAAKnO,IAAI,CAAC6M,IAAI,EAAE;QAEhByC,SAAS,CAACnB,cAAc,CAACjc,OAAO,CAAC,UAACmY,YAAY,EAAK;UACjD,IAAI,CAACA,YAAY,IAAI,CAAC,MAAKrK,IAAI,EAAE;YAC/B;UACF;;UAEA;UACA;UACA,MAAKA,IAAI,CAACyN,SAAS,GAAGpD,YAAY,CAAC7L,KAAK,CAACvF,KAAK,GAAGoR,YAAY,CAAC7L,KAAK,CAACvF,KAAK,GAAGF,kCAAkC,CAACsR,YAAY,CAAC7L,KAAK,CAACvF,KAAK,IAAI,IAAI,EAAE,MAAK4F,QAAQ,CAAC;UAC/J;UACA;UACA,IAAM4Q,MAAM,GAAG,MAAKC,UAAU,CAACrF,YAAY,CAACd,IAAI,CAAC;UACjD,IAAIkG,MAAM,aAANA,MAAM,eAANA,MAAM,CAAEla,IAAI,EAAE;YAChB,IAAMA,IAAI,GAAGka,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEla,IAAI;YACzB,MAAKyK,IAAI,CAAC2P,QAAQ,CAACpa,IAAI,CAACjC,CAAC,EAAEiC,IAAI,CAAChC,CAAC,EAAEgC,IAAI,CAAC9B,KAAK,EAAE8B,IAAI,CAAC7B,MAAM,CAAC;YAC3D,IAAI2W,YAAY,CAAC7L,KAAK,CAACoR,SAAS,EAAE;cAChC;cACA;cACA,MAAK5P,IAAI,CAACsN,WAAW,GAAGjD,YAAY,CAAC7L,KAAK,CAACoR,SAAS;cACpD,MAAK5P,IAAI,CAACqN,SAAS,GAAG,CAAC;cACvB,MAAKrN,IAAI,CAAC6P,UAAU,CAACta,IAAI,CAACjC,CAAC,EAAEiC,IAAI,CAAChC,CAAC,EAAEgC,IAAI,CAAC9B,KAAK,EAAE8B,IAAI,CAAC7B,MAAM,CAAC;YAC/D;UACF;UAEA,MAAKoc,kBAAkB,CAACzF,YAAY,CAAC;QACvC,CAAC,CAAC;MACJ,CAAC,SAAS;QACR,MAAKrK,IAAI,CAACgO,OAAO,EAAE;MACrB;IACF,CAAC;IAAA,qFAIoB,UAAC3D,YAAkC,EAAW;MAAA;MACjE,IAAI,CAACA,YAAY,IAAI,CAAC,MAAKrK,IAAI,EAAE;QAC/B;MACF;MAEAqK,YAAY,aAAZA,YAAY,iDAAZA,YAAY,CAAEwE,gBAAgB,2DAA9B,uBAAgC3c,OAAO,CAAC,UAAC2c,gBAAgB,EAAK;QAAA;QAC5D,IAAI,CAAC,MAAK7O,IAAI,EAAE;UACd;QACF;QACA,IAAM+P,iBAAiB,GAAGhX,iCAAiC,CAAC,MAAK8F,QAAQ,EAAEgQ,gBAAgB,CAAC7V,UAAU,EAAEqR,YAAY,aAAZA,YAAY,8CAAZA,YAAY,CAAE7L,KAAK,wDAAnB,oBAAqBvF,KAAK,CAAC;QACnI,IAAI,CAAC8W,iBAAiB,EAAE;UACtB;QACF;QACA,IAAI,CAAClB,gBAAgB,CAACtF,IAAI,EAAE;UAC1B7T,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC;UACrD;QACF;QAEA,IAAIsa,WAAW,GAAG,CAAC;QACnBpB,gBAAgB,CAACT,mBAAmB,CAAClc,OAAO,CAAC,UAAAqP,CAAC,EAAI;UAChD,IAAIA,CAAC,CAAC/C,KAAK,CAAC4H,QAAQ,EAAE;YACpB6J,WAAW,EAAE;UACf;QACF,CAAC,CAAC;QACF,IAAMC,eAAe,GAAGD,WAAW,IAAIpB,gBAAgB,CAACT,mBAAmB,CAACtc,MAAM;QAClF;QACA,IAAMqe,UAAU,GAAG,MAAKT,UAAU,CAACb,gBAAgB,CAACtF,IAAI,CAAC;QACzD,IAAI4G,UAAU,aAAVA,UAAU,eAAVA,UAAU,CAAE5a,IAAI,EAAE;UACpB,MAAKyK,IAAI,CAACyN,SAAS,GAAGsC,iBAAiB;UACvC,IAAMxa,IAAI,GAAG4a,UAAU,CAAC5a,IAAI;UAC5B,MAAKyK,IAAI,CAAC2P,QAAQ,CAACpa,IAAI,CAACjC,CAAC,EAAEiC,IAAI,CAAChC,CAAC,EAAEgC,IAAI,CAAC9B,KAAK,EAAE8B,IAAI,CAAC7B,MAAM,CAAC;UAC3D,MAAKsM,IAAI,CAACsN,WAAW,GAAG4C,eAAe,GAAG,SAAS,GAAGH,iBAAiB;UACvE,IAAIxa,IAAI,CAAC9B,KAAK,EAAE;YACd,MAAKuM,IAAI,CAACqN,SAAS,GAAG,CAAC;YACvB,MAAKrN,IAAI,CAAC6P,UAAU,CAACta,IAAI,CAACjC,CAAC,EAAEiC,IAAI,CAAChC,CAAC,EAAEgC,IAAI,CAAC9B,KAAK,EAAE8B,IAAI,CAAC7B,MAAM,CAAC;UAC/D;QACF;MACF,CAAC,CAAC;IACJ,CAAC;IAAA,6EAKY,UAAC6B,IAAa,EAA0C;MACnE,IAAI,CAACA,IAAI,EAAE;QACT,OAAO,IAAI;MACb;MACA;MACA,IAAM6a,UAAU,GAAG,CAAC;MACpB,IAAMC,IAAI,GAAG,CAAC,GAAGD,UAAU;MAC3B,IAAME,IAAI,GAAG,MAAKpN,kBAAkB,EAAE,GAAGkN,UAAU;MACnD,IAAMG,IAAI,GAAGxX,+BAA+B,CAAC,MAAK8F,QAAQ,CAAC,GAAGuR,UAAU;MACxE,IAAMI,IAAI,GAAG,MAAKC,mBAAmB,EAAE,GAAGL,UAAU;MAEpD,OAAO,MAAKM,qBAAqB,CAACnb,IAAI,EAAE8a,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,CAAC;IACjE,CAAC;IAAA,wFACuB,UAACjb,IAAa,EAAE8a,IAAY,EAAEC,IAAY,EAAEC,IAAY,EAAEC,IAAY,EAA0C;MACtI,IAAI,CAACjb,IAAI,EAAE;QACT,OAAO,IAAI;MACb;MAEA;MACE;MACAlD,8BAA8B,CAACkD,IAAI,EAAE;QACnCjC,CAAC,EAAE+c,IAAI;QACP9c,CAAC,EAAEgd,IAAI;QACP9c,KAAK,EAAEpB,yBAAyB,CAACge,IAAI,EAAEC,IAAI,CAAC;QAC5C5c,MAAM,EAAErB,yBAAyB,CAACke,IAAI,EAAEC,IAAI;MAC9C,CAAC,CAAY,EACb;QACA,IAAMjd,CAAC,GAAGa,IAAI,CAACK,GAAG,CAACc,IAAI,CAAChC,CAAC,EAAEgd,IAAI,CAAC;QAChC,IAAMjd,CAAC,GAAGc,IAAI,CAACK,GAAG,CAACc,IAAI,CAACjC,CAAC,EAAE+c,IAAI,CAAC;QAChC,IAAMM,OAAO,GAAGpb,IAAI,CAACjC,CAAC,GAAGA,CAAC;QAC1B,IAAMsd,OAAO,GAAGrb,IAAI,CAAChC,CAAC,GAAGA,CAAC;QAE1B,OAAO;UACLgC,IAAI,EAAE;YAAE7B,MAAM,EAAE6B,IAAI,CAAC7B,MAAM,GAAGkd,OAAO;YAAEnd,KAAK,EAAE8B,IAAI,CAAC9B,KAAK,GAAGkd,OAAO;YAAErd,CAAC,EAAEA,CAAC;YAAEC,CAAC,EAAEA;UAAE,CAAC;UAChFsd,QAAQ,EAAEzc,IAAI,CAAC4B,GAAG,CAAC4a,OAAO,CAAC,GAAG,CAAC;UAC/BE,QAAQ,EAAE1c,IAAI,CAAC4B,GAAG,CAAC2a,OAAO,CAAC,GAAG;QAChC,CAAC;MACH;MACA,OAAO,IAAI;IACb,CAAC;IAAA,yFAMwB,UAAC7B,cAAsC,EAAEzE,YAAkC,EAAc;MAAA;MAChH,IAAM0G,IAAI,GAAG1G,YAAY,CAACd,IAAI,CAAChW,CAAC;MAChC,IAAMib,SAAS,GAAGnE,YAAY,CAACd,IAAI,CAAC7V,MAAM;MAC1C,IAAMsF,UAAU,GAAG8V,cAAc,CAAC9V,UAAU,IAAI,IAAI;MACpD,IAAIgY,WAAW,GAAGjY,8BAA8B,CAAC,MAAK8F,QAAQ,EAAE7F,UAAU,EAAEqR,YAAY,aAAZA,YAAY,+CAAZA,YAAY,CAAE7L,KAAK,yDAAnB,qBAAqBvF,KAAK,CAAC;MAEvG,IAAIhB,SAAS,GAAGc,iCAAiC,CAAC,MAAK8F,QAAQ,EAAE7F,UAAU,EAAEqR,YAAY,aAAZA,YAAY,+CAAZA,YAAY,CAAE7L,KAAK,yDAAnB,qBAAqBvF,KAAK,CAAC;MACxG,IAAMiY,YAAY,GAAGF,WAAW,KAAK,MAAM;MAC3C,IAAI,CAACA,WAAW,IAAIE,YAAY,EAAE;QAChCF,WAAW,GAAG5c,IAAI,CAACyC,KAAK,CAAC2X,SAAS,CAAC;MACrC;MACAwC,WAAW,GAAG,OAAOA,WAAW,KAAK,QAAQ,GAAGG,QAAQ,CAACH,WAAW,CAAC,GAAGA,WAAW;MACnF,IAAIA,WAAW,GAAGxC,SAAS,EAAE;QAC3BwC,WAAW,GAAGxC,SAAS;MACzB;MACA,IAAM4C,YAAY,GAAGnZ,SAAS,KAAK,MAAM;MACzC,IAAI,OAAOA,SAAS,KAAK,QAAQ,EAAE;QACjC,IAAImZ,YAAY,EAAE;UAChBnZ,SAAS,GAAG,CAACuW,SAAS,GAAGwC,WAAW,IAAI,CAAC;QAC3C,CAAC,MAAM;UACL/Y,SAAS,GAAGkZ,QAAQ,CAAClZ,SAAS,CAAC,IAAI,CAAC;QACtC;MACF;MAEA,IAAI,CAACmZ,YAAY,EAAE;QACjB,IAAIF,YAAY,EAAE;UAChBF,WAAW,IAAI/Y,SAAS,GAAG,CAAC;QAC9B;MACF;;MAEA;MACA,IAAMoZ,IAAI,GAAG,MAAKnE,WAAW,CAAC4B,cAAc,CAACta,GAAG,CAAC,CAAC,CAAC;MACnD,IAAM8c,IAAI,GAAG,MAAKpE,WAAW,CAAC4B,cAAc,CAACra,GAAG,CAAC,CAAC,CAAC;;MAEnD,OAAO;QACLnB,CAAC,EAAE+d,IAAI;QACP9d,CAAC,EAAEwd,IAAI,GAAG9Y,SAAS;QACnBvE,MAAM,EAAEsd,WAAW;QACnBvd,KAAK,EAAEpB,yBAAyB,CAACgf,IAAI,EAAEC,IAAI;MAC7C,CAAC;IACH,CAAC;IAAA,uFAEsB,UAAC3X,QAA0B,EAAEmV,cAAsC,EAAEzE,YAAkC,EAAE2E,aAAoC,EAAqB;MAAA;MACvL,IAAI,CAACrV,QAAQ,EAAE;QACbjE,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;QAC1C,OAAO,IAAI;MACb;MAEA,IAAM9C,GAAG,GAAG8G,QAAQ,CAAC9G,GAAG;MACxB,IAAI,CAACR,sBAAsB,CAACQ,GAAG,CAAC,EAAE;QAChC,OAAO,IAAI;MACb;MAEA,IAAM+b,OAAO,GAAGvE,YAAY,CAACd,IAAI;MACjC;MACA,IAAIhW,CAAC,GAAGqb,OAAO,CAACrb,CAAC,GAAGqb,OAAO,CAAClb,MAAM,GAAG,CAAC;MACtC,IAAMsF,UAAU,GAAG,CAAA8V,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAE9V,UAAU,KAAI,IAAI;MACrD,IAAItF,MAAuB,GAAGqF,iCAAiC,CAACY,QAAQ,EAAEX,UAAU,EAAEqR,YAAY,aAAZA,YAAY,+CAAZA,YAAY,CAAE7L,KAAK,yDAAnB,qBAAqBvF,KAAK,EAAE,MAAK4F,QAAQ,CAAC;MAChI,IAAIpL,KAAsB,GAAGsF,gCAAgC,CAACY,QAAQ,EAAEX,UAAU,EAAEqR,YAAY,aAAZA,YAAY,+CAAZA,YAAY,CAAE7L,KAAK,yDAAnB,qBAAqBvF,KAAK,EAAE,MAAK4F,QAAQ,CAAC;MAE9H,IAAInL,MAAM,KAAK,MAAM,EAAE;QACrBA,MAAM,GAAGkb,OAAO,CAAClb,MAAM,GAAG,CAAC;MAC7B;MACA,IAAID,KAAK,KAAK,MAAM,EAAE;QACpBA,KAAK,GAAGC,MAAM;MAChB;MACA,IAAIA,MAAM,GAAG,CAAC,EAAE;QACd,IAAMJ,CAAC,GAAGc,IAAI,CAACyC,KAAK,CAAC,MAAKqW,WAAW,CAACra,GAAG,CAAC,CAAC;QAC3CU,CAAC,GAAGa,IAAI,CAACyC,KAAK,CAACtD,CAAC,CAAC;QACjB,IAAMgC,IAAI,GAAG;UACXjC,CAAC,EAAEA,CAAC;UAAE;UACNC,CAAC,EAAEA,CAAC;UACJG,MAAM,EAAEA,MAAM;UACdD,KAAK,EAAEA;QACT,CAAY;QACZ;QACA,IAAIub,aAAa,KAAK7c,0BAA0B,EAAE;UAChDoD,IAAI,CAAChC,CAAC,GAAGgC,IAAI,CAAChC,CAAC,GAAGgC,IAAI,CAAC7B,MAAM,GAAG,CAAC;UACjC6B,IAAI,CAACjC,CAAC,GAAGiC,IAAI,CAACjC,CAAC,GAAGiC,IAAI,CAAC9B,KAAK,GAAG,CAAC;QAClC;QACA,OAAO8B,IAAI;MACb;MAEA,OAAO,IAAI;IACb,CAAC;IAAA,mFAEkB,YAAY;MAC7B,MAAK4T,gBAAgB,CAAC,UAACC,iBAAiB,EAAK;QAC3C,IAAI,CAAC,MAAKpJ,IAAI,EAAE;UACd;QACF;QACA,IAAM7F,GAAG,GAAGiP,iBAAiB,CAACiB,YAAY,CAAC7L,KAAK;QAChD,IAAM+K,IAAI,GAAGH,iBAAiB,CAACG,IAAI;QACnC,IAAM5P,QAAQ,GAAGyP,iBAAiB,CAAC5K,KAAK;QACxC,IAAI+K,IAAI,EAAE;UAAA;UACR,IAAMjW,CAAC,GAAG,MAAK2Z,SAAS,CAAC1D,IAAI,CAACjW,CAAC,CAAC;UAChC,IAAMC,CAAC,GAAGgW,IAAI,CAAChW,CAAC;UAChB,IAAMkc,MAAM,GAAG,MAAKC,UAAU,CAAC;YAC7Bpc,CAAC,EAAEA,CAAC,GAAGiW,IAAI,CAAC9V,KAAK,GAAG,CAAC;YACrBF,CAAC,EAAEA,CAAC,GAAGgW,IAAI,CAAC7V,MAAM,GAAG,CAAC;YACtBD,KAAK,EAAE8V,IAAI,CAAC9V,KAAK;YACjBC,MAAM,EAAE6V,IAAI,CAAC7V;UACf,CAAC,CAAY;UACb,IAAI,CAAC+b,MAAM,EAAE;YACX;UACF;UAEA,MAAKzP,IAAI,CAAC6M,IAAI,EAAE;;UAEhB;UACA;UACA,IAAI4C,MAAM,IAAIA,MAAM,CAACoB,QAAQ,EAAE;YAC7B,MAAK7Q,IAAI,CAACmN,SAAS,EAAE;YACrB,MAAKnN,IAAI,CAACzK,IAAI,CAAC,CAAC,EAAEwD,+BAA+B,CAAC,MAAK8F,QAAQ,CAAC,EAAE,MAAKqE,kBAAkB,EAAE,EAAE,MAAKA,kBAAkB,EAAE,CAAC;YACvH,MAAKlD,IAAI,CAACyR,IAAI,EAAE;UAClB;UAEA,IAAMrZ,KAAK,GAAGgR,iBAAiB,CAAChR,KAAK;UACrC,IAAIA,KAAK,KAAKjG,0BAA0B,EAAE;YACxC;UACF;UACA,IAAM0H,QAAQ,GAAGM,GAAG,CAAClB,KAAK,IAAI,IAAI;UAClC,IAAMD,UAAU,GAAG,CAAAoQ,iBAAiB,aAAjBA,iBAAiB,gDAAjBA,iBAAiB,CAAE0F,cAAc,0DAAjC,sBAAmC9V,UAAU,KAAI,IAAI;UACxE,IAAM0Y,aAAa,GAAG/X,QAAQ,CAACyM,QAAQ,GACnCrN,4CAA4C,CAACY,QAAQ,EAAEX,UAAU,EAAEa,QAAQ,EAAE,MAAKgF,QAAQ,CAAC,GAC3F9F,oCAAoC,CAACY,QAAQ,EAAEX,UAAU,EAAEa,QAAQ,EAAE,MAAKgF,QAAQ,CAAC;UACvF,IAAMgT,MAAM,GAAG9Y,0CAA0C,CAACY,QAAQ,EAAEX,UAAU,EAAEa,QAAQ,EAAE,MAAKgF,QAAQ,CAAC;UACxG,IAAItG,WAAW,GAAG,EAAE;UACpB,IAAIsZ,MAAM,GAAG,CAAC,EAAE;YACd,IAAIlY,QAAQ,CAACyM,QAAQ,EAAE;cACrB7N,WAAW,GAAGQ,8CAA8C,CAACY,QAAQ,EAAEX,UAAU,EAAEa,QAAQ,EAAE,MAAKgF,QAAQ,CAAC;YAC7G,CAAC,MAAM;cACLtG,WAAW,GAAGQ,sCAAsC,CAACY,QAAQ,EAAEX,UAAU,EAAEa,QAAQ,EAAE,MAAKgF,QAAQ,CAAC;YACrG;UACF;UAEA,IAAIzG,KAAK,IAAIjG,2BAA2B,EAAE;YACxC,MAAK6N,IAAI,CAACmN,SAAS,EAAE;YACrB,MAAKnN,IAAI,CAACiS,SAAS,CAAC3e,CAAC,EAAEC,CAAC,CAAC;YACzB,MAAKyM,IAAI,CAACkS,MAAM,CAAE,EAAE,GAAG9d,IAAI,CAAC+d,EAAE,GAAI,GAAG,CAAC;YACtC,IAAIN,MAAM,GAAG,CAAC,IAAItZ,WAAW,EAAE;cAC7B,MAAKyH,IAAI,CAACyN,SAAS,GAAGlV,WAAW;cACjC,MAAKyH,IAAI,CAACzK,IAAI,CAAC,CAACgU,IAAI,CAAC9V,KAAK,GAAG,CAAC,EAAE,CAAC8V,IAAI,CAAC7V,MAAM,GAAG,CAAC,EAAE6V,IAAI,CAAC9V,KAAK,EAAE8V,IAAI,CAAC7V,MAAM,CAAC;cAC1E,MAAKsM,IAAI,CAACoS,IAAI,EAAE;YAClB;YAEA,MAAKpS,IAAI,CAACyN,SAAS,GAAGiE,aAAa;YACnC;YACA,MAAK1R,IAAI,CAACiS,SAAS,CAACJ,MAAM,EAAEA,MAAM,CAAC;YACnC,MAAK7R,IAAI,CAACzK,IAAI,CAAC,CAACgU,IAAI,CAAC9V,KAAK,GAAG,CAAC,EAAE,CAAC8V,IAAI,CAAC7V,MAAM,GAAG,CAAC,EAAE6V,IAAI,CAAC9V,KAAK,GAAGoe,MAAM,GAAG,CAAC,EAAEtI,IAAI,CAAC7V,MAAM,GAAGme,MAAM,GAAG,CAAC,CAAC;YACpG,MAAK7R,IAAI,CAACoS,IAAI,EAAE;UAClB,CAAC,MAAM,IAAIha,KAAK,IAAIjG,4BAA4B,EAAE;YAChD,MAAK6N,IAAI,CAACmN,SAAS,EAAE;YACrB,IAAI0E,MAAM,GAAG,CAAC,IAAItZ,WAAW,EAAE;cAC7B,MAAKyH,IAAI,CAACyN,SAAS,GAAGlV,WAAW;cACjC,MAAKyH,IAAI,CAACsS,GAAG,CAAChf,CAAC,EAAEC,CAAC,EAAEgW,IAAI,CAAC7V,MAAM,EAAE,CAAC,EAAE,CAAC,GAAGU,IAAI,CAAC+d,EAAE,CAAC;YAClD;YACA,MAAKnS,IAAI,CAACyN,SAAS,GAAGiE,aAAa;YACnC,MAAK1R,IAAI,CAACsS,GAAG,CAAChf,CAAC,EAAEC,CAAC,EAAEgW,IAAI,CAAC7V,MAAM,GAAGme,MAAM,EAAE,CAAC,EAAE,CAAC,GAAGzd,IAAI,CAAC+d,EAAE,CAAC;YACzD,MAAKnS,IAAI,CAACoS,IAAI,EAAE;UAClB,CAAC,MAAM,IAAIha,KAAK,IAAIjG,0BAA0B,EAAE;YAC9C,MAAK6N,IAAI,CAACmN,SAAS,EAAE;YAErB,IAAI0E,MAAM,GAAG,CAAC,IAAItZ,WAAW,EAAE;cAC7B,MAAKyH,IAAI,CAACyN,SAAS,GAAGlV,WAAW;cACjC,MAAKyH,IAAI,CAACzK,IAAI,CAACjC,CAAC,EAAEC,CAAC,EAAEgW,IAAI,CAAC9V,KAAK,EAAE8V,IAAI,CAAC7V,MAAM,CAAC;cAC7C,MAAKsM,IAAI,CAACoS,IAAI,EAAE;YAClB;YAEA,MAAKpS,IAAI,CAACyN,SAAS,GAAGiE,aAAa;YACnC,MAAK1R,IAAI,CAACzK,IAAI,CAACjC,CAAC,GAAGue,MAAM,EAAEte,CAAC,GAAGse,MAAM,EAAEtI,IAAI,CAAC9V,KAAK,GAAGoe,MAAM,EAAEtI,IAAI,CAAC7V,MAAM,GAAGme,MAAM,CAAC;YACjF,MAAK7R,IAAI,CAACoS,IAAI,EAAE;UAClB;UAEA,MAAKpS,IAAI,CAACgO,OAAO,EAAE;QACrB;MACF,CAAC,CAAC;IACJ,CAAC;IAAA,uFAEsB,YAAY;MACjC,IAAI,MAAKpI,KAAK,IAAI,CAAC,MAAK5F,IAAI,IAAI,CAAC,MAAKR,OAAO,EAAE;QAC7C;MACF;MACA,MAAKQ,IAAI,CAAC6M,IAAI,EAAE;MAChB,IAAM0F,SAAS,GAAG,CAAC;MACnB,IAAI,MAAKnL,cAAc,IAAI,MAAKE,qBAAqB,EAAE;QACrD,MAAKtH,IAAI,CAACoN,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;QAC1B,MAAKpN,IAAI,CAACqN,SAAS,GAAG,MAAKa,WAAW;QACtC,IAAMrQ,cAAc,GAAG,MAAKgB,QAAQ,CAAChB,cAAc;QACnD,IAAIA,cAAc,EAAE;UAClB,MAAKmC,IAAI,CAACsN,WAAW,GAAGzP,cAAc;QACxC;QACA,MAAKmC,IAAI,CAAC6P,UAAU,CAClB,MAAK5C,SAAS,CAAC,MAAK7F,cAAc,CAAC9T,CAAC,EAAEif,SAAS,CAAC,EAChD,MAAKtF,SAAS,CAAC,MAAK7F,cAAc,CAAC7T,CAAC,EAAEgf,SAAS,CAAC,EAChDne,IAAI,CAACyC,KAAK,CAAC,MAAKuQ,cAAc,CAAC3T,KAAK,CAAC,EACrCW,IAAI,CAACyC,KAAK,CAAC,MAAKuQ,cAAc,CAAC1T,MAAM,CAAC,CACvC;MACH;MACA,MAAKsM,IAAI,CAACgO,OAAO,EAAE;IACrB,CAAC;IAAA,oFAEmB,YAAY;MAC9B,IAAI,CAAC,MAAKhO,IAAI,IAAI,CAAC,MAAKR,OAAO,EAAE;QAC/B;MACF;MACA,IAAI,MAAKX,QAAQ,CAAC3G,SAAS,EAAE;QAC3B,MAAK8H,IAAI,CAAC6M,IAAI,EAAE;QAChB,MAAK7M,IAAI,CAACmN,SAAS,EAAE;QACrB,MAAKnN,IAAI,CAACzK,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,MAAK2N,kBAAkB,EAAE,EAAE,MAAKuN,mBAAmB,EAAE,CAAC;QAC3E,MAAKzQ,IAAI,CAACyN,SAAS,GAAG,MAAK5O,QAAQ,CAAC3G,SAAS;QAC7C,MAAK8H,IAAI,CAACoS,IAAI,EAAE;QAChB,MAAKpS,IAAI,CAACgO,OAAO,EAAE;MACrB,CAAC,MAAM;QACL;QACA,MAAKhO,IAAI,CAACwS,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,MAAKhT,OAAO,CAAC/L,KAAK,EAAE,MAAK+L,OAAO,CAAC9L,MAAM,CAAC;MACpE;IACF,CAAC;IAAA,kFAEiB,YAAY;MAC5B,IAAI,CAAC,MAAKsM,IAAI,IAAI,CAAC,MAAKnB,QAAQ,IAAI,CAAC,MAAKA,QAAQ,CAACzB,aAAa,EAAE;QAChE;MACF;MACA,IAAMnE,KAAK,GAAG,MAAK4F,QAAQ,CAACzB,aAAa;MACzC,MAAK4C,IAAI,CAAC6M,IAAI,EAAE;MAChB,IAAI;QACF,IAAM0F,SAAS,GAAGtZ,KAAK,CAACxF,KAAK,IAAI,CAAC;QAClC,MAAKuM,IAAI,CAACqN,SAAS,GAAGkF,SAAS,GAAG,MAAKrE,WAAW;QAClD,IAAMuE,WAAW,GAAG,MAAKxF,SAAS,CAAC,MAAKC,WAAW,CAAC,MAAKwF,IAAI,CAAC,EAAEH,SAAS,CAAC;QAC1E,IAAItZ,KAAK,CAACV,WAAW,EAAE;UACrB,MAAKyH,IAAI,CAACsN,WAAW,GAAGrU,KAAK,CAACV,WAAW;QAC3C;QACA,IAAIU,KAAK,CAACf,SAAS,EAAE;UACnB,MAAK8H,IAAI,CAACyN,SAAS,GAAGxU,KAAK,CAACf,SAAS;QACvC;QACA,IAAM3E,CAAC,GAAG0F,KAAK,CAAChB,SAAS,IAAI,CAAC;QAC9B,IAAM0a,OAAO,GAAG1Z,KAAK,CAACN,YAAY,IAAI,CAAC;QACvC,MAAKqH,IAAI,CAACmN,SAAS,EAAE;QACrB,IAAMyF,YAAY,GAAG,MAAKnC,mBAAmB,EAAE,GAAGkC,OAAO;QACzDtgB,sBAAsB,CAAC,MAAK2N,IAAI,EAAEyS,WAAW,EAAElf,CAAC,EAAEkf,WAAW,EAAEG,YAAY,CAAC;QAC5E,MAAK5S,IAAI,CAACwN,MAAM,EAAE;QAClB,MAAKqF,kBAAkB,CAACJ,WAAW,EAAElf,CAAC,CAAC;MACzC,CAAC,SAAS;QACR,MAAKyM,IAAI,CAACgO,OAAO,EAAE;MACrB;IACF,CAAC;IAAA,qFAIoB,UAACyE,WAAmB,EAAElf,CAAS,EAAW;MAAA;MAC7D,IAAMqJ,QAAQ,sBAAG,MAAKiC,QAAQ,6EAAb,gBAAezB,aAAa,0DAA5B,sBAA8BR,QAAQ;MACvD,IAAI,CAAC,MAAKoD,IAAI,IAAI,CAACpD,QAAQ,EAAE;QAC3B;MACF;MACA,IAAIA,QAAQ,CAACC,OAAO,KAAKlB,qBAAqB,EAAE;QAC9C;MACF;MACA,MAAKqE,IAAI,CAAC6M,IAAI,EAAE;MAChB,IAAI;QACF,IAAMiG,OAAO,GAAGlW,QAAQ,CAACnJ,KAAK,IAAI,CAAC;QACnC,IAAMsf,SAAS,GAAGnW,QAAQ,CAAClJ,MAAM,IAAI,CAAC;QACtC,IAAIof,OAAO,IAAIC,SAAS,EAAE;UACxB,MAAK/S,IAAI,CAACsN,WAAW,GAAG1Q,QAAQ,CAACrE,WAAW;UAC5C,MAAKyH,IAAI,CAACyN,SAAS,GAAG7Q,QAAQ,CAAC1E,SAAS;UACxC,IAAI0E,QAAQ,CAACC,OAAO,KAAKlB,yBAAyB,EAAE;YAClD,MAAKqE,IAAI,CAACmN,SAAS,EAAE;YACrB,MAAKnN,IAAI,CAACrN,MAAM,CAAC8f,WAAW,GAAGK,OAAO,GAAG,CAAC,EAAEvf,CAAC,CAAC;YAC9C,MAAKyM,IAAI,CAACpN,MAAM,CAAC6f,WAAW,GAAGK,OAAO,GAAG,CAAC,EAAEvf,CAAC,CAAC;YAC9C,MAAKyM,IAAI,CAACpN,MAAM,CAAC6f,WAAW,EAAEM,SAAS,CAAC;YACxC,MAAK/S,IAAI,CAACiT,SAAS,EAAE;YACrB,MAAKjT,IAAI,CAACwN,MAAM,EAAE;UACpB,CAAC,MAAM,IAAI5Q,QAAQ,CAACC,OAAO,KAAKlB,qBAAqB,EAAE;YACrD,MAAKqE,IAAI,CAAC2P,QAAQ,CAAC8C,WAAW,GAAGK,OAAO,GAAG,CAAC,EAAEvf,CAAC,EAAEuf,OAAO,EAAEC,SAAS,CAAC;YACpE,MAAK/S,IAAI,CAACoS,IAAI,EAAE;UAClB;QACF;MACF,CAAC,SAAS;QACR,MAAKpS,IAAI,CAACgO,OAAO,EAAE;MACrB;IACF,CAAC;IAAA,0FACyB,YAAY;MACpC,IAAI,CAAC,MAAKhO,IAAI,IAAI,CAAC,MAAKnB,QAAQ,EAAE;QAChC;MACF;MACA,IAAI9F,+BAA+B,CAAC,MAAK8F,QAAQ,CAAC,EAAE;QAClD,MAAKmB,IAAI,CAAC6M,IAAI,EAAE;QAChB;QACA,MAAK7M,IAAI,CAACqN,SAAS,GAAG,MAAKa,WAAW;QACtC,IAAI,MAAKrP,QAAQ,CAACnB,eAAe,EAAE;UACjC;UACA,MAAKsC,IAAI,CAACqN,SAAS,GAAG,MAAKa,WAAW;UACtC;UACA,MAAKlO,IAAI,CAACyN,SAAS,GAAG,MAAK5O,QAAQ,CAACnB,eAAe;UACnD,MAAKsC,IAAI,CAAC2P,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,MAAKzM,kBAAkB,EAAE,EAAEnK,+BAA+B,CAAC,MAAK8F,QAAQ,CAAC,CAAC;QACrG,CAAC,MAAM;UACL,MAAKmB,IAAI,CAACwS,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,MAAKtP,kBAAkB,EAAE,EAAEnK,+BAA+B,CAAC,MAAK8F,QAAQ,CAAC,CAAC;QACtG;QACA,MAAKmB,IAAI,CAACgO,OAAO,EAAE;MACrB;IACF,CAAC;IAAA,yEAEQ,YAAY;MACnB,IAAI9X,MAAM,CAACgd,qBAAqB,EAAE;QAChChd,MAAM,CAACgd,qBAAqB,CAAC,MAAKC,eAAe,CAAC;MACpD,CAAC,MAAM;QACL,MAAKA,eAAe,EAAE;MACxB;IACF,CAAC;IAAA,sFAK4B,YAAY;MACvC,IAAI,MAAK9T,gBAAgB,IAAI,MAAKA,gBAAgB,CAACwE,UAAU,KAAK,MAAKxE,gBAAgB,CAAC+T,WAAW,EAAE;QACnG,MAAKvP,UAAU,GAAG,MAAKxE,gBAAgB,CAAC+T,WAAW;MACrD;IACF,CAAC;IAAA,kFAKiB,YAAY;MAC5B,IAAI,CAAC,MAAKpT,IAAI,IAAI,CAAC,MAAKX,gBAAgB,EAAE;QACxC3J,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;QACzC;MACF;MACA;MACA,IAAI,MAAK6N,OAAO,CAAC,MAAKkP,IAAI,CAAC,GAAG,MAAKrT,gBAAgB,CAAC+T,WAAW,EAAE;QAC/D,MAAKpU,OAAO,EAAE;QACd,IAAI,CAAC,MAAKkD,aAAa,IAAI,MAAK0D,KAAK,IAAI,MAAKA,KAAK,CAACC,IAAI,KAAKpL,4BAA4B,EAAE;UACzF,MAAK4Y,mBAAmB,EAAE;QAC5B;MACF;MAEA,MAAKC,iBAAiB,EAAE;MACxB,MAAKC,WAAW,EAAE;MAClB;MACA,MAAKC,uBAAuB,EAAE;MAC9B,MAAKC,YAAY,EAAE;MACnB,MAAKC,gBAAgB,EAAE;MACvB,MAAKC,oBAAoB,EAAE;MAC3B,MAAKC,eAAe,EAAE;IACxB,CAAC;IAAA,4EAKW,UAACrY,GAAW,EAA4B;MAAA,IAA1BgX,SAAS,uEAAG,CAAC;MACrChX,GAAG,GAAGnH,IAAI,CAACsP,KAAK,CAACnI,GAAG,CAAC;MACrB,IAAIgX,SAAS,GAAG,CAAC,IAAI,CAAC,EAAE;QACtB,OAAOhX,GAAG;MACZ;MAEA,OAAOA,GAAG,GAAG,MAAK2S,WAAW,GAAG,CAAC;IACnC,CAAC;IAAA,0EAKgB,YAAc;MAC7B,OAAO,MAAKwE,IAAI;IAClB,CAAC;IAAA,mFAOkB,UAAC7f,GAAW,EAAkF;MAAA,IAAhFmX,MAA2B,uEAAGjP,oCAAoC;MACjG,IAAI,CAAC,MAAK8D,QAAQ,EAAE;QAClB,OAAO,KAAK;MACd;MACAhM,GAAG,GAAGuB,IAAI,CAACsP,KAAK,CAAC7Q,GAAG,CAAC;MACrBA,GAAG,GAAGR,0BAA0B,CAACQ,GAAG,EAAE,MAAKgM,QAAQ,CAACrK,GAAG,CAAC;MACxD,IAAI,MAAKke,IAAI,IAAI7f,GAAG,EAAE;QACpB,IAAMgU,OAAO,GAAG,MAAK6L,IAAI;QACzB,IAAMmB,aAAa,GAAG,IAAI7Y,wBAAwB,EAAE;QACpD6Y,aAAa,CAAChhB,GAAG,GAAGA,GAAG;QACvBghB,aAAa,CAAChN,OAAO,GAAGA,OAAO;QAC/BgN,aAAa,CAAC7J,MAAM,GAAGA,MAAM;QAC7B,MAAK0I,IAAI,GAAG7f,GAAG;QACf,MAAKihB,IAAI,CAAChY,0BAA0B,EAAE+X,aAAa,CAAC;QACpD,IAAIA,aAAa,CAACnO,WAAW,EAAE,EAAE;UAC/B,MAAKgN,IAAI,GAAG7L,OAAO;UACnB,OAAO,KAAK;QACd;QACA,OAAO,IAAI;MACb;MAEA,OAAO,KAAK;IACd,CAAC;IAAA,0EACgB,UAAChU,GAAW,EAAc;MACzC;MACA,IAAI,MAAK+S,KAAK,IAAI,MAAKA,KAAK,CAACC,IAAI,KAAKpL,4BAA4B,EAAE;QAClE,OAAO,KAAK;MACd;MAEA,IAAMiP,SAAS,GAAG,MAAKhC,gBAAgB,CAAC7U,GAAG,EAAEkI,iCAAiC,CAAC;MAC/E,IAAI2O,SAAS,EAAE;QACb,MAAK1K,OAAO,EAAE;QACd,MAAKC,MAAM,EAAE;MACf;MAEA,OAAOyK,SAAS;IAClB,CAAC;IAAA,6EAEmB,YAAuB;MACzC,OAAO,MAAK7K,QAAQ;IACtB,CAAC;IAAA,6EA6BmB,UAACoV,KAAsB,EAAsB;MAC/D,MAAKpV,QAAQ,GAAG,MAAKC,WAAW,CAACmV,KAAK,CAAC;MACvC,MAAKjV,OAAO,EAAE;MACd,MAAKC,MAAM,EAAE;MACb;MACA,OAAO,MAAKJ,QAAQ;IACtB,CAAC;IAAA,yFAKwB,YAAY;MACnC,IAAI,MAAKQ,gBAAgB,IAAI,MAAKR,QAAQ,EAAE;QAC1C,IAAMqV,SAAS,GAAG,MAAK7U,gBAAgB,CAAC6U,SAAS;QACjD,IAAI,MAAKrV,QAAQ,CAACT,oBAAoB,IAAI,CAAC8V,SAAS,CAACC,QAAQ,CAAC,MAAKtV,QAAQ,CAACT,oBAAoB,CAAC,EAAE;UACjG8V,SAAS,CAACE,GAAG,CAAC,MAAKvV,QAAQ,CAACT,oBAAoB,CAAC;QACnD;QACA,IAAI,MAAKS,QAAQ,CAAC3G,SAAS,EAAE;UAC3B,MAAKmH,gBAAgB,CAACpG,KAAK,CAACob,UAAU,GAAG,MAAKxV,QAAQ,CAAC3G,SAAS;QAClE;MACF;IACF,CAAC;IAAA,8EACa,UAAC+b,KAAsB,EAAsB;MACzD,IAAI,CAACA,KAAK,EAAE;QACV,OAAO,MAAKpV,QAAQ,IAAI,CAAC,CAAC;MAC5B;MACA,MAAKA,QAAQ,GAAGxM,0BAA0B,CAAC,MAAKwM,QAAQ,EAAEoV,KAAK,CAAC;MAChE;MACA,MAAKpV,QAAQ,CAACrB,QAAQ,GAAGnL,0BAA0B,CAAC,MAAKwM,QAAQ,CAACrB,QAAQ,IAAI,CAAC,EAAE,CAAC,EAAE,MAAKqB,QAAQ,CAACvB,OAAO,IAAI,CAAC,CAAC;MAC/G,MAAK+F,YAAY,GAAG,MAAKC,QAAQ,CAAC,MAAKzE,QAAQ,CAACd,IAAI,IAAI,CAAC,EAAE,MAAKc,QAAQ,CAACZ,OAAO,EAAE,MAAKY,QAAQ,CAACX,OAAO,CAAC;MACxG,MAAKW,QAAQ,CAACrK,GAAG,GAAGnC,sBAAsB,CAAC,MAAKwM,QAAQ,CAACrK,GAAG,CAAC,GAAG,MAAKqK,QAAQ,CAACrK,GAAG,GAAG,CAAC;MACrF,MAAKqK,QAAQ,CAACpK,GAAG,GAAGpC,sBAAsB,CAAC,MAAKwM,QAAQ,CAACpK,GAAG,CAAC,GAAG,MAAKoK,QAAQ,CAACpK,GAAG,GAAG1B,MAAM,CAACuL,SAAS;MACpG,MAAKiW,sBAAsB,EAAE;MAC7B;MACA,IAAIN,KAAK,CAAC5V,iBAAiB,KAAK,KAAK,EAAE;QACrC,IAAI,MAAKuH,KAAK,IAAI,MAAKA,KAAK,CAACC,IAAI,KAAKpL,4BAA4B,EAAE;UAClE,MAAK0G,iBAAiB,EAAE;QAC1B;MACF;MACA,OAAO,MAAKtC,QAAQ;IACtB,CAAC;IAAA,2EAKiB,YAA4B;MAC5C,OAAO,MAAKH,MAAM;IACpB,CAAC;IAAA,2EAMiB,UAAC0L,IAAmB,EAAW;MAC/C,MAAK1L,MAAM,GAAG0L,IAAI;MAClB,MAAKpL,OAAO,EAAE;MACd,MAAKC,MAAM,EAAE;IACf,CAAC;IAAA,+EAGc,UAACkN,MAAyB,EAAE5K,CAAgC,EAAwB;MACjG,IAAI6C,MAAM,GAAG,CAAC;MACd,IAAIoQ,OAAO,GAAG,CAAC;MACf,IAAIC,OAAO,GAAG,CAAC;MACf,IAAIlT,CAAC,CAAC4F,cAAc,IAAI5F,CAAC,CAAC4F,cAAc,CAACrV,MAAM,GAAG,CAAC,EAAE;QACnD;QACA,IAAM2D,KAAK,GAAG8L,CAAC,CAAC4F,cAAc,CAAC,CAAC,CAAC;QACjCqN,OAAO,GAAG/e,KAAK,CAAC+e,OAAO;QACvBC,OAAO,GAAGhf,KAAK,CAACgf,OAAO;QACvBrQ,MAAM,GAAGhQ,IAAI,CAACK,GAAG,CAAC2P,MAAM,EAAE3O,KAAK,CAACif,OAAO,EAAEjf,KAAK,CAACkf,OAAO,CAAC;MACzD,CAAC,MAAM;QACLH,OAAO,GAAGjT,CAAC,CAACiT,OAAO;QACnBC,OAAO,GAAGlT,CAAC,CAACkT,OAAO;MACrB;MAEA,IAAMlf,IAAI,GAAG4W,MAAM,CAACyI,qBAAqB,EAAE;QAAE;QAC3CC,MAAM,GAAG1I,MAAM,CAAC1Y,KAAK,GAAG,MAAKya,WAAW,GAAG3Y,IAAI,CAAC9B,KAAK;QAAE;QACvDqhB,MAAM,GAAG3I,MAAM,CAACzY,MAAM,GAAG,MAAKwa,WAAW,GAAG3Y,IAAI,CAAC7B,MAAM,CAAC,CAAC;;MAE3D,IAAMJ,CAAC,GAAG,CAACkhB,OAAO,GAAGjf,IAAI,CAACwf,IAAI,IAAIF,MAAM;MACxC,IAAMthB,CAAC,GAAG,CAACkhB,OAAO,GAAGlf,IAAI,CAACyf,GAAG,IAAIF,MAAM;MACvC;MACA,OAAO;QACLvZ,GAAG,EAAE;UAAEjI,CAAC,EAADA,CAAC;UAAEC,CAAC,EAADA;QAAE,CAAa;QACzB6Q,MAAM,EAANA,MAAM;QACNnS,IAAI,EAAEsP;MACR,CAAC;IACH,CAAC;IAAA,qFAKoB,YAAe;MAClC,IAAI,CAAC,MAAKlC,gBAAgB,IAAI,CAAC,MAAKF,UAAU,IAAI,CAAC,MAAKa,IAAI,EAAE;QAC5DtK,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC;QACrD,OAAO,KAAK;MACd;MACA,IAAImS,OAAO,GAAG,KAAK;MACnB,IAAMrU,KAAK,GAAG,MAAK4L,gBAAgB,CAACU,WAAW,GAAG,MAAKmO,WAAW;MAClE,IAAMxa,MAAM,GAAG,MAAK2L,gBAAgB,CAAC2J,YAAY,GAAG,MAAKkF,WAAW;MACpE,IAAI9Z,IAAI,CAACyC,KAAK,CAACpD,KAAK,CAAC,IAAIW,IAAI,CAACyC,KAAK,CAAC,MAAKmJ,IAAI,CAACmM,MAAM,CAAC1Y,KAAK,CAAC,EAAE;QAC3D,MAAKuM,IAAI,CAACmM,MAAM,CAAC1Y,KAAK,GAAGA,KAAK;QAC9BqU,OAAO,GAAG,IAAI;MAChB;MAEA,IAAI1T,IAAI,CAACyC,KAAK,CAACnD,MAAM,CAAC,IAAIU,IAAI,CAACyC,KAAK,CAAC,MAAKmJ,IAAI,CAACmM,MAAM,CAACzY,MAAM,CAAC,EAAE;QAC7D,MAAKsM,IAAI,CAACmM,MAAM,CAACzY,MAAM,GAAGA,MAAM;QAChCoU,OAAO,GAAG,IAAI;MAChB;MAEA,IAAIA,OAAO,EAAE;QACX,MAAK9H,IAAI,CAACiV,YAAY,CAAC,MAAK/G,WAAW,EAAE,CAAC,EAAE,CAAC,EAAE,MAAKA,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC;MACxE;MACA,OAAOpG,OAAO;IAChB,CAAC;IAAA,0EAKgB,YAAe;MAC9B,OAAO,MAAKnE,gBAAgB,EAAE;IAChC,CAAC;IAAA,mFAMkB,YAA6H;MAAA,IAA5HuR,QAAuB,uEAAG,IAAI;MAAA,IAAEC,SAAwB,uEAAG,IAAI;MAAA,IAAEC,UAAU,uEAAGrZ,gCAAgC;MAChI,IAAI+L,OAAO,GAAG,MAAKwN,kBAAkB,EAAE;MACvC,IAAI,CAAC,MAAK/V,cAAc,EAAE;QACxB,OAAOuI,OAAO;MAChB;MACA,IAAMsC,IAAI,GAAG,MAAKmF,kBAAkB,EAAE;MACtC,IAAInF,IAAI,IAAIA,IAAI,CAACb,IAAI,EAAE;QAAA;QACrB,IAAMgM,gBAAgB,GAAG,MAAK1W,QAAQ,CAACxB,MAAM,IAAI,CAAC;QAClD6X,QAAQ,GAAGA,QAAQ,IAAI,CAAC;QACxB;QACA,IAAMM,iBAAiB,GAAG,MAAKhS,OAAO,CAAC,MAAKkP,IAAI,CAAC,GAAG,MAAKpH,WAAW,EAAE;QACtE,IAAImK,WAAW,GAAG,CAAC;QACnB,IAAMC,aAAa,GAAG,MAAK7R,UAAU,GAAG,MAAK8R,cAAc,EAAE;QAE7D,IAAIH,iBAAiB,IAAIE,aAAa,EAAE;UACtC,IAAIN,UAAU,IAAIrZ,sCAAsC,EAAE;YACxD;YACA0Z,WAAW,GAAGrhB,IAAI,CAACyC,KAAK,CAAC2e,iBAAiB,GAAG,MAAKlK,WAAW,EAAE,CAAC;UAClE,CAAC,MAAM;YACL;YACAmK,WAAW,GAAGrhB,IAAI,CAACyC,KAAK,CAAC2e,iBAAiB,GAAG,MAAKG,cAAc,EAAE,GAAG,MAAKrK,WAAW,EAAE,CAAC;UAC1F;QACF;QACA,IAAMuK,SAAS,GAAGzL,IAAI,CAACb,IAAI,CAAC9V,KAAK,GAAG,MAAK6X,WAAW,EAAE,GAAGiK,gBAAgB;QAEzEL,QAAQ,GAAG9gB,IAAI,CAACK,GAAG;QACjB;QACAygB,QAAQ;QACR;QACAW,SAAS;QACT;QACAH,aAAa,EACbD,WAAW,CACZ;QAED,IAAMK,UAAU,GAAG1hB,IAAI,CAACyC,KAAK,CAACqe,QAAQ,CAAC,GAAG,IAAI;QAC9C,IAAIY,UAAU,IAAI,MAAKvW,cAAc,CAACtG,KAAK,CAAC8c,QAAQ,EAAE;UACpD,MAAKxW,cAAc,CAACtG,KAAK,CAAC8c,QAAQ,GAAGD,UAAU;UAC/ChO,OAAO,GAAG,IAAI;QAChB;QAEAqN,SAAS,GAAG/gB,IAAI,CAACK,GAAG;QAClB;QACAL,IAAI,CAACyC,KAAK,CAACuT,IAAI,CAACb,IAAI,CAAC7V,MAAM,GAAG,MAAK+c,mBAAmB,EAAE,GAAG,GAAG,CAAC,EAC/D,CAAC,iCAAKpR,gBAAgB,2DAArB,uBAAuByD,SAAS,KAAI,CAAC,IAAI,MAAK2N,mBAAmB,EAAE,GAAG,CAAC,EACxErc,IAAI,CAACsP,KAAK,CAACyR,SAAS,IAAI,CAAC,CAAC,CAC3B;QAED,IAAMa,CAAC,GAAG5hB,IAAI,CAACyC,KAAK,CAACse,SAAS,CAAC,GAAG,IAAI;QACtC,IAAI,MAAK5V,cAAc,CAACtG,KAAK,CAACgd,SAAS,IAAID,CAAC,EAAE;UAC5C,MAAKzW,cAAc,CAACtG,KAAK,CAACgd,SAAS,GAAGD,CAAC;UACvC,OAAOlO,OAAO;QAChB;MACF;MACA,OAAOA,OAAO;IAChB,CAAC;IAAA,2FAM0B,UAAC3C,QAA2B,EAAwB;MAC7E;MACA,IAAM+Q,gBAAgB,GAAG/Q,QAAQ,CAACpT,MAAM,CAAC,UAACmB,OAAO,EAAK;QACpD,IAAI,CAACA,OAAO,EAAE;UACZ,OAAO,KAAK;QACd;QACA,IAAIA,OAAO,CAAC2S,IAAI,KAAKpL,4BAA4B,EAAE;UAAA;UACjD,IAAI,CAAC1B,oCAAoC,CAAC7F,OAAO,CAACyG,QAAQ,IAAI,IAAI,EAAE,sBAAAzG,OAAO,CAACyG,QAAQ,sDAAhB,kBAAkBC,KAAK,KAAI,IAAI,EAAE,CAAA1G,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEiH,GAAG,KAAI,IAAI,EAAE,MAAK0E,QAAQ,CAAC,EAAE;YACzI,OAAO,KAAK;UACd;QACF,CAAC,MAAM,IAAI3L,OAAO,CAAC2S,IAAI,KAAKpL,yBAAyB,EAAE;UACrD,IAAI,CAAC1B,iCAAiC,CAAC7F,OAAO,CAAC0G,KAAK,IAAI,IAAI,EAAE1G,OAAO,CAACiH,GAAG,IAAI,IAAI,EAAE,MAAK0E,QAAQ,CAAC,EAAE;YACjG,OAAO,KAAK;UACd;QACF,CAAC,MAAM,IAAI3L,OAAO,CAAC2S,IAAI,KAAKpL,4BAA4B,EAAE;UAAA;UACxD,IAAI,0BAAKoE,QAAQ,oDAAb,gBAAeR,iBAAiB,MAAK,KAAK,EAAE;YAC9C,OAAO,KAAK;UACd;QACF,CAAC,MAAM,IAAInL,OAAO,CAAC2S,IAAI,KAAKpL,uBAAuB,EAAE;UACnD,OAAO,KAAK;QACd;QACA,OAAO,IAAI;MACb,CAAC,CAAC;MACF,OAAOyb,gBAAgB;IACzB,CAAC;IAAA,wFAIuB,UAAC/Q,QAA2B,EAAwD;MAAA,IAAtDtS,GAAkB,uEAAG,IAAI;MAC7E;MACA,IAAMyjB,WAAW,GAAG,SAAdA,WAAW,CAAIzQ,IAAyB,EAAa;QACzD,IAAIA,IAAI,KAAKpL,4BAA4B,EAAE;UACzC,OAAO,CAAC;QACV,CAAC,MAAM,IAAIoL,IAAI,KAAKpL,4BAA4B,EAAE;UAChD,OAAO,CAAC;QACV,CAAC,MAAM,IAAIoL,IAAI,KAAKpL,yBAAyB,EAAE;UAC7C,OAAO,CAAC;QACV;QACA,OAAO,CAAC,CAAC;MACX,CAAC;MAED,IAAM8b,aAAa,GAAG,SAAhBA,aAAa,CAAIC,CAAkB,EAAEC,CAAkB,EAAa;QACxE,IAAIC,KAAK,GAAGJ,WAAW,CAACE,CAAC,CAAC3Q,IAAI,CAAC;QAC/B,IAAI8Q,KAAK,GAAGL,WAAW,CAACG,CAAC,CAAC5Q,IAAI,CAAC;QAC/B,IAAI6Q,KAAK,KAAKC,KAAK,EAAE;UACnB,IAAI9jB,GAAG,KAAK,IAAI,EAAE;YAChB,OAAO,CAAC;UACV;;UAEA;UACA6jB,KAAK,GAAGrkB,yBAAyB,CAACmkB,CAAC,CAAC3jB,GAAG,EAAEA,GAAG,CAAC;UAC7C8jB,KAAK,GAAGtkB,yBAAyB,CAACokB,CAAC,CAAC5jB,GAAG,EAAEA,GAAG,CAAC;UAC7C,IAAI6jB,KAAK,KAAKC,KAAK,EAAE;YACnB,OAAO,CAAC;UACV;UACA,OAAOD,KAAK,GAAGC,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC;QAC/B;QAEA,OAAOD,KAAK,GAAGC,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC;MAC/B,CAAC;MACD,IAAMC,MAAM,GAAG,MAAKC,wBAAwB,CAAC1R,QAAQ,CAAC,CAAC2R,IAAI,CAACP,aAAa,CAAC;MAC1E,IAAIK,MAAM,CAAC9kB,MAAM,GAAG,CAAC,EAAE;QACrB,OAAO8kB,MAAM,CAACA,MAAM,CAAC9kB,MAAM,GAAG,CAAC,CAAC;MAClC;MAEA,OAAO,IAAI;IACb,CAAC;IAAA,mFAIyB,UAACyJ,GAAa,EAAE0J,WAAmB,EAAE8R,SAAwC,EAAwB;MAAA;MAC7H9R,WAAW,GAAG7Q,IAAI,CAACK,GAAG,CAACwQ,WAAW,EAAE,CAAC,CAAC;MACtC,IAAMxL,QAA2B,GAAG,EAAE;MAEtC,IAAI,CAAC8B,GAAG,EAAE;QACR,OAAO9B,QAAQ;MACjB;MAEA,IAAMS,YAAY,GAAGnB,+BAA+B,CAAC,MAAK8F,QAAQ,CAAC;MACnE;MACA,IAAM4T,WAAW,GAAG,MAAKvF,WAAW,CAAC,MAAKwF,IAAI,CAAC;MAC/C,IAAIjf,KAAK,GAAG,CAAC;MACb,IAAM2J,aAAa,sBAAG,MAAKyB,QAAQ,oDAAb,gBAAezB,aAAa;MAClD,IAAIA,aAAa,EAAE;QAAA;QACjB3J,KAAK,GAAGW,IAAI,CAACK,GAAG,CAAC,CAAC2I,aAAa,CAAC3J,KAAK,IAAI,CAAC,IAAI,MAAKya,WAAW,EAAE,CAAC,CAAA9Q,aAAa,aAAbA,aAAa,gDAAbA,aAAa,CAAER,QAAQ,0DAAvB,sBAAyBnJ,KAAK,KAAI,CAAC,IAAI,MAAKya,WAAW,IAAI,CAAC,CAAC,GAAGjJ,WAAW;MAC9I;MACA;MACA,IAAI1J,GAAG,CAAChI,CAAC,IAAI2G,YAAY,GAAG,GAAG,IAAKqB,GAAG,CAACjI,CAAC,IAAImf,WAAW,GAAGhf,KAAK,GAAG,CAAC,IAAI8H,GAAG,CAACjI,CAAC,IAAImf,WAAW,GAAGhf,KAAK,GAAG,CAAE,EAAE;QACzGgG,QAAQ,CAAC7H,IAAI,CAAC;UACZiB,GAAG,EAAE,MAAK6f,IAAI;UACd7M,IAAI,EAAEpL,4BAA4B8D;QACpC,CAAC,CAAoB;MACvB;MACA,IAAMyY,IAAI,GAAG,MAAKnY,QAAQ,CAAC1B,WAAW;MACtC,IAAI5B,GAAG,CAAChI,CAAC,IAAI2G,YAAY,IAAI,MAAK2E,QAAQ,CAACtE,kBAAkB,EAAE;QAC7D,MAAK4O,gBAAgB,CAAC,UAACC,iBAAiB,EAAE6N,CAAC,EAAEC,SAAS,EAAW;UAC/D,IAAM7M,YAAY,GAAGjB,iBAAiB,CAACiB,YAAY;UACnD;UACA,IAAI6M,SAAS,EAAE;YACb,IAAMC,aAAa,GAAG9kB,uBAAuB,CAACkJ,GAAG,CAACjI,CAAC,EAAEiI,GAAG,CAAChI,CAAC,EAAE8W,YAAY,CAACd,IAAI,CAAC;YAC9E,IAAI4N,aAAa,EAAE;cACjB,IAAMhd,GAAG,GAAG;gBACVtH,GAAG,EAAE,MAAKukB,cAAc,CAAC7b,GAAG,CAACjI,CAAC,EAAE0jB,IAAI,CAAC;gBACrCxQ,SAAS,EAAE6D,YAAY,CAAC7L,KAAK,CAACgI,SAAS;gBACvCX,IAAI,EAAEpL,uBAAuB;gBAC7BN,GAAG,EAAEkQ,YAAY,CAAC7L;cACpB,CAAoB;cACpB/E,QAAQ,CAAC7H,IAAI,CAACuI,GAAG,CAAC;YACpB;YACA,IAAIkQ,YAAY,CAACwE,gBAAgB,EAAE;cACjCxE,YAAY,CAACwE,gBAAgB,CAAC3c,OAAO,CAAC,UAAC4c,cAAc,EAAK;gBACxD,IAAI,EAACA,cAAc,aAAdA,cAAc,eAAdA,cAAc,CAAEvF,IAAI,GAAE;kBACzB;gBACF;gBACA,IAAM8N,wBAAwB,GAAGhlB,uBAAuB,CAACkJ,GAAG,CAACjI,CAAC,EAAEiI,GAAG,CAAChI,CAAC,EAAEub,cAAc,CAACvF,IAAI,CAAC;gBAC3F,IAAI8N,wBAAwB,EAAE;kBAC5B,IAAMnO,eAAe,GAAG,CAAA4F,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEV,mBAAmB,CAAC9H,GAAG,CAAC,UAACrQ,CAAC;oBAAA,OAAKA,CAAC,CAACuI,KAAK;kBAAA,EAAC,KAAI,EAAE;kBACrF,IAAM8Y,YAAY,GAAG;oBACnB;oBACAzkB,GAAG,EAAE,MAAKukB,cAAc,CAAC7b,GAAG,CAACjI,CAAC,EAAE0jB,IAAI,CAAC;oBACrCnR,IAAI,EAAEpL,yBAAyB;oBAC/Bb,KAAK,EAAEkV,cAAc,CAAC9V,UAAU;oBAChCmB,GAAG,EAAEkQ,YAAY,CAAC7L,KAAK;oBACvBgI,SAAS,EAAE0C;kBACb,CAAoB;kBAEpB,IAAMqO,OAAO,GAAG,MAAK7L,OAAO,CAACoD,cAAc,CAACta,GAAG,CAAC;kBAChD;kBACA8iB,YAAY,CAACzkB,GAAG,IAAIic,cAAc,CAACta,GAAG,GAAG+iB,OAAO;kBAChD9d,QAAQ,CAAC7H,IAAI,CAAC0lB,YAAY,CAAC;gBAC7B;cACF,CAAC,CAAC;YACJ;UACF;UAEA,IAAME,eAAe,GAAGpO,iBAAiB,CAACG,IAAI;UAC9C,IAAIiO,eAAe,EAAE;YACnB,IAAIC,WAAW,GAAG,KAAK;YACvB,IAAIrO,iBAAiB,CAAChR,KAAK,KAAKjG,0BAA0B,EAAE;cAC1D,IAAMulB,iBAAiB,GAAGrlB,wBAAwB,CAAC;gBAAEiB,CAAC,EAAEiI,GAAG,CAACjI,CAAC;gBAAEC,CAAC,EAAEgI,GAAG,CAAChI,CAAC;gBAAEG,MAAM,EAAEuR,WAAW;gBAAExR,KAAK,EAAEwR;cAAY,CAAC,EAAaA,WAAW,CAAC;cAC3IwS,WAAW,GAAGplB,8BAA8B,CAACqlB,iBAAiB,EAAEF,eAAe,EAAE,IAAI,CAAC;YACxF,CAAC,MAAM;cACL,IAAMI,IAAI,GAAGvlB,yBAAyB,CAACmlB,eAAe,CAAClkB,CAAC,EAAEkkB,eAAe,CAACjkB,CAAC,EAAEgI,GAAG,CAACjI,CAAC,EAAEiI,GAAG,CAAChI,CAAC,CAAC;cAC1FkkB,WAAW,GAAGG,IAAI,IAAIJ,eAAe,CAAC9jB,MAAM,GAAGuR,WAAW;YAC5D;YACA,IAAIwS,WAAW,EAAE;cACfhe,QAAQ,CAAC7H,IAAI,CAAC;gBACZ+H,QAAQ,EAAEyP,iBAAiB,CAAC5K,KAAK;gBACjCgI,SAAS,EAAE,CAAC4C,iBAAiB,CAAC5K,KAAK,CAAC;gBACpC3L,GAAG,EAAEuW,iBAAiB,CAAC5K,KAAK,CAAC3L,GAAG;gBAChCsH,GAAG,EAAEiP,iBAAiB,CAACiB,YAAY,CAAC7L,KAAK;gBACzCqH,IAAI,EAAEpL,4BAA4BsL;cACpC,CAAC,CAAoB;YACvB;UACF;QACF,CAAC,CAAC;MACJ;MAEA,IAAI,CAACgR,SAAS,IAAIA,SAAS,CAACjlB,MAAM,KAAK,CAAC,EAAE;QACxC,OAAO2H,QAAQ;MACjB,CAAC,MAAM;QACL,OAAOA,QAAQ,CAAC1H,MAAM,CAAC,UAACkE,CAAC;UAAA,OAAK8gB,SAAS,IAAIA,SAAS,CAACc,QAAQ,CAAC5hB,CAAC,CAAC4P,IAAI,CAAC;QAAA,EAAC;MACxE;IACF,CAAC;IAAA,gFAKsB,UAACnU,QAAuD,EAAW;MACxF,MAAKomB,EAAE,CAAChc,0BAA0B,EAAEpK,QAAQ,CAAC;IAC/C,CAAC;IAAA,gFAIsB,UAACA,QAAgD,EAAW;MACjF,MAAKomB,EAAE,CAAChc,0BAA0B,EAAEpK,QAAQ,CAAC;IAC/C,CAAC;IAAA,yEAIe,UAACA,QAAgD,EAAW;MAC1E,MAAKomB,EAAE,CAAChc,mBAAmB,EAAEpK,QAAQ,CAAC;IACxC,CAAC;IAAA,iFAIuB,UAACA,QAAgD,EAAW;MAClF,MAAKomB,EAAE,CAAChc,2BAA2B,EAAEpK,QAAQ,CAAC;IAChD,CAAC;IAAA,gFAIsB,UAACA,QAAiD,EAAW;MAClF,MAAKomB,EAAE,CAAChc,0BAA0B,EAAEpK,QAAQ,CAAC;IAC/C,CAAC;IAAA,oFAI0B,UAACA,QAA2D,EAAW;MAChG,MAAKomB,EAAE,CAAChc,8BAA8B,EAAEpK,QAAQ,CAAC;IACnD,CAAC;IAAA,8EAIoB,UAACA,QAAiD,EAAW;MAChF,MAAKomB,EAAE,CAAChc,wBAAwB,EAAEpK,QAAQ,CAAC;IAC7C,CAAC;IAAA,6EAKmB,UAACA,QAAoD,EAAW;MAClF,MAAKomB,EAAE,CAAChc,uBAAuB,EAAEpK,QAAQ,CAAC;IAC5C,CAAC;IAAA,2EAIiB,UAACA,QAAkD,EAAW;MAC9E,MAAKomB,EAAE,CAAChc,qBAAqB,EAAEpK,QAAQ,CAAC;IAC1C,CAAC;IAAA,yEAIe,UAACA,QAAkD,EAAW;MAC5E,MAAKomB,EAAE,CAAChc,mBAAmB,EAAEpK,QAAQ,CAAC;IACxC,CAAC;IAAA,mFAIyB,UAACA,QAAkD,EAAW;MACtF,MAAKomB,EAAE,CAAChc,6BAA6B,EAAEpK,QAAQ,CAAC;IAClD,CAAC;IAAA,mFAKkB,UAACO,IAAkB,EAAE8P,sBAA+B,EAA6D;MAAA;MAAA,IAA3DsW,SAAS,uEAAGvc,qBAAqB;MACxG,IAAMwc,WAAW,GAAG;QAClBrmB,IAAI,EAAEA,IAAI;QACV8P,sBAAsB,EAAEA,sBAAsB;QAC9C8B,UAAU,EAAE,MAAKA,UAAU;QAC3Bf,SAAS,EAAE,MAAKA,SAAS;QACzByV,YAAY,EAAE,iCAAKlZ,gBAAgB,2DAArB,uBAAuBkZ,YAAY,KAAI,CAAC;QACtDnF,WAAW,EAAE,iCAAK/T,gBAAgB,2DAArB,uBAAuB+T,WAAW,KAAI;MACrD,CAAwB;MACxB,gJAAWiF,SAAS,EAAEC,WAAW;MACjC,OAAOA,WAAW;IACpB,CAAC;IAAA,iFAQgB,UAACrmB,IAAkB,EAAE8P,sBAA+B,EAA2D;MAAA,IAAzDsW,SAAS,uEAAGvc,mBAAmB;MACpG,IAAM0c,SAAS,GAAG;QAChBvmB,IAAI,EAAEA;MACR,CAAwB;MACxB,gJAAWomB,SAAS,EAAEG,SAAS;MAC/B,OAAOA,SAAS;IAClB,CAAC;IAAA,uFACsB,UAACtlB,OAAiC,EAAuG;MAAA,IAArG8W,MAA2B,uEAAGjP,oCAAoC;MAC3H,IAAM9I,IAAI,GAAG,IAAI6I,4BAA4B,EAAE;MAC/C7I,IAAI,CAACY,GAAG,GAAGK,OAAO,CAACL,GAAG;MACtBZ,IAAI,CAAC4U,OAAO,GAAG3T,OAAO,CAAC2T,OAAO;MAC9B5U,IAAI,CAACoT,MAAM,GAAGnS,OAAO;MACrBjB,IAAI,CAAC+X,MAAM,GAAGA,MAAM;MACpB,MAAK8J,IAAI,CAAChY,8BAA8B,EAAE7J,IAAI,CAAC;MAC/C,OAAOA,IAAI;IACb,CAAC;IAAA,wFACuB,UAACwmB,SAAgC,EAA+B;MACtF,IAAI,CAACA,SAAS,EAAE;QACd,OAAO,IAAI;MACb;MACA,IAAMxmB,IAAI,GAAG,MAAKymB,iBAAiB,CAACD,SAAS,EAAE,MAAK9S,WAAW,CAAC;MAChE,MAAKmO,IAAI,CAAChY,0BAA0B,EAAE7J,IAAI,CAAC;MAC3C,IAAIA,IAAI,CAACyT,WAAW,EAAE,EAAE;QACtB,MAAKiT,YAAY,CAAC1mB,IAAI,EAAEwmB,SAAS,EAAE,IAAI,CAAC;MAC1C;MACA,OAAOxmB,IAAI;IACb,CAAC;IAAA,yFAMwB,UAACwmB,SAAgC,EAAqD;MAAA,IAAnDG,YAAY,uEAAG,KAAK;MAC9E,IAAI,CAACH,SAAS,IAAI,CAACA,SAAS,CAAC3Q,OAAO,EAAE;QACpC,OAAO,IAAI;MACb;MACA,IAAM7V,IAAI,GAAG,MAAKymB,iBAAiB,CAACD,SAAS,EAAE,MAAK9S,WAAW,CAAC;MAChE,IAAIiT,YAAY,EAAE;QAChB3mB,IAAI,CAACuQ,cAAc,EAAE;MACvB;MACA,MAAKsR,IAAI,CAAChY,2BAA2B,EAAE7J,IAAI,CAAC;MAC5C,IAAIA,IAAI,CAACyT,WAAW,EAAE,EAAE;QACtB,MAAKiT,YAAY,CAAC1mB,IAAI,EAAEwmB,SAAS,EAAE,IAAI,CAAC;MAC1C;MACA,OAAOxmB,IAAI;IACb,CAAC;IAAA,+EACc,UAAC4mB,QAA2B,EAAEzO,IAA2B,EAA4B;MAAA,IAA1B0O,OAAO,uEAAG,KAAK;MACvF,IAAID,QAAQ,CAAC1T,QAAQ,EAAE;QACrB0T,QAAQ,CAAC1T,QAAQ,CAACjT,OAAO,CAAC,UAACgB,OAAO,EAAK;UACrC,IAAM+gB,KAAK,GAAG6E,OAAO,GAAG5lB,OAAO,CAAC4T,UAAU,GAAG5T,OAAO,CAAC2T,OAAO;UAC5D,MAAKkS,eAAe,CAAC7lB,OAAO,EAAE+gB,KAAK,CAAC;QACtC,CAAC,CAAC;MACJ;MACA7J,IAAI,CAACvX,GAAG,GAAGuX,IAAI,CAACvD,OAAO;MACvB;MACAgS,QAAQ,CAACvd,KAAK,GAAGud,QAAQ,CAACG,SAAS;IACrC,CAAC;IAAA,iFACgB,UAACP,SAAgC,EAA+B;MAC/E,IAAI,CAACA,SAAS,EAAE;QACd,OAAO,IAAI;MACb;MACA,IAAMxmB,IAAI,GAAG,MAAKymB,iBAAiB,CAACD,SAAS,EAAE,MAAK9S,WAAW,CAAC;MAChE,MAAKmO,IAAI,CAAoBhY,mBAAmB,EAAE7J,IAAI,CAAC;MACvD,IAAIA,IAAI,CAACyT,WAAW,EAAE,EAAE;QACtB,MAAKiT,YAAY,CAAC1mB,IAAI,EAAEwmB,SAAS,EAAE,KAAK,CAAC;MAC3C;MACA,OAAOxmB,IAAI;IACb,CAAC;IAAA,qFACoB,UAAC2U,KAAU,EAA4B;MAC1D,IAAM3U,IAAI,GAAG,IAAIkJ,qBAAqB,EAAE;MACxClJ,IAAI,CAACmU,QAAQ,GAAGQ,KAAK,CAACR,QAAQ;MAC9BnU,IAAI,CAAC6V,OAAO,GAAGlB,KAAK,CAACkB,OAAO;MAC5B7V,IAAI,CAACwX,IAAI,GAAG7C,KAAK,CAAC6C,IAAI;MACtBxX,IAAI,CAAC0X,IAAI,GAAG/C,KAAK,CAAC+C,IAAI;MACtB,MAAKmK,IAAI,CAAwBhY,uBAAuB,EAAE7J,IAAI,CAAC;MAC/D,OAAOA,IAAI;IACb,CAAC;IAAA,yFACwB,UAAC2U,KAA+B,EAA4B;MACnF,IAAM3U,IAAI,GAAG,IAAIkJ,qBAAqB,EAAE;MACxClJ,IAAI,CAACmU,QAAQ,GAAGQ,KAAK,CAACR,QAAQ;MAC9BnU,IAAI,CAAC6V,OAAO,GAAGlB,KAAK,CAACkB,OAAO;MAC5B,MAAKgM,IAAI,CAAwBhY,uBAAuB,EAAE7J,IAAI,CAAC;MAC/D,OAAOA,IAAI;IACb,CAAC;IAAA,oFACmB,UAACwmB,SAAgC,EAAEnd,KAA+B,EAAwB;MAC5G,IAAM2d,kBAAkB,GAAG,IAAIzd,iBAAiB,EAAE;MAClDyd,kBAAkB,CAAC3d,KAAK,GAAGA,KAAK;MAChC;MACA2d,kBAAkB,CAAC9T,QAAQ,sBAAQsT,SAAS,CAACtT,QAAQ,IAAI,EAAE,CAAE;MAC7D8T,kBAAkB,CAAC5T,MAAM,GAAG,CAAAoT,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAEpT,MAAM,KAAI,IAAI;MACrD,OAAO4T,kBAAkB;IAC3B,CAAC;IAxoFC,MAAKpa,QAAQ,GAAGxM,0BAA0B,CAAC4K,sBAAsB,CAAC;IAClE;IACA,IAAInD,QAAO,IAAI0E,MAAK,EAAE;MACpB,MAAK0a,UAAU,CAACpf,QAAO,EAAE0E,MAAK,CAAC;IACjC;IAAC;EACH;;EAEA;AACF;AACA;AACA;AACA;EAJE;IAAA;IAAA;IAiFA;AACF;AACA;IACE,mBAA2C;MACzC,IAAI,CAAC,IAAI,CAACgB,OAAO,EAAE;QACjB,OAAO,IAAI;MACb;MACA,IAAI,IAAI,CAACQ,IAAI,EAAE;QACb,OAAO,IAAI,CAACA,IAAI;MAClB;MACA,IAAI,CAACA,IAAI,GAAG,IAAI,CAACR,OAAO,CAACC,UAAU,CAAC,IAAI,CAAC;MACzC,OAAO,IAAI,CAACO,IAAI;IAClB;IACA;AACF;AACA;AACA;EAHE;IAAA;IAAA;IA6fA;AACF;AACA;AACA;AACA;AACA;IACE,uBAAc2H,MAAc,EAAExC,QAAoC,EAA8E;MAAA;MAAA,IAA5E6E,MAA2B,uEAAGjP,oCAAoC;MACpI,IAAI,CAACoK,QAAQ,EAAE;QACb,OAAO,CAAC;MACV;MACA,IAAIuE,SAAS,GAAG,KAAK;MACrB,IAAItV,IAAI,CAAC4B,GAAG,CAAC2R,MAAM,CAAC,GAAG,CAAC,EAAE;QACxB;QACA,IAAI8H,MAAM,GAAG;UAAEjb,GAAG,EAAEzB,MAAM,CAAComB,gBAAgB;UAAE1kB,GAAG,EAAE1B,MAAM,CAACqmB;QAAiB,CAAmB;QAC7F;QACA3J,MAAM,GAAGpd,uBAAuB,CAACod,MAAM,EAAE,IAAI,CAAC5Q,QAAQ,CAAC;QACvDsG,QAAQ,CAACjT,OAAO,CAAC,UAAC+D,CAAC,EAAK;UAAA;UACtB,IAAI,CAACA,CAAC,IAAI,CAACA,CAAC,CAAC0D,QAAQ,EAAE;YACrB;UACF;UACA;UACA;UACA,IAAM0f,aAAa,GAAGhnB,uBAAuB,CAACA,uBAAuB,CAAC;YAAEmC,GAAG,EAAEib,MAAM,CAACjb,GAAG;YAAEC,GAAG,EAAEgb,MAAM,CAAChb;UAAI,CAAC,EAAEwB,CAAC,CAAC0D,QAAQ,CAAC,EAAE1D,CAAC,CAACkE,GAAG,IAAI,IAAI,CAAC;UACvI,IAAMmf,qBAAqB,GAAG,yBAAI,CAACza,QAAQ,4CAAb,gBAAe3B,sBAAsB,GAAG,MAAI,CAACwO,OAAO,CAACzV,CAAC,CAAC0D,QAAQ,CAAC9G,GAAG,CAAC,GAAGoD,CAAC,CAAC0D,QAAQ,CAAC9G,GAAG;UACnH,IAAM0mB,WAAW,GAAGD,qBAAqB,GAAG3R,MAAM;UAClD;UACA,IAAI,CAAC0R,aAAa,CAAC7kB,GAAG,IAAI6kB,aAAa,CAAC7kB,GAAG,KAAK,CAAC,KAAKnC,sBAAsB,CAACgnB,aAAa,CAAC7kB,GAAG,CAAC,IAAI+kB,WAAW,GAAGF,aAAa,CAAC7kB,GAAG,EAAE;YAClI;YACAmT,MAAM,GAAGA,MAAM,GAAGtV,yBAAyB,CAACgnB,aAAa,CAAC7kB,GAAG,EAAE+kB,WAAW,CAAC;UAC7E;UACA,IAAI,CAACF,aAAa,CAAC5kB,GAAG,IAAI4kB,aAAa,CAAC5kB,GAAG,KAAK,CAAC,KAAKpC,sBAAsB,CAACgnB,aAAa,CAAC5kB,GAAG,CAAC,IAAI8kB,WAAW,GAAGF,aAAa,CAAC5kB,GAAG,EAAE;YAClI;YACAkT,MAAM,GAAGA,MAAM,GAAGtV,yBAAyB,CAACgnB,aAAa,CAAC5kB,GAAG,EAAE8kB,WAAW,CAAC;UAC7E;QACF,CAAC,CAAC;QAEF,IAAInlB,IAAI,CAAC4B,GAAG,CAAC2R,MAAM,CAAC,GAAG,CAAC,EAAE;UACxB;UACAxC,QAAQ,CAACjT,OAAO,CAAC,UAACgB,OAAO,EAAK;YAC5B,IAAI,EAACA,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEyG,QAAQ,GAAE;cACtB;YACF;YACA,IAAMkN,OAAO,GAAG3T,OAAO,CAACyG,QAAQ,CAAC9G,GAAG;YACpC,IAAMohB,KAAK,GAAGpN,OAAO,GAAGc,MAAM;YAC9B,IAAM6R,QAAQ,GAAG,MAAI,CAACT,eAAe,CAAC7lB,OAAO,EAAE+gB,KAAK,EAAEjK,MAAM,CAAC;YAC7DN,SAAS,GAAG8P,QAAQ,KAAK3S,OAAO;UAClC,CAAC,CAAC;QACJ;QAEA,IAAI6C,SAAS,EAAE;UACb,OAAO/B,MAAM;QACf;MACF;MAEA,OAAO,CAAC;IACV;;IAEA;AACF;AACA;EAFE;IAAA;IAAA;IAoUA;AACF;AACA;IACE,0BAAiBjW,QAAyF,EAAQ;MAAA;MAChH,IAAI,CAACA,QAAQ,EAAE;QACb;MACF;MACA,IAAI,CAAC,IAAI,CAACgN,MAAM,EAAE;QAChB;MACF;MAEA,IAAM+a,eAAe,GAAG,IAAI,CAAClK,kBAAkB,EAAE;MACjD,IAAI,CAACkK,eAAe,EAAE;QACpB;MACF;MAEAA,eAAe,aAAfA,eAAe,gDAAfA,eAAe,CAAEtL,cAAc,0DAA/B,sBAAiCjc,OAAO,CAAC,UAACmY,YAAY,EAAK;QACzD,IAAI,CAACA,YAAY,EAAE;UACjB;QACF;QAEA,IAAIqP,OAAO,GAAG,IAAI;QAClBrP,YAAY,CAAC+D,mBAAmB,CAAClc,OAAO,CAAC,UAACkX,iBAAiB,EAAEuQ,aAAa,EAAK;UAC7E,IAAIvQ,iBAAiB,EAAE;YACrB1X,QAAQ,CAAC0X,iBAAiB,EAAEuQ,aAAa,EAAED,OAAO,CAAC;UACrD;UAEAA,OAAO,GAAG,KAAK;QACjB,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ;;IAEA;AACF;AACA;AACA;EAHE;IAAA;IAAA,OAIA,wBAAevN,MAAyB,EAAE1D,SAAkC,EAAqB;MAC/F,IAAMmR,SAAS,GAAG,IAAI,CAAClX,YAAY,CAACyJ,MAAM,EAAE1D,SAAS,CAAC;MACtD,IAAMlN,GAAG,GAAGqe,SAAS,CAACre,GAAG;MACzBqe,SAAS,CAACC,WAAW,GAAG,IAAI,CAACzC,cAAc,CAAC7b,GAAG,CAACjI,CAAC,EAAE,KAAK,CAAC;MACzDsmB,SAAS,CAAClO,OAAO,GAAG,IAAI,CAAC0L,cAAc,CAAC7b,GAAG,CAACjI,CAAC,EAAE,IAAI,CAAC;MACpDsmB,SAAS,CAAC/mB,GAAG,GAAG+mB,SAAS,CAACC,WAAW;MACrC,IAAI,IAAI,CAAChb,QAAQ,IAAI,IAAI,CAACA,QAAQ,CAAC1B,WAAW,EAAE;QAC9Cyc,SAAS,CAAC/mB,GAAG,GAAG+mB,SAAS,CAAClO,OAAO;MACnC;MAEA,IAAI,IAAI,CAACpH,kBAAkB,EAAE;QAAA;QAC3B,IAAI,CAAC,IAAI,CAAC8C,cAAc,EAAE;UACxB,IAAI,CAACA,cAAc,GAAG,CAAC,CAAY;QACrC;QACA,IAAM0S,QAAQ,GAAG,IAAI,CAACxV,kBAAkB,CAAC/I,GAAG;QAC5C;QACA,IAAMjI,CAAC,GAAGc,IAAI,CAACyC,KAAK,CAACijB,QAAQ,CAACxmB,CAAC,IAAI,CAAC,8BAAI,CAACuR,eAAe,0DAApB,sBAAsBvR,CAAC,KAAI,CAAC,IAAI,IAAI,CAACuQ,UAAU,CAAC,CAAC;QACrF,IAAMtQ,CAAC,GAAGa,IAAI,CAACyC,KAAK,CAACijB,QAAQ,CAACvmB,CAAC,IAAI,CAAC,+BAAI,CAACsR,eAAe,2DAApB,uBAAsBtR,CAAC,KAAI,CAAC,IAAI,IAAI,CAACuP,SAAS,CAAC,CAAC;QACpF,IAAI,CAACsE,cAAc,CAAC9T,CAAC,GAAGc,IAAI,CAACI,GAAG,CAAClB,CAAC,EAAEiI,GAAG,CAACjI,CAAC,CAAC;QAC1C,IAAI,CAAC8T,cAAc,CAAC7T,CAAC,GAAGa,IAAI,CAACI,GAAG,CAACjB,CAAC,EAAEgI,GAAG,CAAChI,CAAC,CAAC;QAC1C,IAAI,CAAC6T,cAAc,CAAC3T,KAAK,GAAGW,IAAI,CAACK,GAAG,CAACnB,CAAC,EAAEiI,GAAG,CAACjI,CAAC,CAAC,GAAG,IAAI,CAAC8T,cAAc,CAAC9T,CAAC;QACtE,IAAI,CAAC8T,cAAc,CAAC1T,MAAM,GAAGU,IAAI,CAACK,GAAG,CAAClB,CAAC,EAAEgI,GAAG,CAAChI,CAAC,CAAC,GAAG,IAAI,CAAC6T,cAAc,CAAC7T,CAAC;QACvE;QACA,IAAI,IAAI,CAACuR,aAAa,EAAE;UACtB,IAAI,CAACA,aAAa,GAAG,IAAI,CAACsC,cAAc,CAAC1T,MAAM,IAAI,IAAI,CAAC2O,OAAO,CAAC9F,cAAc,IAAI,IAAI,CAAC6K,cAAc,CAAC3T,KAAK,IAAI,IAAI,CAAC4O,OAAO,CAAC9F,cAAc;QAC5I;MACF;MAEA,OAAOqd,SAAS;IAClB;;IAEA;AACF;AACA;EAFE;IAAA;IAAA,OAGA,0BAAyB;MAAA;MACvB,OAAO,+BAAI,CAACva,gBAAgB,2DAArB,uBAAuBU,WAAW,KAAI,CAAC;IAChD;IACA;AACF;AACA;EAFE;IAAA;IAAA,OAGA,2BAA0B;MAAA;MACxB,OAAO,+BAAI,CAACV,gBAAgB,2DAArB,uBAAuB2J,YAAY,KAAI,CAAC;IACjD;EAAC;IAAA;IAAA,OACD,6BAA8C;MAAA,IAA5B4P,YAAY,uEAAG,KAAK;MACpC,IAAI,IAAI,CAAChT,KAAK,EAAE;QACd,IAAI,CAACmU,sBAAsB,CAAC,IAAI,CAACnU,KAAK,EAAEgT,YAAY,CAAC;MACvD;MACA,IAAI,CAACtU,kBAAkB,GAAG,IAAI;MAC9B,IAAI,CAACsB,KAAK,GAAG,IAAI;MACjB,IAAI,CAAC9D,6BAA6B,GAAG,KAAK;MAC1C,IAAI,CAACmE,oBAAoB,GAAG,KAAK;MACjC,IAAI,CAACC,wBAAwB,GAAG,KAAK;MACrC,IAAI,CAACkB,cAAc,GAAG,IAAI;MAC1B,IAAI,CAAC3B,aAAa,GAAG,IAAI;MACzB,IAAI,CAACZ,eAAe,GAAG,IAAI;MAC3B,IAAI,CAAC3C,aAAa,GAAG,KAAK;MAC1B,IAAI,CAAC4C,aAAa,GAAG,KAAK;MAC1B,IAAI,CAAC7D,YAAY,EAAE;IACrB;;IAEA;AACF;AACA;EAFE;IAAA;IAAA,OAGA,+BAA+B;MAC7B;MACA,IAAI,IAAI,CAACwE,aAAa,IAAIhB,IAAI,CAACC,GAAG,EAAE,GAAG,IAAI,CAACe,aAAa,GAAG,IAAI,CAACpD,OAAO,CAAClG,gBAAgB,EAAE;QACzF,OAAO,IAAI;MACb;MAEA,OAAO,KAAK;IACd;;IAEA;AACF;AACA;EAFE;IAAA;IAAA;IA0BA;AACF;AACA;IACE,oCAAoC;MAClC;MACA,IAAI,IAAI,CAACkP,sBAAsB,IAAI5G,IAAI,CAACC,GAAG,EAAE,GAAG,IAAI,CAAC2G,sBAAsB,IAAI,IAAI,CAAChJ,OAAO,CAAC5F,iBAAiB,EAAE;QAC7G,OAAO,IAAI;MACb;MAEA,IAAI,CAAC4O,sBAAsB,GAAG5G,IAAI,CAACC,GAAG,EAAE;MACxC,OAAO,KAAK;IACd;;IAEA;AACF;AACA;EAFE;IAAA;IAAA,OAGA,sBAAasV,KAAe,EAAEze,GAAa,EAAE0e,cAA+B,EAAQ;MAClF,IAAI,CAACD,KAAK,IAAI,CAACze,GAAG,IAAI,CAAC,IAAI,CAAC8D,gBAAgB,EAAE;QAC5C;MACF;MACA,IAAI/L,CAAC,GAAG,CAAC;MACT,IAAIC,CAAC,GAAG,CAAC;MACT,IAAI0mB,cAAc,EAAE;QAClB3mB,CAAC,GAAG2mB,cAAc,CAAC3mB,CAAC;QACpBC,CAAC,GAAG0mB,cAAc,CAAC1mB,CAAC;MACtB;MACA,IAAM2mB,OAAO,GAAG9lB,IAAI,CAACsP,KAAK,CAACsW,KAAK,CAAC1mB,CAAC,GAAGiI,GAAG,CAACjI,CAAC,CAAC;MAC3C,IAAM6mB,OAAO,GAAG7mB,CAAC,GAAG4mB,OAAO;MAE3B,IAAIA,OAAO,GAAG,CAAC,EAAE;QACf,IAAI,CAACvW,gBAAgB,CAACwW,OAAO,GAAG,IAAI,CAACjX,kBAAkB,EAAE,CAAC;MAC5D;MAEA,IAAIgX,OAAO,GAAG,CAAC,IAAIC,OAAO,GAAG,IAAI,CAACjX,kBAAkB,EAAE,IAAI,IAAI,CAAC7D,gBAAgB,CAAC+T,WAAW,GAAG,CAAC,EAAE;QAC/F,IAAI,CAACvP,UAAU,GAAG,IAAI,CAACxE,gBAAgB,CAAC+T,WAAW;MACrD,CAAC,MAAM;QACL,IAAI,CAACvP,UAAU,GAAGsW,OAAO;MAC3B;MACA,IAAI,CAACrX,SAAS,GAAG1O,IAAI,CAACsP,KAAK,CAACnQ,CAAC,GAAGymB,KAAK,CAACzmB,CAAC,GAAGgI,GAAG,CAAChI,CAAC,CAAC;IAClD;EAAC;IAAA;IAAA,OAED,uCAA8BgI,GAAa,EAAW;MACpD,IAAI,CAAC,IAAI,CAAC8D,gBAAgB,EAAE;QAC1B,OAAO,KAAK;MACd;MACA,IAAM/L,CAAC,GAAGiI,GAAG,CAACjI,CAAC;MACf,IAAMC,CAAC,GAAGgI,GAAG,CAAChI,CAAC;MACf,IAAImW,SAAS,GAAG,KAAK;MACrB,IAAI0Q,MAAM,GAAG,CAAC;MACd,IAAIC,MAAM,GAAG,CAAC;MACd;MACA,IAAM5K,MAAM,GAAG,IAAI,CAACpN,OAAO,CAAC/F,sBAAsB;MAClD,IAAMge,MAAM,GAAGhnB,CAAC,IAAImc,MAAM;MAC1B,IAAM8K,OAAO,GAAGjnB,CAAC,IAAI,IAAI,CAAC4P,kBAAkB,EAAE,GAAGuM,MAAM;MACvD,IAAM+K,KAAK,GAAGjnB,CAAC,IAAIkc,MAAM;MACzB,IAAMgL,QAAQ,GAAGlnB,CAAC,IAAI,IAAI,CAACkd,mBAAmB,EAAE,GAAGhB,MAAM;MACzD,IAAIyF,QAAQ,GAAG,IAAI;MACnB,IAAIC,SAAS,GAAG,IAAI;MACpB,IAAImF,MAAM,IAAIC,OAAO,IAAIC,KAAK,IAAIC,QAAQ,EAAE;QAC1C;QACA,IAAI,CAACC,aAAa,EAAE;QAEpB,IAAI,IAAI,CAACC,wBAAwB,EAAE,EAAE;UACnC,OAAO,KAAK;QACd;QAEA,IAAMC,qBAAqB,GAAG9nB,KAAK,CAAC,IAAI,CAACuP,OAAO,CAACnG,iBAAiB,CAAC,GAAG,CAAC,GAAG,IAAI,CAACmG,OAAO,CAACnG,iBAAiB;QACxG,IAAIoe,MAAM,EAAE;UACV;UACAF,MAAM,GAAG,CAAC/nB,yBAAyB,CAACiB,CAAC,EAAEmc,MAAM,CAAC,GAAGmL,qBAAqB;QACxE,CAAC,MAAM,IAAIL,OAAO,EAAE;UAClB;UACAH,MAAM,GAAG/nB,yBAAyB,CAACiB,CAAC,EAAE,IAAI,CAAC4P,kBAAkB,EAAE,GAAGuM,MAAM,CAAC,GAAGmL,qBAAqB;UACjG1F,QAAQ,GAAG,IAAI,CAACrR,UAAU,GAAG,IAAI,CAACX,kBAAkB,EAAE,GAAGkX,MAAM;QACjE;QAEA,IAAII,KAAK,EAAE;UACT;UACAH,MAAM,GAAI,CAAChoB,yBAAyB,CAACiB,CAAC,EAAEmc,MAAM,CAAC,GAAGmL,qBAAqB,GAAI,CAAC;QAC9E,CAAC,MAAM,IAAIH,QAAQ,EAAE;UACnB;UACAJ,MAAM,GAAIhoB,yBAAyB,CAACiB,CAAC,EAAE,IAAI,CAACmd,mBAAmB,EAAE,GAAGhB,MAAM,CAAC,GAAGmL,qBAAqB,GAAI,CAAC;UACxGzF,SAAS,GAAG,IAAI,CAAC9V,gBAAgB,CAACyD,SAAS,GAAG,IAAI,CAAC2N,mBAAmB,EAAE;QAC1E;MACF,CAAC,MAAM;QACL,IAAI,CAACxP,YAAY,EAAE;MACrB;MAEA,IAAIiU,QAAQ,IAAIC,SAAS,EAAE;QACzB,IAAI,CAACxR,gBAAgB,CAACuR,QAAQ,EAAEC,SAAS,EAAEpZ,sCAAsC,CAAC;MACpF;MAEA,IAAI3H,IAAI,CAAC4B,GAAG,CAACokB,MAAM,CAAC,GAAG,CAAC,EAAE;QACxB,IAAI,CAACvW,UAAU,GAAG,IAAI,CAACxE,gBAAgB,CAACwE,UAAU,GAAGuW,MAAM;QAC3D1Q,SAAS,GAAG,IAAI;MAClB;MAEA,IAAItV,IAAI,CAAC4B,GAAG,CAACqkB,MAAM,CAAC,GAAG,CAAC,EAAE;QACxB,IAAI,CAACvX,SAAS,GAAG,IAAI,CAACzD,gBAAgB,CAACyD,SAAS,GAAGuX,MAAM;QACzD3Q,SAAS,GAAG,IAAI;MAClB;MAEA,OAAOA,SAAS;IAClB;;IAEA;AACF;AACA;EAFE;IAAA;IAAA,OAGA,iBAAe6B,EAAU,EAAU;MACjC,IAAI,CAAC,IAAI,CAAC1M,QAAQ,EAAE;QAClB,OAAO0M,EAAE;MACX;MACA,IAAI/W,GAAG,GAAG,IAAI,CAACqK,QAAQ,CAACrK,GAAG,IAAI,CAAC;MAChC,IAAI,CAACnC,sBAAsB,CAACmC,GAAG,CAAC,EAAE;QAChCA,GAAG,GAAG,CAAC;MACT;MACA,IAAM6I,MAAM,GAAG,IAAI,CAACwB,QAAQ,CAACxB,MAAM,IAAI,CAAC;MACxC,IAAIA,MAAM,KAAK,CAAC,EAAE;QAChB,OAAOkO,EAAE;MACX;MACA/W,GAAG,IAAI,IAAI,CAAC6O,YAAY,IAAI,CAAC;MAC7B,IAAMoI,KAAK,GAAG,CAAC,IAAI,CAAC5M,QAAQ,CAACvB,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC+F,YAAY,IAAI,CAAC;MACnE,IAAMxQ,GAAG,GAAG2B,GAAG,GAAI+W,EAAE,GAAGlO,MAAM,GAAIoO,KAAK;MACvC,OAAO5Y,GAAG;IACZ;;IAEA;AACF;AACA;EAFE;IAAA;IAAA;IA4BA;AACF;AACA;IACE,iBAAeA,GAAW,EAAU;MAClC;MACA,IAAI,IAAI,CAACgM,QAAQ,IAAI,IAAI,CAACA,QAAQ,CAAC1B,WAAW,IAAI,IAAI,CAAC0B,QAAQ,CAACrB,QAAQ,EAAE;QACxE,IAAMqd,KAAK,GAAG,IAAI,CAAChc,QAAQ,CAACrB,QAAQ;QACpC,IAAM3J,IAAI,GAAGhB,GAAG,GAAGgoB,KAAK;QACxB,IAAMC,QAAQ,GAAG1mB,IAAI,CAACsP,KAAK,CAAC7P,IAAI,CAAC;QACjC,IAAMknB,QAAQ,GAAG3mB,IAAI,CAAC4B,GAAG,CAAC,IAAI,CAAC6I,QAAQ,CAACrK,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,CAACqK,QAAQ,CAACrB,QAAQ;QAC1E,IAAMwd,SAAS,GAAG3oB,kBAAkB,CAAC,IAAI,CAACwM,QAAQ,CAACrK,GAAG,IAAI,CAAC,CAAC,IAAIumB,QAAQ,GAAG3mB,IAAI,CAACyC,KAAK,CAACkkB,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAClc,QAAQ,CAACrB,QAAQ;QACzH3K,GAAG,GAAGuB,IAAI,CAACsP,KAAK,CAACsX,SAAS,CAAC,GAAG5mB,IAAI,CAACsP,KAAK,CAACoX,QAAQ,GAAGD,KAAK,CAAC;MAC5D;MAEAhoB,GAAG,GAAGR,0BAA0B,CAACQ,GAAG,EAAE,IAAI,CAACgM,QAAQ,CAACrK,GAAG,EAAE,IAAI,CAACqK,QAAQ,CAACpK,GAAG,CAAC;MAC3E,OAAO5B,GAAG;IACZ;;IAEA;AACF;AACA;EAFE;IAAA;IAAA;IAs0BA;AACF;AACA;IACE,eAAgC;MAAA;MAC9B,OAAO,+BAAI,CAACwM,gBAAgB,2DAArB,uBAAuBwE,UAAU,KAAI,CAAC;IAC/C,CAAC;IAAA,KACD,aAAsBtP,KAAa,EAAE;MACnC,IAAI,IAAI,CAAC8K,gBAAgB,IAAI,IAAI,CAACA,gBAAgB,CAACwE,UAAU,KAAKtP,KAAK,EAAE;QACvE,IAAI,CAACyN,uBAAuB,GAAG,IAAI;QACnC,IAAI,CAAC3C,gBAAgB,CAACwE,UAAU,GAAGtP,KAAK;MAC1C;IACF;EAAC;IAAA;IAAA,KACD,eAA+B;MAAA;MAC7B,OAAO,+BAAI,CAAC8K,gBAAgB,2DAArB,uBAAuByD,SAAS,KAAI,CAAC;IAC9C,CAAC;IAAA,KAED,aAAqBvO,KAAa,EAAE;MAClC,IAAI,IAAI,CAAC8K,gBAAgB,IAAI,IAAI,CAACA,gBAAgB,CAACyD,SAAS,KAAKvO,KAAK,EAAE;QACtE,IAAI,CAACyN,uBAAuB,GAAG,IAAI;QACnC,IAAI,CAAC3C,gBAAgB,CAACyD,SAAS,GAAGvO,KAAK;MACzC;IACF;;IAEA;AACF;AACA;AACA;EAHE;EAAA;AAAA,EAluE4B/C,qBAAqB;;ACxDnD;;AAE2B;AACa;AACE;AAC1C;AACwC;AACD;AACF;AACK;;AAE1C;AAC2C;AACa;AACL;AACH;AAEL;AACL;AACE;;AAExC;AAC2C;AACU;AACJ;AACX;AACI;AACO;AACH;;AAE9C;AACoD;AACG;AACL;AACH;;AAE/C;AAC4D;AACJ;AACH;AACF;AACD;AACD;;AAEjD;AAC8C;AACE;AACH;AACD;AACD;AACF;AACG;AACE;AACP;AACvC;AACyD;AACG;AACD;AACM;AACP","sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./src/timelineEventsEmitter.ts","webpack:///./src/enums/timelineKeyframeShape.ts","webpack:///./src/utils/timelineUtils.ts","webpack:///./src/settings/defaults/defaultGroupStyle.ts","webpack:///./src/settings/defaults/defaultTimelineKeyframeStyle.ts","webpack:///./src/settings/defaults/defaultTimelineRowStyle.ts","webpack:///./src/utils/timelineStyleUtils.ts","webpack:///./src/enums/timelineElementType.ts","webpack:///./src/utils/timelineDraggableData.ts","webpack:///./src/utils/events/timelineBaseEvent.ts","webpack:///./src/utils/events/timelineKeyframeChangedEvent.ts","webpack:///./src/enums/timelineEventSource.ts","webpack:///./src/utils/events/timelineTimeChangedEvent.ts","webpack:///./src/enums/timelineSelectionEventSource.ts","webpack:///./src/utils/events/timelineSelectedEvent.ts","webpack:///./src/utils/events/timelineClickEvent.ts","webpack:///./src/utils/events/timelineDragEvent.ts","webpack:///./src/enums/timelineInteractionMode.ts","webpack:///./src/enums/timelineCursorType.ts","webpack:///./src/enums/timelineCapShape.ts","webpack:///./src/enums/timelineSelectionMode.ts","webpack:///./src/enums/timelineSelectionType.ts","webpack:///./src/enums/timelineEvents.ts","webpack:///./src/enums/timelineScrollSource.ts","webpack:///./src/settings/defaults/defaultTimelineConsts.ts","webpack:///./src/settings/defaults/defaultTimelineStyle.ts","webpack:///./src/settings/defaults/defaultTimelineOptions.ts","webpack:///./src/timeline.ts","webpack:///./src/animation-timeline.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"timelineModule\"] = factory();\n\telse\n\t\troot[\"timelineModule\"] = factory();\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* eslint-disable  @typescript-eslint/no-explicit-any */\r\ninterface TimelineEvent {\r\n  topic: string;\r\n  callback: (args: any) => void;\r\n}\r\n\r\n/**\r\n * Timeline events emitter.\r\n */\r\nexport class TimelineEventsEmitter {\r\n  /**\r\n   * Active events subscriptions.\r\n   */\r\n  _subscriptions: TimelineEvent[] = [];\r\n\r\n  /**\r\n   * Subscribe event.\r\n   * @param topic event name.\r\n   * @param callback callback to be added.\r\n   */\r\n  on<T>(topic: string, callback: (args: T) => void): boolean {\r\n    if (!callback) {\r\n      return false;\r\n    }\r\n\r\n    this._subscriptions.push({\r\n      topic: topic,\r\n      callback: callback,\r\n    } as TimelineEvent);\r\n    return true;\r\n  }\r\n  /**\r\n   * Remove an event from the subscriptions list.\r\n   */\r\n  off<T>(topic: string, callback: (args: T) => void): boolean {\r\n    const before = this._subscriptions.length;\r\n    this._subscriptions = this._subscriptions.filter((event) => {\r\n      return event && event.callback != callback && event.topic != topic;\r\n    });\r\n    return before !== this._subscriptions.length;\r\n  }\r\n\r\n  /**\r\n   * Unsubscribe all\r\n   */\r\n  offAll(): void {\r\n    // Remove all callbacks from array.\r\n    this._subscriptions.length = 0;\r\n  }\r\n\r\n  /**\r\n   * Emit event.\r\n   * @param topic Event name.\r\n   * @param args Event arguments.\r\n   */\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  emit<T>(topic: string, args: T): void {\r\n    this._subscriptions.forEach((event) => {\r\n      if (event?.topic === topic && event?.callback) {\r\n        event.callback(args);\r\n      }\r\n    });\r\n  }\r\n}\r\n","export enum TimelineKeyframeShape {\r\n  None = 'none',\r\n  Rhomb = 'rhomb',\r\n  Circle = 'circle',\r\n  Rect = 'rect',\r\n}\r\n","import { TimelineRanged } from '../models/timelineRanged';\r\nimport { TimelineOptions } from '../settings/timelineOptions';\r\n\r\nconst denominators = [1, 2, 5, 10];\r\nexport class TimelineUtils {\r\n  static drawLine(ctx: CanvasRenderingContext2D, x1: number, y1: number, x2: number, y2: number): void {\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n  }\r\n  /**\r\n   * Check is valid number.\r\n   */\r\n  static isNumber(val?: number | null): boolean {\r\n    if (typeof val === 'number' && (val || val === 0) && !isNaN(val) && Number.isFinite(val)) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n  static deleteElement<T>(array: Array<T>, element: T): Array<T> {\r\n    const index: number = array.indexOf(element);\r\n    if (index !== -1) {\r\n      return array.splice(index, 1);\r\n    }\r\n    return array;\r\n  }\r\n\r\n  /**\r\n   * Check rectangle overlap x,y\r\n   */\r\n  static isOverlap(x: number, y: number, rectangle: DOMRect): boolean {\r\n    if (!rectangle) {\r\n      return false;\r\n    }\r\n\r\n    if (rectangle.x <= x && rectangle.x + rectangle.width >= x && rectangle.y <= y && rectangle.y + rectangle.height >= y) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n  /**\r\n   * Find beautiful step for the header line gauge.\r\n   */\r\n  static findGoodStep(originalStep: number, divisionCheck = 0): number {\r\n    if (originalStep <= 0 || isNaN(originalStep) || !Number.isFinite(originalStep)) {\r\n      return originalStep;\r\n    }\r\n    let step = originalStep;\r\n    let lastDistance = null;\r\n    const pow = TimelineUtils.getPowArgument(originalStep);\r\n    for (let i = 0; i < denominators.length; i++) {\r\n      const denominator = denominators[i];\r\n      const calculatedStep = denominator * Math.pow(10, pow);\r\n      if (divisionCheck && divisionCheck % calculatedStep != 0) {\r\n        continue;\r\n      }\r\n      const distance = TimelineUtils.getDistance(originalStep, calculatedStep);\r\n\r\n      if (distance == 0 || (distance <= 0.1 && pow > 0)) {\r\n        lastDistance = distance;\r\n        step = calculatedStep;\r\n        break;\r\n      } else if (!lastDistance || lastDistance > distance) {\r\n        lastDistance = distance;\r\n        step = calculatedStep;\r\n      }\r\n    }\r\n\r\n    return step;\r\n  }\r\n  /**\r\n   * Keep value in min, max bounds.\r\n   */\r\n  static keepInBounds(value: number, min: number | null | undefined = null, max: number | null | undefined = null): number {\r\n    if (TimelineUtils.isNumber(value)) {\r\n      if (TimelineUtils.isNumber(min) && (min || min === 0)) {\r\n        value = Math.max(value, min);\r\n      }\r\n      if (TimelineUtils.isNumber(max) && (max || max === 0)) {\r\n        value = Math.min(value, max);\r\n      }\r\n    }\r\n\r\n    return value;\r\n  }\r\n  static setMinMax(to: TimelineRanged, from: TimelineRanged | null, shrink = false): TimelineRanged {\r\n    if (!from || !to) {\r\n      return to;\r\n    }\r\n    const fromMin = from ? from.min : Number.NaN;\r\n    const toMin = to.min;\r\n    const isFromMinNumber = (fromMin || fromMin === 0) && TimelineUtils.isNumber(fromMin);\r\n    const isToMinNumber = (toMin || toMin === 0) && TimelineUtils.isNumber(toMin);\r\n    // get absolute min and max bounds:\r\n    if (isFromMinNumber && isToMinNumber) {\r\n      to.min = shrink ? Math.min(fromMin, toMin) : Math.max(fromMin, toMin);\r\n    } else if (isFromMinNumber) {\r\n      to.min = fromMin;\r\n    }\r\n    const fromMax = from ? from.max : Number.NaN;\r\n    const toMax = to.max;\r\n    const isFromMaxNumber = (fromMax || fromMax === 0) && TimelineUtils.isNumber(fromMax);\r\n    const isToMaxNumber = (toMax || toMax === 0) && TimelineUtils.isNumber(toMax);\r\n    if (isFromMaxNumber && isToMaxNumber) {\r\n      to.max = shrink ? Math.max(fromMax, toMax) : Math.min(fromMax, toMax);\r\n    } else if (isFromMaxNumber) {\r\n      to.max = fromMax;\r\n    }\r\n\r\n    return to;\r\n  }\r\n  static shrinkSelf(rect: DOMRect, value: number): DOMRect {\r\n    if (!rect) {\r\n      return rect;\r\n    }\r\n    rect.x -= value;\r\n    rect.y -= value;\r\n    rect.width += value;\r\n    rect.height += value;\r\n    return rect;\r\n  }\r\n  /**\r\n   * Check whether rectangle intersects another rectangle\r\n   */\r\n  static isRectIntersects(rect: DOMRect, rect2: DOMRect, touch = false): boolean {\r\n    if (!rect || !rect2) {\r\n      console.log('Rectangles cannot be empty');\r\n      return false;\r\n    }\r\n    const right = rect2.x + rect2.width;\r\n    const bottom = rect2.y + rect2.height;\r\n    if (touch) {\r\n      if (\r\n        // Left\r\n        rect.x <= right &&\r\n        // Right\r\n        rect2.x <= rect.x + rect.width &&\r\n        // Top\r\n        rect.y <= bottom &&\r\n        // Bottom\r\n        rect2.y <= rect.y + rect.height\r\n      ) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    } else {\r\n      if (\r\n        // Left\r\n        rect.x < right &&\r\n        // Right\r\n        rect2.x < rect.x + rect.width &&\r\n        // Top\r\n        rect.y < bottom &&\r\n        // Bottom\r\n        rect2.y < rect.y + rect.height\r\n      ) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  static getDistance(x1: number, y1: number, x2?: number, y2?: number): number {\r\n    if (x2 != undefined && y2 != undefined) {\r\n      return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\r\n    } else {\r\n      return Math.abs(x1 - y1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get sign of the number. 1 or -1.\r\n   */\r\n  static sign(p: number): number {\r\n    return p >= 0 ? 1 : -1;\r\n  }\r\n\r\n  /**\r\n   * Clear browser text selection.\r\n   */\r\n  static clearBrowserSelection(): void {\r\n    if (!window) {\r\n      return;\r\n    }\r\n    if (window.getSelection) {\r\n      const selection = window.getSelection();\r\n      if (selection) {\r\n        selection.removeAllRanges();\r\n      }\r\n    } else {\r\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n      const doc: any = window.document;\r\n      if (doc.selection) {\r\n        doc.selection.empty();\r\n      }\r\n    }\r\n  }\r\n  static getPowArgument(toCheck: number): number {\r\n    if (!toCheck || toCheck === 0 || !isFinite(toCheck)) {\r\n      return 1;\r\n    }\r\n    // some optimization for numbers:\r\n    if (toCheck >= 10 && toCheck < 100) {\r\n      return 1;\r\n    } else if (toCheck >= 100 && toCheck < 1000) {\r\n      return 2;\r\n    } else if (toCheck >= 1000 && toCheck < 10000) {\r\n      return 3;\r\n    }\r\n\r\n    toCheck = Math.abs(toCheck);\r\n    let category = 0;\r\n    const s = this.sign(toCheck);\r\n    if (toCheck > 1) {\r\n      while (toCheck >= 1) {\r\n        toCheck = Math.floor(toCheck / 10.0);\r\n        category++;\r\n      }\r\n\r\n      return s * category - 1;\r\n    } else if (toCheck > 0.0) {\r\n      // Get number of zeros before the number.\r\n      const zerosCount = Math.floor(Math.log(toCheck) / Math.log(10) + 1) - 1;\r\n      return zerosCount;\r\n    } else {\r\n      return 1;\r\n    }\r\n  }\r\n\r\n  static deepClone = <T>(previousOptions: T): T => {\r\n    return JSON.parse(JSON.stringify(previousOptions)) as T;\r\n  };\r\n\r\n  static cloneOptions = (previousOptions: TimelineOptions): TimelineOptions => {\r\n    const clonedValue = JSON.parse(\r\n      JSON.stringify(previousOptions, (key, value) => {\r\n        // No need to clone HTML element passed as ID.\r\n        return key === 'id' ? undefined : value;\r\n      }),\r\n    );\r\n    clonedValue.id = previousOptions.id;\r\n    return clonedValue;\r\n  };\r\n  /**\r\n   * Merge options. New keys will be added.\r\n   */\r\n  static mergeOptions(previousOptions: TimelineOptions, newOptions: TimelineOptions): TimelineOptions {\r\n    newOptions = newOptions || ({} as TimelineOptions);\r\n    // Apply incoming options to default. (override default)\r\n    // Deep clone default options:\r\n    const toArg = TimelineUtils.cloneOptions(previousOptions);\r\n    // Merge options with the default.\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const mergeOptionsDeep = (to: any, from: any): void => {\r\n      if (!to || !from) {\r\n        return;\r\n      }\r\n      // eslint-disable-next-line prefer-const\r\n      for (let key in from) {\r\n        if (Object.prototype.hasOwnProperty.call(from, key)) {\r\n          if (from[key] !== undefined) {\r\n            if (typeof from[key] === 'object') {\r\n              if (key === 'id') {\r\n                if (from[key] && from[key] !== to[key]) {\r\n                  to[key] = from[key];\r\n                }\r\n              } else {\r\n                if (!to[key]) {\r\n                  to[key] = from[key];\r\n                } else {\r\n                  mergeOptionsDeep(to[key], from[key]);\r\n                }\r\n              }\r\n            } else {\r\n              to[key] = from[key];\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    mergeOptionsDeep(toArg, newOptions);\r\n    return toArg;\r\n  }\r\n}\r\n","import { TimelineGroupStyle } from '../styles/timelineGroupStyle';\r\nexport const defaultRowHeight = 24;\r\nconst margin = 4;\r\nexport const defaultGroupStyle = {\r\n  height: 'auto',\r\n  marginTop: margin,\r\n  /**\r\n   * Default group fill color.\r\n   */\r\n  fillColor: '#0B71E6',\r\n} as TimelineGroupStyle;\r\n","import { TimelineKeyframeShape } from '../../enums/timelineKeyframeShape';\r\nimport { TimelineKeyframeStyle } from '../styles/timelineKeyframeStyle';\r\n\r\nexport const defaultTimelineKeyframeStyle = {\r\n  /**\r\n   * keyframe fill color.\r\n   */\r\n  fillColor: '#FFFFFF',\r\n  shape: TimelineKeyframeShape.Rhomb,\r\n  /**\r\n   * Selected keyframe fill color.\r\n   */\r\n  selectedFillColor: '#FFEE32',\r\n  strokeColor: 'black',\r\n  selectedStrokeColor: 'black',\r\n  strokeThickness: 0.2,\r\n  height: 'auto',\r\n  width: 'auto',\r\n} as TimelineKeyframeStyle;\r\n","import { TimelineRowStyle } from '../styles/timelineRowStyle';\r\nimport { defaultGroupStyle, defaultRowHeight } from './defaultGroupStyle';\r\nimport { defaultTimelineKeyframeStyle } from './defaultTimelineKeyframeStyle';\r\n\r\nexport const defaultTimelineRowStyle = {\r\n  /**\r\n   * Row height in pixels.\r\n   */\r\n  height: defaultRowHeight,\r\n  marginBottom: 2,\r\n  fillColor: '#252526',\r\n  /**\r\n   * Style for the all keyframes in a current row.\r\n   * Individual keyframe can have own style.\r\n   */\r\n  keyframesStyle: defaultTimelineKeyframeStyle,\r\n  /**\r\n   * Style of the groups.\r\n   */\r\n  groupsStyle: defaultGroupStyle,\r\n} as TimelineRowStyle;\r\n","/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport { TimelineOptions } from '../settings/timelineOptions';\r\nimport { TimelineRowStyle } from '../settings/styles/timelineRowStyle';\r\nimport { TimelineKeyframeShape } from '../enums/timelineKeyframeShape';\r\nimport { TimelineUtils } from './timelineUtils';\r\nimport { TimelineGroupStyle } from '../settings/styles/timelineGroupStyle';\r\nimport { TimelineKeyframe } from '../models/timelineKeyframe';\r\n\r\nimport { TimelineGroup } from '../models/timelineGroup';\r\nimport { TimelineRow } from '../models/timelineRow';\r\nimport { defaultGroupStyle } from '../settings/defaults/defaultGroupStyle';\r\nimport { defaultTimelineKeyframeStyle } from '../settings/defaults/defaultTimelineKeyframeStyle';\r\nimport { defaultTimelineRowStyle } from '../settings/defaults/defaultTimelineRowStyle';\r\n\r\nconst undefinedConst = typeof undefined;\r\n\r\n// TODO: create merged style for each element instead of getting per property.\r\nexport class TimelineStyleUtils {\r\n  static getGroup(groupModel: TimelineGroup | string | null | undefined): TimelineGroup | null {\r\n    const style = groupModel;\r\n    if (style && typeof style === 'string') {\r\n      return null;\r\n    }\r\n    return (style || null) as TimelineGroup;\r\n  }\r\n  static getGroupStyle(groupModel: TimelineGroup | string | null | undefined): TimelineGroupStyle | null {\r\n    return TimelineStyleUtils.getGroup(groupModel)?.style || null;\r\n  }\r\n  static getFirstSet<T>(defaultValue: T, ...params: Array<T | undefined | null>): T {\r\n    return TimelineStyleUtils.getValue(defaultValue, false, ...params);\r\n  }\r\n  /**\r\n   * Get first value set or default.\r\n   * @param defaultValue default value in a case when no value is set.\r\n   * @param returnFalseIfAnyFalse - find first negative bool and return false.\r\n   * @param params collection of values to check.\r\n   * @returns value.\r\n   */\r\n  static getValue<T>(defaultValue: T, returnFalseIfAnyFalse = false, ...params: Array<T | undefined | null>): T {\r\n    const valuesFound: T[] = [];\r\n    let found = false;\r\n    params.forEach((value: T | undefined | null) => {\r\n      if (found) {\r\n        return;\r\n      }\r\n      if (typeof value === undefinedConst) {\r\n        return;\r\n      } else if (typeof value === 'number') {\r\n        if (!TimelineUtils.isNumber(value)) {\r\n          return;\r\n        }\r\n      } else if (typeof value === 'boolean') {\r\n        valuesFound.push(value as T);\r\n        // No need to search for other values. First false is turning off current bool functionality.\r\n        if (returnFalseIfAnyFalse && value === false) {\r\n          found = true;\r\n        }\r\n        return;\r\n      } else if (!value) {\r\n        return;\r\n      }\r\n      valuesFound.push(value as T);\r\n    });\r\n    const toReturn = valuesFound && valuesFound.length > 0 ? valuesFound[0] : defaultValue;\r\n    if (found) {\r\n      return false as T;\r\n    }\r\n    return TimelineStyleUtils.getValueOrDefault(toReturn, defaultValue) as T;\r\n  }\r\n\r\n  static getValueOrDefault<T>(value: T, defaultValue: T): T | undefined {\r\n    if (typeof value === undefinedConst) {\r\n      return defaultValue;\r\n    } else if (typeof value == 'boolean') {\r\n      // variable is a boolean\r\n      return value as T;\r\n    } else if (typeof value == 'number') {\r\n      // variable is a boolean\r\n      if (value || value === 0) {\r\n        return value as T;\r\n      } else {\r\n        return defaultValue;\r\n      }\r\n    }\r\n    return value || defaultValue;\r\n  }\r\n  static keyframeWidth(\r\n    keyframe: TimelineKeyframe | null | undefined,\r\n    group: TimelineGroup | string | null | undefined,\r\n    rowStyle: TimelineRowStyle | null | undefined,\r\n    options: TimelineOptions | null | undefined,\r\n  ): number | string {\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultTimelineKeyframeStyle.width || '',\r\n      keyframe?.style?.width,\r\n      // exact style\r\n      TimelineStyleUtils.getGroupStyle(group)?.keyframesStyle?.width,\r\n      rowStyle?.keyframesStyle?.width,\r\n      rowStyle?.groupsStyle?.keyframesStyle?.width,\r\n      // global styles\r\n      options?.rowsStyle?.groupsStyle?.keyframesStyle?.width,\r\n      // default keyframe style\r\n      options?.rowsStyle?.keyframesStyle?.width,\r\n    );\r\n  }\r\n  static keyframeHeight(\r\n    keyframe: TimelineKeyframe | null | undefined,\r\n    group: TimelineGroup | string | null | undefined,\r\n    rowStyle: TimelineRowStyle | null | undefined,\r\n    options: TimelineOptions | null | undefined,\r\n  ): number | string {\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultTimelineKeyframeStyle.height || '',\r\n      keyframe?.style?.height,\r\n      // exact style\r\n      TimelineStyleUtils.getGroupStyle(group)?.keyframesStyle?.height,\r\n      rowStyle?.keyframesStyle?.height,\r\n      rowStyle?.groupsStyle?.keyframesStyle?.height,\r\n      // global styles\r\n      options?.rowsStyle?.groupsStyle?.keyframesStyle?.height,\r\n      // default keyframe style\r\n      options?.rowsStyle?.keyframesStyle?.height,\r\n    );\r\n  }\r\n  static keyframeShape(keyframe: TimelineKeyframe | null, group: TimelineGroup | string | null | undefined, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): TimelineKeyframeShape {\r\n    const defaultValue = defaultTimelineKeyframeStyle.shape || TimelineKeyframeShape.Rhomb;\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      keyframe?.style?.shape,\r\n      // style set by keyframe group\r\n      TimelineStyleUtils.getGroupStyle(group)?.keyframesStyle?.shape,\r\n      // style from the keyframe group\r\n      rowStyle?.groupsStyle?.keyframesStyle?.shape,\r\n      // style set by keyframe style\r\n      rowStyle?.keyframesStyle?.shape,\r\n      // style set by keyframe group style, applied when group is set\r\n      group ? options?.rowsStyle?.groupsStyle?.keyframesStyle?.shape : undefined,\r\n      // Style set by global options\r\n      options?.rowsStyle?.keyframesStyle?.shape,\r\n    );\r\n  }\r\n  static keyframeFillColor(keyframe: TimelineKeyframe | null, group: TimelineGroup | string | null | undefined, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\r\n    const defaultValue = defaultTimelineKeyframeStyle.fillColor || '';\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      keyframe?.style?.fillColor,\r\n      // style set by keyframe group\r\n      TimelineStyleUtils.getGroupStyle(group)?.keyframesStyle?.fillColor,\r\n      // style from the keyframe group\r\n      rowStyle?.groupsStyle?.keyframesStyle?.fillColor,\r\n      // style set by keyframe style\r\n      rowStyle?.keyframesStyle?.fillColor,\r\n      // style set by keyframe group style, applied when group is set\r\n      group ? options?.rowsStyle?.groupsStyle?.keyframesStyle?.fillColor : undefined,\r\n      // Style set by global options\r\n      options?.rowsStyle?.keyframesStyle?.fillColor,\r\n    );\r\n  }\r\n  static keyframeSelectedFillColor(keyframe: TimelineKeyframe | null, group: TimelineGroup | string | null | undefined, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\r\n    const defaultValue = defaultTimelineKeyframeStyle.selectedFillColor || '';\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      keyframe?.style?.selectedFillColor,\r\n      // style set by keyframe group\r\n      TimelineStyleUtils.getGroupStyle(group)?.keyframesStyle?.selectedFillColor,\r\n      // style from the keyframe group\r\n      rowStyle?.groupsStyle?.keyframesStyle?.selectedFillColor,\r\n      // style set by keyframe style\r\n      rowStyle?.keyframesStyle?.selectedFillColor,\r\n      // style set by keyframe group style, applied when group is set\r\n      group ? options?.rowsStyle?.groupsStyle?.keyframesStyle?.selectedFillColor : undefined,\r\n      // Style set by global options\r\n      options?.rowsStyle?.keyframesStyle?.selectedFillColor,\r\n    );\r\n  }\r\n\r\n  static keyframeStrokeThickness(keyframe: TimelineKeyframe | null, group: TimelineGroup | string | null | undefined, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): number {\r\n    const defaultValue = defaultTimelineKeyframeStyle.strokeThickness || 0;\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      keyframe?.style?.strokeThickness,\r\n      // style set by keyframe group\r\n      TimelineStyleUtils.getGroupStyle(group)?.keyframesStyle?.strokeThickness,\r\n      // style from the keyframe group\r\n      rowStyle?.groupsStyle?.keyframesStyle?.strokeThickness,\r\n      // style set by keyframe style\r\n      rowStyle?.keyframesStyle?.strokeThickness,\r\n      // style set by keyframe group style, applied when group is set\r\n      group ? options?.rowsStyle?.groupsStyle?.keyframesStyle?.strokeThickness : undefined,\r\n      // Style set by global options\r\n      options?.rowsStyle?.keyframesStyle?.strokeThickness,\r\n    );\r\n  }\r\n\r\n  static keyframeStrokeColor(keyframe: TimelineKeyframe | null, group: TimelineGroup | string | null | undefined, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\r\n    const defaultValue = defaultTimelineKeyframeStyle.strokeColor || '';\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      keyframe?.style?.strokeColor,\r\n      // style set by keyframe group\r\n      TimelineStyleUtils.getGroupStyle(group)?.keyframesStyle?.strokeColor,\r\n      // style from the keyframe group\r\n      rowStyle?.groupsStyle?.keyframesStyle?.strokeColor,\r\n      // style set by keyframe style\r\n      rowStyle?.keyframesStyle?.strokeColor,\r\n      // style set by keyframe group style, applied when group is set\r\n      group ? options?.rowsStyle?.groupsStyle?.keyframesStyle?.strokeColor : undefined,\r\n      // Style set by global options\r\n      options?.rowsStyle?.keyframesStyle?.strokeColor,\r\n    );\r\n  }\r\n  static keyframeSelectedStrokeColor(keyframe: TimelineKeyframe | null, group: TimelineGroup | string | null, rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\r\n    const defaultValue = defaultTimelineKeyframeStyle.selectedStrokeColor || '';\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      keyframe?.style?.selectedStrokeColor,\r\n      // style set by keyframe group\r\n      TimelineStyleUtils.getGroupStyle(group)?.keyframesStyle?.selectedStrokeColor,\r\n      // style from the keyframe group\r\n      rowStyle?.groupsStyle?.keyframesStyle?.selectedStrokeColor,\r\n      // style set by keyframe style\r\n      rowStyle?.keyframesStyle?.selectedStrokeColor,\r\n      // style set by keyframe group style, applied when group is set\r\n      group ? options?.rowsStyle?.groupsStyle?.keyframesStyle?.selectedStrokeColor : undefined,\r\n      // Style set by global options\r\n      options?.rowsStyle?.keyframesStyle?.selectedStrokeColor,\r\n    );\r\n  }\r\n\r\n  static groupHeight(options: TimelineOptions | null | undefined, group: TimelineGroup | string | null | undefined, rowStyle: TimelineRowStyle | null | undefined): number | string {\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultGroupStyle.height || 'auto',\r\n      // exact group style\r\n      TimelineStyleUtils.getGroupStyle(group)?.height,\r\n      // Row row style\r\n      rowStyle?.groupsStyle?.height,\r\n      // global styles\r\n      options?.rowsStyle?.groupsStyle?.height,\r\n    );\r\n  }\r\n\r\n  static groupMarginTop(options: TimelineOptions | null | undefined, group: TimelineGroup | string | null | undefined, rowStyle: TimelineRowStyle | null | undefined): number | string {\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultGroupStyle.marginTop || 'auto',\r\n      // exact style\r\n      TimelineStyleUtils.getGroupStyle(group)?.marginTop,\r\n      // Row row style\r\n      rowStyle?.groupsStyle?.marginTop,\r\n      // global styles\r\n      options?.rowsStyle?.groupsStyle?.marginTop,\r\n    );\r\n  }\r\n\r\n  static groupFillColor(options: TimelineOptions | null | undefined, group: TimelineGroup | string | null | undefined, rowStyle: TimelineRowStyle | null | undefined): string {\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultGroupStyle.fillColor || '',\r\n      // exact style\r\n      TimelineStyleUtils.getGroupStyle(group)?.fillColor,\r\n      // Row row style\r\n      rowStyle?.groupsStyle?.fillColor,\r\n      // global styles\r\n      options?.rowsStyle?.groupsStyle?.fillColor,\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get current row height from styles\r\n   */\r\n  static getRowHeight(rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): number {\r\n    const defaultValue = defaultTimelineRowStyle.height || 0;\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      rowStyle?.height,\r\n      // Style set by global options\r\n      options?.rowsStyle?.height,\r\n    );\r\n  }\r\n  static getRowMarginBottom(rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): number {\r\n    const defaultValue = defaultTimelineRowStyle.marginBottom || 0;\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      rowStyle?.marginBottom,\r\n      // Style set by global options\r\n      options?.rowsStyle?.marginBottom,\r\n    );\r\n  }\r\n\r\n  static getRowFillColor(rowStyle: TimelineRowStyle | null, options: TimelineOptions | null): string {\r\n    const defaultValue = defaultTimelineRowStyle.fillColor || '';\r\n    return TimelineStyleUtils.getFirstSet(\r\n      // default value\r\n      defaultValue,\r\n      // exact style\r\n      rowStyle?.fillColor,\r\n      // Style set by global options\r\n      options?.rowsStyle?.fillColor,\r\n    );\r\n  }\r\n\r\n  static headerHeight(options: TimelineOptions | null, defaultRowHeight = 30): number {\r\n    return options?.headerHeight || defaultRowHeight;\r\n  }\r\n  static keyframeDraggable(keyframe: TimelineKeyframe | null, group: TimelineGroup | string | null, row: TimelineRow | null, options: TimelineOptions | null, defaultValue = true): boolean {\r\n    const findFirstNegativeBool = true;\r\n    const boolResult = TimelineStyleUtils.getValue<boolean>(\r\n      defaultValue,\r\n      findFirstNegativeBool,\r\n      // Keyframe settings\r\n      keyframe?.draggable,\r\n      // Group settings\r\n      TimelineStyleUtils.getGroup(group)?.keyframesDraggable,\r\n      // Row settings\r\n      row?.keyframesDraggable,\r\n      // Start from global settings first.\r\n      options?.keyframesDraggable,\r\n    );\r\n    return boolResult;\r\n  }\r\n\r\n  static groupDraggable(group: TimelineGroup | string | null | undefined, row: TimelineRow | null, options: TimelineOptions): boolean {\r\n    const findFirstNegativeBool = true;\r\n    const boolResult = TimelineStyleUtils.getValue<boolean>(\r\n      true,\r\n      findFirstNegativeBool,\r\n      // Group settings\r\n      TimelineStyleUtils.getGroup(group)?.draggable,\r\n      // Row settings\r\n      row?.groupsDraggable,\r\n      // Start from global settings first.\r\n      options?.groupsDraggable,\r\n    );\r\n    return boolResult;\r\n  }\r\n}\r\n","/**\r\n * Internal element type.\r\n */\r\nexport enum TimelineElementType {\r\n  /**\r\n   * Timeline\r\n   */\r\n  Timeline = 'timeline',\r\n  /**\r\n   * Keyframes\r\n   */\r\n  Keyframe = 'keyframe',\r\n  /**\r\n   * Keyframes connected and presenting one group.\r\n   */\r\n  Group = 'group',\r\n  /**\r\n   * Timeline row.\r\n   */\r\n  Row = 'row',\r\n  None = 'none',\r\n}\r\n","import { TimelineElementType } from '../enums/timelineElementType';\r\nimport { TimelineElementDragState } from './timelineElementDragState';\r\n\r\n/**\r\n * Information about current drag state.\r\n */\r\nexport class TimelineDraggableData {\r\n  /**\r\n   * Whether position was changed.\r\n   */\r\n  changed = false;\r\n  /**\r\n   * Drag initial click target.\r\n   */\r\n  target!: TimelineElementDragState;\r\n  /**\r\n   * Elements to be dragged.\r\n   * Can be multiple elements, but drag will be started with target.\r\n   */\r\n  elements!: TimelineElementDragState[];\r\n  /**\r\n   * Dragging type.\r\n   */\r\n  type: TimelineElementType = TimelineElementType.None;\r\n  /**\r\n   * Prev value.\r\n   */\r\n  val!: number;\r\n  /**\r\n   * Prev value.\r\n   */\r\n  prevVal!: number;\r\n}\r\n","/**\r\n * Timeline base preventable event.\r\n */\r\nexport class TimelineBaseEvent {\r\n  private _prevented = false;\r\n  /**\r\n   * Prevent default click logic.\r\n   */\r\n  preventDefault(): void {\r\n    this._prevented = true;\r\n  }\r\n\r\n  isPrevented(): boolean {\r\n    return this._prevented;\r\n  }\r\n}\r\n","import { TimelineBaseEvent } from './timelineBaseEvent';\r\nimport { TimelineElement } from '../timelineElement';\r\nimport { TimelineEventSource } from '../../enums/timelineEventSource';\r\n\r\nexport class TimelineKeyframeChangedEvent extends TimelineBaseEvent {\r\n  /**\r\n   * Value to be used.\r\n   */\r\n  val!: number;\r\n  /**\r\n   * Previous value.\r\n   */\r\n  prevVal!: number;\r\n  /**\r\n   * Target element\r\n   */\r\n  target!: TimelineElement;\r\n  /**\r\n   * Event source.\r\n   */\r\n  source!: TimelineEventSource;\r\n}\r\n","export enum TimelineEventSource {\r\n  /**\r\n   * Changed by user interaction events.\r\n   */\r\n  User = 'user',\r\n  /**\r\n   * Changed programmatically.\r\n   */\r\n  Programmatically = 'programmatically',\r\n  SetTimeMethod = 'setTimeMethod',\r\n}\r\n","import { TimelineBaseEvent } from './timelineBaseEvent';\r\nimport { TimelineEventSource } from '../../enums/timelineEventSource';\r\n\r\nexport class TimelineTimeChangedEvent extends TimelineBaseEvent {\r\n  /**\r\n   * New value to be set if not prevented.\r\n   */\r\n  val = 0;\r\n  /**\r\n   * previous value, that actually set at the moment.\r\n   */\r\n  prevVal = 0;\r\n  /**\r\n   * Source of the change.\r\n   */\r\n  source: TimelineEventSource = TimelineEventSource.User;\r\n}\r\n","/**\r\n * Timeline selection event type.\r\n */\r\nexport enum TimelineSelectionEventSource {\r\n  /**\r\n   * Keyframe selection is performed.\r\n   */\r\n  Keyframes = 'keyframes',\r\n}\r\n","import { TimelineSelectionEventSource } from '../../enums/timelineSelectionEventSource';\r\nimport { TimelineKeyframe } from '../../models/timelineKeyframe';\r\nimport { TimelineGroup } from '../../models/timelineGroup';\r\n\r\n\r\nexport class TimelineSelectedEvent {\r\n  /**\r\n   * Selected Keyframes list.\r\n   */\r\n  selected: TimelineKeyframe[] = [];\r\n  /**\r\n   * Changed selection.\r\n   */\r\n  changed: TimelineKeyframe[] = [];\r\n  /**\r\n   * Selection mode.\r\n   */\r\n  mode: TimelineSelectionEventSource = TimelineSelectionEventSource.Keyframes;\r\n  drag: TimelineGroup[] = [];\r\n}\r\n","import { TimelineElement } from '../timelineElement';\r\nimport { TimelinePoint } from '../timelinePoint';\r\nimport { TimelineBaseEvent } from './timelineBaseEvent';\r\n\r\nexport class TimelineClickEvent extends TimelineBaseEvent {\r\n  args: MouseEvent | TouchEvent | null = null;\r\n  /**\r\n   * Clicked screen position.\r\n   */\r\n  get pos(): DOMPoint | null {\r\n    return this.point?.pos || null;\r\n  }\r\n  get val(): number {\r\n    if (this.point) {\r\n      return this.point.val;\r\n    }\r\n    return NaN;\r\n  }\r\n  /**\r\n   * All elements located under current mouse activity.\r\n   */\r\n  elements: TimelineElement[] = [];\r\n  /**\r\n   * Element that selected as target under the click.\r\n   */\r\n  target: TimelineElement | null = null;\r\n  /**\r\n   * Timeline current active drag position.\r\n   */\r\n  point: TimelinePoint | null = null;\r\n}\r\n","import { TimelinePoint } from '../timelinePoint';\r\nimport { TimelineBaseEvent } from './timelineBaseEvent';\r\nimport { TimelineElementDragState } from '../timelineElementDragState';\r\n\r\nexport class TimelineDragEvent extends TimelineBaseEvent {\r\n  args: MouseEvent | TouchEvent | null = null;\r\n  get pos(): DOMPoint | null {\r\n    return this.point?.pos || null;\r\n  }\r\n  /**\r\n   * Elements to be dragged as a group.\r\n   */\r\n  elements: TimelineElementDragState[] | null = null;\r\n  /**\r\n   * Target element\r\n   */\r\n  target: TimelineElementDragState | null = null;\r\n  /**\r\n   * Timeline current active drag position.\r\n   */\r\n  point: TimelinePoint | null = null;\r\n  /**\r\n   * Timeline previous drag position.\r\n   */\r\n  prevPoint: TimelinePoint | null = null;\r\n}\r\n","export enum TimelineInteractionMode {\r\n  /**\r\n   * Keyframe selection tool selecting single or group of keyframes.\r\n   */\r\n  Selection = 'selection',\r\n  /**\r\n   * Pan tool with the possibility to select keyframes.\r\n   */\r\n  Pan = 'pan',\r\n  /**\r\n   * Allow only pan without any keyframes interaction.\r\n   * Timeline still can be moved and controlled by option 'timelineDraggable'.\r\n   */\r\n  NonInteractivePan = 'nonInteractivePan',\r\n  /**\r\n   * Zoom tool.\r\n   */\r\n  Zoom = 'zoom',\r\n\r\n  /**\r\n   * No iteraction, except moving a timeline.\r\n   * Timeline still can be moved and controlled by option 'timelineDraggable'.\r\n   */\r\n  None = 'none',\r\n}\r\n","export enum TimelineCursorType {\r\n  Alias = 'alias',\r\n  AllScroll = 'all-scroll',\r\n  Auto = 'auto',\r\n  Cell = 'cell',\r\n  ContextMenu = 'context-menu',\r\n  ColResize = 'col-resize',\r\n  Copy = 'copy',\r\n  Crosshair = 'crosshair',\r\n  Default = 'default',\r\n  EResize = 'e-resize',\r\n  EWResize = 'ew-resize',\r\n  Grab = 'grab',\r\n  Grabbing = 'grabbing',\r\n  Help = 'help',\r\n  Move = 'move',\r\n  NResize = 'n-resize',\r\n  NEResize = 'ne-resize',\r\n  NESWResize = 'nesw-resize',\r\n  NSResize = 'ns-resize',\r\n  NWResize = 'nw-resize',\r\n  NWSEResize = 'nwse-resize',\r\n  NoDrop = 'no-drop',\r\n  None = 'none',\r\n  NotAllowed = 'not-allowed',\r\n  Pointer = 'pointer',\r\n  Progress = 'progress',\r\n  RowResize = 'row-resize',\r\n  SResize = 's-resize',\r\n  SEResize = 'se-resize',\r\n  SWResize = 'sw-resize',\r\n  Text = 'text',\r\n  WResize = 'w-resize',\r\n  Wait = 'wait',\r\n  ZoomIn = 'zoom-in',\r\n  ZoomOut = 'zoom-out',\r\n}\r\n","export enum TimelineCapShape {\r\n  None = 'none',\r\n  Triangle = 'triangle',\r\n  Rect = 'rect',\r\n}\r\n","/**\r\n * Timeline selection mode.\r\n */\r\nexport enum TimelineSelectionMode {\r\n  /**\r\n   * Select new items. deselect changed.\r\n   */\r\n  Normal = 'normal',\r\n  /**\r\n   * Append current selection.\r\n   */\r\n  Append = 'append',\r\n  /**\r\n   * Revert selection of a specified nodes.\r\n   */\r\n  Revert = 'revert',\r\n}\r\n","/**\r\n * Timeline selection type.\r\n */\r\nexport enum TimelineSelectionType {\r\n\r\n    keyframe = 'keyframe',\r\n\r\n    group = 'group',\r\n  \r\n  }\r\n  ","/**\r\n * Event names of the component.\r\n */\r\nexport enum TimelineEvents {\r\n  Selected = 'selected',\r\n  TimeChanged = 'timechanged',\r\n  KeyframeChanged = 'keyframeChanged',\r\n  DragStarted = 'dragStarted',\r\n  Drag = 'drag',\r\n  DragFinished = 'dragFinished',\r\n  Scroll = 'scroll',\r\n  ScrollFinished = 'scrollFinished',\r\n  DoubleClick = 'doubleClick',\r\n  MouseDown = 'mouseDown',\r\n  Zoom='zoom'\r\n}\r\n","export enum TimelineScrollSource {\r\n  DefaultMode = 'none',\r\n  ZoomMode = 'zoom',\r\n  ScrollBySelection = 'scrollBySelection',\r\n}\r\n","import { TimelineConsts } from '../timelineConsts';\r\n\r\nexport const defaultTimelineConsts: TimelineConsts = {\r\n  /**\r\n   * Private. Auto pan speed.\r\n   */\r\n  autoPanSpeed: 50,\r\n  /**\r\n   * Private. scroll speed when mouse drag is used (from 0 to 1)\r\n   */\r\n  scrollByDragSpeed: 0.12,\r\n  /**\r\n   * Private. Determine whether item was clicked.\r\n   */\r\n  clickDetectionMs: 120,\r\n  /**\r\n   * Private. Timeout to detect double click.\r\n   */\r\n  doubleClickTimeoutMs: 400,\r\n  /**\r\n   * Private. Time in ms used to refresh scrollbars when pan is finished.\r\n   */\r\n  scrollFinishedTimeoutMs: 500,\r\n  /**\r\n   * Private. Auto pan padding\r\n   */\r\n  autoPanByScrollPadding: 10,\r\n  /**\r\n   * Private. Click threshold\r\n   */\r\n  clickThreshold: 3,\r\n  /**\r\n   * Private. Private.Click min radius for the elements detection.\r\n   */\r\n  clickDetectionMinRadius: 2,\r\n  /**\r\n   * Private. Skip some auto pan/scroll actions if they are executed more rapid than this value.\r\n   */\r\n  autoPanSpeedLimit: 10,\r\n  /**\r\n   * Private. Default auto size for the group. It's percents.\r\n   */\r\n  defaultGroupHeight: 0.7,\r\n} as TimelineConsts;\r\n","import { TimelineCapShape } from '../../enums/timelineCapShape';\r\nimport { TimelineCursorType } from '../../enums/timelineCursorType';\r\nimport { TimelineStyle } from '../styles/timelineStyle';\r\n\r\nexport const defaultTimelineStyle = {\r\n  width: 2,\r\n  marginTop: 15,\r\n  marginBottom: 0,\r\n  strokeColor: '#FFFFFF',\r\n  fillColor: '#FFFFFF',\r\n  capStyle: {\r\n    width: 4,\r\n    height: 10,\r\n    /**\r\n     * Draw timeline rectangular cap.\r\n     */\r\n    capType: TimelineCapShape.Rect,\r\n    strokeColor: '#FFFFFF',\r\n    fillColor: '#FFFFFF',\r\n  },\r\n  cursor: TimelineCursorType.EWResize,\r\n} as TimelineStyle;\r\n","import { TimelineOptions } from '../timelineOptions';\r\nimport { defaultGroupStyle } from './defaultGroupStyle';\r\nimport { defaultTimelineKeyframeStyle } from './defaultTimelineKeyframeStyle';\r\nimport { defaultTimelineRowStyle } from './defaultTimelineRowStyle';\r\nimport { defaultTimelineStyle } from './defaultTimelineStyle';\r\n\r\nexport const defaultTimelineOptions = {\r\n  /**\r\n   *  Snap all selected keyframes as a bundle during the drag.\r\n   */\r\n  snapAllKeyframesOnMove: false,\r\n\r\n  /**\r\n   * Check whether snapping is enabled.\r\n   */\r\n  snapEnabled: true,\r\n\r\n  /**\r\n   * Timeline style.\r\n   */\r\n  timelineStyle: defaultTimelineStyle,\r\n  /**\r\n   * approximate step for the timeline in pixels for 1 second\r\n   */\r\n  stepPx: 120,\r\n  /**\r\n   * Number of units that should fit into one stepPx. (1 second by a default)\r\n   */\r\n  stepVal: 1000,\r\n  stepSmallPx: 30,\r\n  /**\r\n   * Snap step in units. from 0 to stepVal\r\n   */\r\n  snapStep: 200,\r\n  /**\r\n   * additional left margin in pixels to start the line gauge from.\r\n   */\r\n  leftMargin: 25,\r\n  headerFillColor: '#101011',\r\n  fillColor: '#101011',\r\n\r\n  labelsColor: '#D5D5D5',\r\n  /**\r\n   * Header gauge tick color.\r\n   */\r\n  tickColor: '#D5D5D5',\r\n  /**\r\n   * Selection rectangle color.\r\n   */\r\n  selectionColor: 'White',\r\n\r\n  /**\r\n   * Default rows style.\r\n   * Can be overridden by setting style individually for each row.\r\n   */\r\n  rowsStyle: defaultTimelineRowStyle,\r\n\r\n  /**\r\n   * Style for the all keyframes in a current row.\r\n   * Individual keyframe can have own style.\r\n   */\r\n  keyframesStyle: defaultTimelineKeyframeStyle,\r\n  /**\r\n   * Style of the groups.\r\n   */\r\n  groupsStyle: defaultGroupStyle,\r\n  /**\r\n   * Header height in pixels\r\n   */\r\n  headerHeight: 30,\r\n  font: '11px sans-serif',\r\n  /**\r\n   * Default zoom level = 1. where screen pixels are equals to the corresponding stepVal stepPx.\r\n   */\r\n  zoom: 1,\r\n  /**\r\n   * Default zoom speed.\r\n   */\r\n  zoomSpeed: 0.1,\r\n  /**\r\n   * Max zoom value.\r\n   */\r\n  zoomMin: 0.1,\r\n  /**\r\n   * Min zoom value.\r\n   */\r\n  zoomMax: 8,\r\n  /**\r\n   * Set this to true in a MAC OS environment: The Meta key will be used instead of the Ctrl key.\r\n   */\r\n  controlKeyIsMetaKey: false,\r\n  /**\r\n   * Access the scroll container via this class for e.g. scroll bar styling.\r\n   */\r\n  scrollContainerClass: 'scroll-container',\r\n  /**\r\n   * keyframes group is draggable.\r\n   */\r\n  groupsDraggable: true,\r\n  /**\r\n   * keyframes are draggable.\r\n   */\r\n  keyframesDraggable: true,\r\n  /**\r\n   * Timeline can be dragged or position can be changed by user interaction. Default: true\r\n   */\r\n  timelineDraggable: true,\r\n  /**\r\n   * Start drawing timeline from this min point.\r\n   * Bounds for the keyframe dragging.\r\n   */\r\n  min: 0,\r\n  /**\r\n   * Max bounds timeline can navigate to.\r\n   */\r\n  max: Number.MAX_VALUE,\r\n} as TimelineOptions;\r\n","/* eslint-disable @typescript-eslint/no-explicit-any */\r\n// bundle entry point\r\n\r\nimport { TimelineEventsEmitter } from './timelineEventsEmitter';\r\nimport { TimelineConsts } from './settings/timelineConsts';\r\n\r\n// @public timeline models\r\nimport { TimelineRanged } from './models/timelineRanged';\r\nimport { TimelineModel } from './models/timelineModel';\r\nimport { TimelineRow } from './models/timelineRow';\r\nimport { TimelineKeyframe } from './models/timelineKeyframe';\r\n// @public styles\r\nimport { TimelineOptions } from './settings/timelineOptions';\r\n\r\nimport { TimelineStyleUtils } from './utils/timelineStyleUtils';\r\nimport { TimelineUtils } from './utils/timelineUtils';\r\nimport { TimelineElement } from './utils/timelineElement';\r\n\r\n// @private helper containers.\r\nimport { TimelineCutBoundsRectResults } from './utils/timelineCutBoundsRectResults';\r\nimport { TimelineSelectionResults } from './utils/timelineSelectionResults';\r\nimport { TimelineMouseData } from './utils/timelineMouseData';\r\nimport { TimelineElementDragState } from './utils/timelineElementDragState';\r\nimport { TimelineDraggableData } from './utils/timelineDraggableData';\r\n\r\n// @private virtual model\r\nimport { TimelineGroupViewModel } from './viewModels/timelineGroupViewModel';\r\nimport { TimelineKeyframeViewModel } from './viewModels/timelineKeyframeViewModel';\r\nimport { TimelineRowViewModel } from './viewModels/timelineRowViewModel';\r\nimport { TimelineViewModel } from './viewModels/timelineViewModel';\r\n\r\n// @public events\r\nimport { TimelineKeyframeChangedEvent } from './utils/events/timelineKeyframeChangedEvent';\r\nimport { TimelineTimeChangedEvent } from './utils/events/timelineTimeChangedEvent';\r\nimport { TimelineSelectedEvent } from './utils/events/timelineSelectedEvent';\r\nimport { TimelineScrollEvent } from './utils/events/timelineScrollEvent';\r\nimport { TimelineClickEvent } from './utils/events/timelineClickEvent';\r\nimport { TimelineDragEvent } from './utils/events/timelineDragEvent';\r\n\r\n// @public enums\r\nimport { TimelineKeyframeShape } from './enums/timelineKeyframeShape';\r\nimport { TimelineInteractionMode } from './enums/timelineInteractionMode';\r\nimport { TimelineElementType } from './enums/timelineElementType';\r\nimport { TimelineCursorType } from './enums/timelineCursorType';\r\nimport { TimelineCapShape } from './enums/timelineCapShape';\r\nimport { TimelineEventSource } from './enums/timelineEventSource';\r\nimport { TimelineSelectionMode } from './enums/timelineSelectionMode';\r\nimport { TimelineSelectionType } from './enums/timelineSelectionType';\r\n\r\nimport { TimelineEvents } from './enums/timelineEvents';\r\n// @private defaults are exposed:\r\n\r\nimport { TimelineScrollSource } from './enums/timelineScrollSource';\r\nimport { defaultTimelineConsts } from './settings/defaults/defaultTimelineConsts';\r\nimport { defaultTimelineOptions } from './settings/defaults/defaultTimelineOptions';\r\n\r\nexport class Timeline extends TimelineEventsEmitter {\r\n  /**\r\n   * component container.\r\n   */\r\n  _container: HTMLElement | null = null;\r\n  /**\r\n   * Dynamically generated canvas inside of the container.\r\n   */\r\n  _canvas: HTMLCanvasElement | null = null;\r\n  /**\r\n   * Dynamically generated scroll container.\r\n   */\r\n  _scrollContainer: HTMLElement | null = null;\r\n  /**\r\n   * Dynamically generated virtual scroll content.\r\n   * While canvas has no real size, this element is used to create virtual scroll on the parent element.\r\n   */\r\n  _scrollContent: HTMLElement | null = null;\r\n  /**\r\n   * Rendering context\r\n   */\r\n  _ctx: CanvasRenderingContext2D | null = null;\r\n  /**\r\n   * Components settings\r\n   */\r\n  _options!: TimelineOptions;\r\n  /**\r\n   * Drag start position.\r\n   */\r\n  _startPosMouseArgs: TimelineMouseData | null = null;\r\n  /**\r\n   * Drag scroll started position.\r\n   */\r\n  _scrollStartPos: DOMPoint | null = null;\r\n  /**\r\n   * Private. Current mouse position that is used to track values between mouse up/down events.\r\n   * Can be null, use public methods and properties instead.\r\n   */\r\n  _currentPos: TimelineMouseData | null = null;\r\n\r\n  /**\r\n   * Private. Current active mouse area selection rectangle displayed during the mouse up/down drag events.\r\n   */\r\n  _selectionRect: DOMRect | null = null;\r\n  /**\r\n   * Private. Whether selection rectangle is displayed.\r\n   */\r\n  _selectionRectEnabled = false;\r\n  /**\r\n   * Private. Information in regard of current active drag state.\r\n   */\r\n  _drag: TimelineDraggableData | null = null;\r\n  _startedDragWithCtrl = false;\r\n  _startedDragWithShiftKey = false;\r\n  _groupSelected = false\r\n  _scrollProgrammatically = false;\r\n  _clickTimeout: number | null = null;\r\n  _lastClickTime = 0;\r\n  _lastClickPoint: DOMPoint | null = null;\r\n  _consts: TimelineConsts = defaultTimelineConsts;\r\n  /**\r\n   * Private. whether click is allowed.\r\n   */\r\n  _clickAllowed = false;\r\n  /**\r\n   * Private. scroll finished timer reference.\r\n   */\r\n  _scrollFinishedTimerRef?: number | null = null;\r\n  /**\r\n   * Private.Current timeline position.\r\n   * Please use public get\\set methods to properly change the timeline position.\r\n   */\r\n  _val = 0;\r\n  _pixelRatio = 1;\r\n  /**\r\n   * Private. Current zoom level. Please use publicly available properties to set zoom levels.\r\n   */\r\n  _currentZoom = 0;\r\n  /**\r\n   * Private. Ref for the auto pan scroll interval.\r\n   */\r\n  _intervalRef?: number | null = null;\r\n  /**\r\n   * Private.\r\n   * When last auto pan scroll action was started.\r\n   */\r\n  _autoPanLastActionDate = 0;\r\n  /**\r\n   * Private.\r\n   * Is pan mouse interactions are started.\r\n   */\r\n  _isPanStarted = false;\r\n  /**\r\n   * Private.\r\n   * Component interaction mode. Please use publicly available methods.\r\n   */\r\n  _interactionMode = TimelineInteractionMode.Selection;\r\n\r\n  _lastUsedArgs: MouseEvent | TouchEvent | null = null;\r\n  /**\r\n   * Private.\r\n   * Current set timeline model.\r\n   */\r\n  _model: TimelineModel | null = null;\r\n  /**\r\n   * Private.\r\n   * Indication when scroll are drag or click is started.\r\n   */\r\n  _scrollAreaClickOrDragStarted = false;\r\n  /**\r\n   * Create Timeline instance\r\n   * @param options Timeline settings.\r\n   * @param model Timeline model.\r\n   */\r\n  constructor(options: TimelineOptions | null = null, model: TimelineModel | null = null) {\r\n    super();\r\n    this._options = TimelineUtils.cloneOptions(defaultTimelineOptions);\r\n    // Allow to create instance without an error to perform tests.\r\n    if (options || model) {\r\n      this.initialize(options, model);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize Timeline\r\n   * @param options Timeline settings.\r\n   * @param model Timeline model.\r\n   */\r\n  public initialize = (options: TimelineOptions | null, model: TimelineModel | null): void => {\r\n    this._model = model;\r\n    if (!options || !options.id) {\r\n      throw new Error(`Element cannot be empty. Should be string or DOM element.`);\r\n    }\r\n\r\n    this._generateContainers(options.id);\r\n    this._options = TimelineUtils.cloneOptions(defaultTimelineOptions);\r\n    if (options) {\r\n      this._options = this._setOptions(options);\r\n    }\r\n    this._subscribeComponentEvents();\r\n    this.rescale();\r\n    this.redraw();\r\n  };\r\n\r\n  /**\r\n   * Generate component html.\r\n   * @param id container.\r\n   */\r\n  _generateContainers = (id: string | HTMLElement): void => {\r\n    if (id instanceof HTMLElement) {\r\n      this._container = id as HTMLElement;\r\n    } else {\r\n      this._container = document.getElementById(id);\r\n    }\r\n\r\n    if (!this._container) {\r\n      throw new Error(`Element cannot be empty. Should be string or DOM element.`);\r\n    }\r\n\r\n    this._scrollContainer = document.createElement('div');\r\n    this._scrollContent = document.createElement('div');\r\n    this._canvas = document.createElement('canvas');\r\n\r\n    if (!this._canvas || !this._canvas.getContext) {\r\n      console.log('Cannot initialize canvas context.');\r\n      return;\r\n    }\r\n\r\n    this._container.style.position = 'relative';\r\n    // Generate size container:\r\n    this._canvas.style.cssText =\r\n      'image-rendering: -moz-crisp-edges;' +\r\n      'image-rendering: -webkit-crisp-edges;' +\r\n      'image-rendering: pixelated;' +\r\n      'image-rendering: crisp-edges;' +\r\n      'user-select: none;' +\r\n      '-webkit-user-select: none;' +\r\n      '-khtml-user-select: none;' +\r\n      '-moz-user-select: none;' +\r\n      '-o-user-select: none;' +\r\n      'user-select: none;' +\r\n      'touch-action: none;' +\r\n      'position: relative;' +\r\n      '-webkit-user-drag: none;' +\r\n      '-khtml-user-drag: none;' +\r\n      '-moz-user-drag: none;' +\r\n      '-o-user-drag: none;' +\r\n      'user-drag: none;' +\r\n      'padding: inherit';\r\n\r\n    // Those styles are hardcoded and required for the proper scrolling.\r\n    this._scrollContainer.style.cssText = 'overflow: scroll;' + 'position: absolute;' + 'width:  100%;' + 'height:  100%;';\r\n    this._scrollContent.style.width = this._scrollContent.style.height = '100%';\r\n\r\n    // add the text node to the created div\r\n    this._scrollContainer.appendChild(this._scrollContent);\r\n    this._container.appendChild(this._scrollContainer);\r\n    const scrollBarWidth = this._scrollContainer.offsetWidth - this._scrollContent.clientWidth;\r\n    // Calculate current browser scrollbar size and add offset for the canvas\r\n    this._canvas.style.width = this._canvas.style.height = 'calc(100% -' + (scrollBarWidth || 17) + 'px)';\r\n\r\n    this._container.appendChild(this._canvas);\r\n    this._ctx = this._getCtx();\r\n  };\r\n  /**\r\n   * Get drawing context\r\n   */\r\n  _getCtx(): CanvasRenderingContext2D | null {\r\n    if (!this._canvas) {\r\n      return null;\r\n    }\r\n    if (this._ctx) {\r\n      return this._ctx;\r\n    }\r\n    this._ctx = this._canvas.getContext('2d');\r\n    return this._ctx;\r\n  }\r\n  /**\r\n   * Subscribe current component on the related events.\r\n   * Private. Use initialize method instead.\r\n   */\r\n  _subscribeComponentEvents = (): void => {\r\n    // Allow to call event multiple times, revoke current subscription and subscribe again.\r\n    this._unsubscribeComponentEvents();\r\n    if (!this._container || !this._scrollContainer || !this._canvas) {\r\n      throw Error(`Cannot subscribe on scroll events while one of the containers is null or empty. Please call initialize method first`);\r\n    }\r\n    if (this._container) {\r\n      this._container.addEventListener('wheel', this._handleWheelEvent);\r\n    }\r\n    if (this._scrollContainer) {\r\n      this._scrollContainer.addEventListener('scroll', this._handleScrollEvent);\r\n      this._scrollContainer.addEventListener('touchstart', this._handleScrollMouseDownEvent);\r\n      this._scrollContainer.addEventListener('mousedown', this._handleScrollMouseDownEvent);\r\n    }\r\n    document.addEventListener('keyup', this._handleKeyUp, false);\r\n    document.addEventListener('keydown', this._handleKeyDown, false);\r\n    window.addEventListener('blur', this._handleBlurEvent, false);\r\n    window.addEventListener('resize', this._handleWindowResizeEvent, false);\r\n    if (this._canvas) {\r\n      this._canvas.addEventListener('touchstart', this._handleMouseDownEvent, false);\r\n      this._canvas.addEventListener('mousedown', this._handleMouseDownEvent, false);\r\n    }\r\n    window.addEventListener('mousemove', this._handleMouseMoveEvent, false);\r\n    window.addEventListener('touchmove', this._handleMouseMoveEvent, false);\r\n    window.addEventListener('mouseup', this._handleMouseUpEvent, false);\r\n    window.addEventListener('touchend', this._handleMouseUpEvent, false);\r\n  };\r\n\r\n  /**\r\n   * Private. Use dispose method instead.\r\n   */\r\n  _unsubscribeComponentEvents = (): void => {\r\n    this._container?.removeEventListener('wheel', this._handleWheelEvent);\r\n\r\n    if (this._scrollContainer) {\r\n      this._scrollContainer.removeEventListener('scroll', this._handleScrollEvent);\r\n      this._scrollContainer.removeEventListener('touchstart', this._handleScrollMouseDownEvent);\r\n      this._scrollContainer.removeEventListener('mousedown', this._handleScrollMouseDownEvent);\r\n    } else {\r\n      console.warn(`Cannot unsubscribe scroll while it's already empty`);\r\n    }\r\n    window.removeEventListener('blur', this._handleBlurEvent);\r\n    window.removeEventListener('resize', this._handleWindowResizeEvent);\r\n    document.removeEventListener('keydown', this._handleKeyDown);\r\n    document.removeEventListener('keyup', this._handleKeyUp);\r\n    if (this._canvas) {\r\n      this._canvas.removeEventListener('touchstart', this._handleMouseDownEvent);\r\n      this._canvas.removeEventListener('mousedown', this._handleMouseDownEvent);\r\n    } else {\r\n      console.warn(`Cannot unsubscribe canvas while it's already empty`);\r\n    }\r\n    window.removeEventListener('mousemove', this._handleMouseMoveEvent);\r\n    window.removeEventListener('touchmove', this._handleMouseMoveEvent);\r\n    window.removeEventListener('mouseup', this._handleMouseUpEvent);\r\n    window.removeEventListener('touchend', this._handleMouseUpEvent);\r\n  };\r\n  /**\r\n   * Dispose current component: unsubscribe component and user events.\r\n   */\r\n  public dispose = (): void => {\r\n    // Unsubscribe all user events.\r\n    this.offAll();\r\n    // Stop times\r\n    this._stopAutoPan();\r\n    this._clearScrollFinishedTimer();\r\n    this._unsubscribeComponentEvents();\r\n    this._container = null;\r\n    this._canvas = null;\r\n    this._scrollContainer = null;\r\n    this._scrollContent = null;\r\n    this._ctx = null;\r\n    this._cleanUpSelection();\r\n  };\r\n  /**\r\n   * On key up is received.\r\n   */\r\n  _handleKeyUp = (event: KeyboardEvent): void => {\r\n    if (this._interactionMode === TimelineInteractionMode.Zoom) {\r\n      this._setZoomCursor(event);\r\n    }\r\n  };\r\n  /**\r\n   * On key down is received.\r\n   */\r\n  _handleKeyDown = (event: KeyboardEvent): void => {\r\n    if (this._interactionMode === TimelineInteractionMode.Zoom) {\r\n      this._setZoomCursor(event);\r\n    }\r\n  };\r\n  _setZoomCursor = (e: MouseEvent | KeyboardEvent): void => {\r\n    if (this._controlKeyPressed(e)) {\r\n      this._setCursor(TimelineCursorType.ZoomOut);\r\n    } else {\r\n      this._setCursor(TimelineCursorType.ZoomIn);\r\n    }\r\n  };\r\n  _handleBlurEvent = (): void => {\r\n    this._cleanUpSelection(true);\r\n  };\r\n  _handleWindowResizeEvent = (): void => {\r\n    // Rescale and redraw\r\n    this.rescale();\r\n    this.redraw();\r\n  };\r\n\r\n  _clearScrollFinishedTimer = (): void => {\r\n    if (this._scrollFinishedTimerRef) {\r\n      clearTimeout(this._scrollFinishedTimerRef);\r\n      this._scrollFinishedTimerRef = null;\r\n    }\r\n  };\r\n  _handleScrollMouseDownEvent = (): void => {\r\n    this._scrollAreaClickOrDragStarted = true;\r\n  };\r\n  _handleScrollEvent = (args: Event): void => {\r\n    const scrollProgrammatically = this._scrollProgrammatically;\r\n    if (this._scrollProgrammatically) {\r\n      this._scrollProgrammatically = false;\r\n    }\r\n    // Stop previous running timeout.\r\n    this._clearScrollFinishedTimer();\r\n    // Set a timeout to run event 'scrolling end'.\r\n    // Auto scroll is used to repeat scroll when drag element or select items outside of the visible area.\r\n    this._scrollFinishedTimerRef = window.setTimeout(() => {\r\n      if (!this._isPanStarted) {\r\n        this._clearScrollFinishedTimer();\r\n\r\n        // this.rescale();\r\n        // this.redraw();\r\n      }\r\n      this._emitScrollEvent(args, scrollProgrammatically, TimelineEvents.ScrollFinished);\r\n    }, this._consts.scrollFinishedTimeoutMs);\r\n\r\n    this.redraw();\r\n    this._emitScrollEvent(args, scrollProgrammatically);\r\n  };\r\n  _controlKeyPressed = (e: MouseEvent | KeyboardEvent | TouchEvent): boolean => {\r\n    if (!this._options || this._options.controlKeyIsMetaKey === undefined) {\r\n      return e.metaKey || e.ctrlKey;\r\n    }\r\n    return this._options.controlKeyIsMetaKey || this._options.controlKeyIsMetaKey ? e.metaKey : e.ctrlKey;\r\n  };\r\n  _handleWheelEvent = (event: WheelEvent): void => {\r\n    if (!this._scrollContainer || !this._canvas) {\r\n      // Component is not initialized yet.\r\n      return;\r\n    }\r\n    if (this._controlKeyPressed(event)) {\r\n      event.preventDefault();\r\n      const mousePosArguments = this._getMousePos(this._canvas, event);\r\n      const mousePos = Math.max(0, mousePosArguments.pos.x || 0);\r\n      this._zoom(TimelineUtils.sign(event.deltaY), this._options.zoomSpeed || 0, mousePos);\r\n    } else {\r\n      this.scrollTop = this._scrollContainer.scrollTop + event.deltaY;\r\n      event.preventDefault();\r\n    }\r\n  };\r\n  _zoom = (direction: number, speed: number, x: number): void => {\r\n    if (speed && speed > 0 && speed <= 1) {\r\n      const deltaSpeed = TimelineUtils.getDistance(this._canvasClientWidth() / 2, x) * 0.2;\r\n      x = x + deltaSpeed;\r\n      const diff = this._canvasClientWidth() / x;\r\n      const val = this._fromScreen(x);\r\n      const zoom = direction * this._currentZoom * speed;\r\n      //this._options.zoom\r\n      this._currentZoom = this._setZoom(this._currentZoom + zoom);\r\n      // Get only after zoom is set\r\n      const zoomCenter = this.valToPx(val);\r\n      let newScrollLeft = Math.round(zoomCenter - this._canvasClientWidth() / diff);\r\n      if (newScrollLeft <= 0) {\r\n        newScrollLeft = 0;\r\n      }\r\n\r\n      this._rescaleInternal(newScrollLeft + this._canvasClientWidth(), null, TimelineScrollSource.ZoomMode);\r\n      this.scrollLeft = newScrollLeft;\r\n\r\n      this.redraw();\r\n      this._emitZoomEvent(null, true);\r\n    }\r\n  };\r\n  /**\r\n   * Zoom in\r\n   * @param speed value from 0 to 1\r\n   */\r\n  public zoomIn = (speed = this._options.zoomSpeed): void => {\r\n    const width = this._scrollContainer?.clientWidth || 0;\r\n    if (speed && width) {\r\n      this._zoom(1, speed, width / 2);\r\n    }\r\n  };\r\n  /**\r\n   * Zoom out.\r\n   * @param speed value from 0 to 1\r\n   */\r\n  public zoomOut = (speed = this._options.zoomSpeed): void => {\r\n    const width = this._scrollContainer?.clientWidth || 0;\r\n    if (speed && width) {\r\n      this._zoom(-1, speed, width / 2);\r\n    }\r\n  };\r\n  /**\r\n   * Set direct zoom value.\r\n   * @param zoom zoom value to set. percent 0-1 and etc.\r\n   * @param min min zoom.\r\n   * @param max max zoom.\r\n   * @return normalized value.\r\n   */\r\n  _setZoom = (zoom: number, min: number | null | undefined = null, max: number | null | undefined = null): number => {\r\n    min = TimelineUtils.isNumber(min) ? min : this._options?.zoomMin;\r\n    max = TimelineUtils.isNumber(max) ? max : this._options?.zoomMax;\r\n    if (TimelineUtils.isNumber(zoom)) {\r\n      zoom = TimelineUtils.keepInBounds(zoom, min, max);\r\n      zoom = zoom || 1;\r\n      this._currentZoom = zoom;\r\n      return zoom;\r\n    }\r\n\r\n    return zoom;\r\n  };\r\n\r\n  /**\r\n   * Set direct zoom value.\r\n   * @public\r\n   * @param zoom zoom value to set. percent 0-1 and etc.\r\n   * @return normalized value.\r\n   */\r\n  setZoom = (zoom: number): number => {\r\n    const prevZoom = this.getZoom();\r\n    if (prevZoom !== zoom) {\r\n      const zoomSet = this._setZoom(zoom);\r\n      if (prevZoom != zoomSet) {\r\n        this.rescale();\r\n        this.redraw();\r\n        return zoomSet;\r\n      }\r\n    }\r\n    return prevZoom;\r\n  };\r\n  /**\r\n   * Get current zoom level.\r\n   */\r\n  getZoom = (): number => {\r\n    if (TimelineUtils.isNumber(this._currentZoom)) {\r\n      return this._currentZoom || 1;\r\n    }\r\n    return 1;\r\n  };\r\n  /**\r\n   * \r\n   */\r\n  cancelHighlight = (): any => {\r\n    this._selectInternal(null)\r\n    this.redraw()\r\n  }\r\n\r\n  _getClickDetectionRadius = (point: TimelineMouseData): number => {\r\n    const defaultValue = this._consts.clickDetectionMinRadius || 1;\r\n    return Math.max(defaultValue, point?.radius || defaultValue);\r\n  };\r\n  /**\r\n   * @param args\r\n   */\r\n  _handleMouseDownEvent = (args: MouseEvent | TouchEvent): void => {\r\n    // Prevent drag of the canvas if canvas is selected as text:\r\n    TimelineUtils.clearBrowserSelection();\r\n    if (!this._canvas || !this._scrollContainer) {\r\n      this._cleanUpSelection();\r\n      return;\r\n    }\r\n    this._startPosMouseArgs = this._trackMousePos(this._canvas, args);\r\n\r\n    if (!this._startPosMouseArgs) {\r\n      return;\r\n    }\r\n    let isDoubleClick = Date.now() - this._lastClickTime < this._consts.doubleClickTimeoutMs;\r\n    // Don't allow to perform double click if mouse was moved to far.\r\n    if (\r\n      this._lastClickPoint &&\r\n      this._startPosMouseArgs &&\r\n      TimelineUtils.getDistance(this._lastClickPoint.x, this._lastClickPoint.y, this._startPosMouseArgs.pos.x, this._startPosMouseArgs.pos.y) > this._consts.clickThreshold\r\n    ) {\r\n      isDoubleClick = false;\r\n    }\r\n\r\n    this._lastClickPoint = this._startPosMouseArgs.pos;\r\n    this._scrollStartPos = { x: this._scrollContainer.scrollLeft, y: this._scrollContainer.scrollTop } as DOMPoint;\r\n    this._clickAllowed = true;\r\n    let onlyElements: TimelineElementType[] | null = null;\r\n    if (this._interactionMode === TimelineInteractionMode.NonInteractivePan || this._interactionMode === TimelineInteractionMode.None) {\r\n      // Allow to select only timeline. Timeline position can be disabled/enabled by properties.\r\n      onlyElements = [TimelineElementType.Timeline];\r\n    }\r\n    const clickRadius = this._getClickDetectionRadius(this._startPosMouseArgs);\r\n    const elements = this.elementFromPoint(this._startPosMouseArgs.pos, clickRadius, onlyElements);\r\n\r\n    const target = this._findDraggableElement(elements, this._startPosMouseArgs.val);\r\n    // Create click event\r\n    const event = new TimelineClickEvent();\r\n    event.point = this._startPosMouseArgs;\r\n    event.args = args;\r\n    // all elements under the click:\r\n    event.elements = elements;\r\n    // target element.\r\n    event.target = target;\r\n\r\n    if (isDoubleClick) {\r\n      super.emit(TimelineEvents.DoubleClick, event);\r\n      return;\r\n    }\r\n\r\n    super.emit(TimelineEvents.MouseDown, event);\r\n\r\n    this._clickTimeout = Date.now();\r\n    this._lastClickTime = Date.now();\r\n    if (event.isPrevented()) {\r\n      // Mouse up will be also prevented\r\n      this._cleanUpSelection();\r\n      return;\r\n    }\r\n\r\n    this._currentPos = this._startPosMouseArgs;\r\n\r\n    // Select keyframes on mouse down\r\n    if (target && this._interactionMode !== TimelineInteractionMode.Zoom) {\r\n      this._drag = new TimelineDraggableData();\r\n      this._drag.val = target.val;\r\n      this._drag.type = target.type;\r\n      this._drag.target = this._setElementDragState(target, target.val);\r\n\r\n      if (target.type === TimelineElementType.Keyframe) {\r\n        this._groupSelected = false;\r\n        this._startedDragWithCtrl = this._controlKeyPressed(args);\r\n        this._startedDragWithShiftKey = args.shiftKey;\r\n        // get all related selected keyframes if we are selecting one.\r\n        if (target?.keyframe && !target?.keyframe?.selected && !this._controlKeyPressed(args)) {\r\n          this._selectInternal(target.keyframe);\r\n        }\r\n        // Allow to drag all selected keyframes on a screen\r\n        this._drag.elements = this.getSelectedElements().map((element) => {\r\n          return this._setElementDragState(element, element.val);\r\n        });\r\n      } else if (target.type === TimelineElementType.Group) {\r\n        const keyframes = target.keyframes;\r\n        this._startedDragWithCtrl = this._controlKeyPressed(args);\r\n        this._groupSelected = true;\r\n        // get all related selected keyframes if we are selecting one.\r\n        if (keyframes && !this._controlKeyPressed(args)) {\r\n          this._selectInternal(keyframes);\r\n        }\r\n        if (keyframes && Array.isArray(keyframes)) {\r\n          this._drag.elements = keyframes.map((keyframe) => {\r\n            return this._setElementDragState(this._convertToTimelineElement(this._drag?.target.row || null, keyframe), keyframe.val);\r\n          });\r\n        }\r\n      } else {\r\n        this._drag.elements = [this._drag.target];\r\n      }\r\n    }\r\n\r\n    this.redraw();\r\n  };\r\n  _setElementDragState = (element: TimelineElement | TimelineElementDragState, val: number): TimelineElementDragState => {\r\n    const state = element as TimelineElementDragState;\r\n    state.prevVal = state.val;\r\n    if (state.startedVal === undefined || state.startedVal === null) {\r\n      state.startedVal = val;\r\n    }\r\n    if (state.prevVal === undefined || state.prevVal === null) {\r\n      state.prevVal = val;\r\n    }\r\n    state.val = val;\r\n    return state;\r\n  };\r\n  /**\r\n   * Check is mouse left button is clicked.\r\n   */\r\n  isLeftButtonClicked = (args: MouseEvent | TouchEvent | any): boolean => {\r\n    return !!args && args.buttons == 1;\r\n  };\r\n\r\n  /**\r\n   * Browser mouse move handler.\r\n   */\r\n  _handleMouseMoveEvent = (args: MouseEvent | TouchEvent | null): void => {\r\n    if (!args) {\r\n      args = this._lastUsedArgs;\r\n    } else {\r\n      this._lastUsedArgs = args;\r\n    }\r\n    if (!args || !this._canvas) {\r\n      return;\r\n    }\r\n    const touchEventArgs = args as TouchEvent;\r\n    const isTouch = touchEventArgs.changedTouches && touchEventArgs.changedTouches.length > 0;\r\n    this._currentPos = this._trackMousePos(this._canvas, args);\r\n    if (!this._isPanStarted && this._selectionRect && this._clickTimeoutIsOver()) {\r\n      // TODO: implement selection by rect\r\n      if (this._interactionMode === TimelineInteractionMode.None || this._interactionMode === TimelineInteractionMode.Zoom || this._interactionMode === TimelineInteractionMode.NonInteractivePan) {\r\n        this._selectionRectEnabled = false;\r\n      } else {\r\n        this._selectionRectEnabled = true;\r\n      }\r\n    } else {\r\n      this._selectionRectEnabled = false;\r\n    }\r\n\r\n    args = args as MouseEvent;\r\n    const isLeftClicked = this.isLeftButtonClicked(args);\r\n    if (!isLeftClicked) {\r\n      this._scrollAreaClickOrDragStarted = false;\r\n    }\r\n    // On dragging is started.\r\n    if (this._startPosMouseArgs) {\r\n      // On left button is on hold by the user\r\n      if (isLeftClicked || isTouch) {\r\n        if (this._drag && !this._startedDragWithCtrl) {\r\n          const convertedVal = this._currentPos.val;\r\n          if (this._drag.type === TimelineElementType.Timeline) {\r\n            this._setTimeInternal(convertedVal, TimelineEventSource.User);\r\n          } else if ((this._drag.type == TimelineElementType.Keyframe || this._drag.type == TimelineElementType.Group) && this._drag.elements) {\r\n            const offset = Math.floor(convertedVal - this._drag.val);\r\n            const movedOffset = this._moveElements(offset, this._drag.elements, TimelineEventSource.User);\r\n            if (movedOffset !== 0) {\r\n              if (!this._drag.changed) {\r\n                this._drag.prevVal = this._drag.val;\r\n                const eventArgs = this._emitDragStartedEvent(this._drag);\r\n                if (!eventArgs || eventArgs.isPrevented()) {\r\n                  // Cleanup drag here, so drag finished will be ignored.\r\n                  this._cleanUpSelection(true);\r\n                  this._drag = null;\r\n                  return;\r\n                }\r\n              }\r\n\r\n              this._drag.changed = true;\r\n              this._drag.val += offset;\r\n              this._emitDragEvent(this._drag);\r\n            }\r\n          }\r\n        }\r\n\r\n        if ((this._interactionMode === TimelineInteractionMode.Pan || this._interactionMode === TimelineInteractionMode.NonInteractivePan) && !this._drag) {\r\n          this._isPanStarted = true;\r\n          this._setCursor(TimelineCursorType.Grabbing);\r\n          // Track scroll by drag.\r\n          this._scrollByPan(this._startPosMouseArgs.pos, this._currentPos.pos, this._scrollStartPos);\r\n        } else {\r\n          if (this._interactionMode !== TimelineInteractionMode.None) {\r\n            // Track scroll by mouse or touch out of the area.\r\n            this._scrollBySelectionOutOfBounds(this._currentPos.pos);\r\n          }\r\n        }\r\n\r\n        this.redraw();\r\n      } else {\r\n        // Fallback. Cancel mouse move when focus was lost and mouse down is still counted.\r\n        this._cleanUpSelection(true);\r\n        this.redraw();\r\n      }\r\n    } else if (!isTouch) {\r\n      // Set mouse over cursors\r\n      let onlyElements: TimelineElementType[] | null = null;\r\n      if (this._interactionMode === TimelineInteractionMode.NonInteractivePan || this._interactionMode === TimelineInteractionMode.None) {\r\n        // Allow to select only timeline. Timeline position can be disabled/enabled by properties.\r\n        onlyElements = [TimelineElementType.Timeline];\r\n      }\r\n      const clickRadius = this._getClickDetectionRadius(this._currentPos);\r\n      const elements = this.elementFromPoint(this._currentPos.pos, clickRadius, onlyElements);\r\n      const target = this._findDraggableElement(elements, this._currentPos.val);\r\n      if (this._isPanStarted || this._interactionMode === TimelineInteractionMode.Pan || this._interactionMode === TimelineInteractionMode.NonInteractivePan) {\r\n        if (isLeftClicked) {\r\n          this._setCursor(TimelineCursorType.Grabbing);\r\n        } else {\r\n          this._setCursor(TimelineCursorType.Grab);\r\n        }\r\n      } else {\r\n        if (this._interactionMode === TimelineInteractionMode.Zoom) {\r\n          this._setZoomCursor(args);\r\n          return;\r\n        } else {\r\n          this._setCursor(TimelineCursorType.Default);\r\n        }\r\n      }\r\n\r\n      if (target) {\r\n        let cursor: TimelineCursorType | null = null;\r\n        if (target.type === TimelineElementType.Group) {\r\n          cursor = cursor || TimelineCursorType.EWResize;\r\n        } else if (target.type == TimelineElementType.Keyframe) {\r\n          cursor = cursor || TimelineCursorType.Pointer;\r\n        } else if (target.type == TimelineElementType.Timeline) {\r\n          cursor = cursor || this._options?.timelineStyle?.cursor || null;\r\n        }\r\n\r\n        if (cursor) {\r\n          this._setCursor(cursor);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isTouch) {\r\n      args.preventDefault();\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Move elements\r\n   * @param offset vector to move elements along.\r\n   * @param elements Element to move.\r\n   * @returns real moved value.\r\n   */\r\n  _moveElements(offset: number, elements: TimelineElementDragState[], source: TimelineEventSource = TimelineEventSource.Programmatically): number {\r\n    if (!elements) {\r\n      return 0;\r\n    }\r\n    let isChanged = false;\r\n    if (Math.abs(offset) > 0) {\r\n      // Find drag min and max bounds:\r\n      let bounds = { min: Number.MIN_SAFE_INTEGER, max: Number.MAX_SAFE_INTEGER } as TimelineRanged;\r\n      // Set min max from the options.\r\n      bounds = TimelineUtils.setMinMax(bounds, this._options);\r\n      elements.forEach((p) => {\r\n        if (!p || !p.keyframe) {\r\n          return;\r\n        }\r\n        // find allowed bounds for the draggable items.\r\n        // find for each row and keyframe separately.\r\n        const currentBounds = TimelineUtils.setMinMax(TimelineUtils.setMinMax({ min: bounds.min, max: bounds.max }, p.keyframe), p.row || null);\r\n        const expectedKeyframeValue = this._options?.snapAllKeyframesOnMove ? this.snapVal(p.keyframe.val) : p.keyframe.val;\r\n        const newPosition = expectedKeyframeValue + offset;\r\n        // Check that move offset will hit min bounds\r\n        if ((currentBounds.min || currentBounds.min === 0) && TimelineUtils.isNumber(currentBounds.min) && newPosition < currentBounds.min) {\r\n          // Return to the bounds:\r\n          offset = offset + TimelineUtils.getDistance(currentBounds.min, newPosition);\r\n        }\r\n        if ((currentBounds.max || currentBounds.max === 0) && TimelineUtils.isNumber(currentBounds.max) && newPosition > currentBounds.max) {\r\n          // Return to the bounds:\r\n          offset = offset - TimelineUtils.getDistance(currentBounds.max, newPosition);\r\n        }\r\n      });\r\n\r\n      if (Math.abs(offset) > 0) {\r\n        // don't allow to move less than zero offset.\r\n        elements.forEach((element) => {\r\n          if (!element?.keyframe) {\r\n            return;\r\n          }\r\n          const prevVal = element.keyframe.val;\r\n          const toSet = prevVal + offset;\r\n          const newValue = this._setKeyframePos(element, toSet, source);\r\n          isChanged = newValue !== prevVal;\r\n        });\r\n      }\r\n\r\n      if (isChanged) {\r\n        return offset;\r\n      }\r\n    }\r\n\r\n    return 0;\r\n  }\r\n\r\n  /**\r\n   * Mouse up handler.\r\n   */\r\n  _handleMouseUpEvent = (args: MouseEvent | TouchEvent): void => {\r\n    this._scrollAreaClickOrDragStarted = false;\r\n    if (!this._canvas) {\r\n      return;\r\n    }\r\n    if (this._startPosMouseArgs) {\r\n      //window.releaseCapture();\r\n      const pos = this._trackMousePos(this._canvas, args);\r\n\r\n      // Click detection.\r\n      if (this._clickAllowed || !this._clickTimeoutIsOver() || (this._drag && (this._startedDragWithCtrl || this._startedDragWithShiftKey))) {\r\n        if (this._options && this._interactionMode === TimelineInteractionMode.Zoom) {\r\n          const direction = this._controlKeyPressed(args) ? 1 : -1;\r\n          const mouseArgs = this._getMousePos(this._canvas, args);\r\n          const mousePos = Math.max(0, mouseArgs.pos.x || 0);\r\n          this._zoom(direction, this._options.zoomSpeed || 0, mousePos);\r\n        } else {\r\n          this._performClick(pos, this._drag);\r\n        }\r\n      } else if (!this._drag && this._selectionRect && this._selectionRectEnabled) {\r\n        if (this._interactionMode === TimelineInteractionMode.Zoom) {\r\n          // TODO: implement zoom by screen rect.\r\n        } else if (this._interactionMode !== TimelineInteractionMode.None) {\r\n          const keyframes = this._getKeyframesByRectangle(this._selectionRect);\r\n          const selectionMode = args.shiftKey ? TimelineSelectionMode.Append : TimelineSelectionMode.Normal;\r\n          this.select(keyframes, selectionMode);\r\n        }\r\n      }\r\n\r\n      this._cleanUpSelection();\r\n      this.redraw();\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Canvas client height.\r\n   */\r\n  _canvasClientHeight = (): number => {\r\n    if (this._canvas) {\r\n      return this._canvas.clientHeight;\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  /**\r\n   * Canvas client width.\r\n   */\r\n  _canvasClientWidth = (): number => {\r\n    if (this._canvas) {\r\n      return this._canvas.clientWidth;\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  /**\r\n   * Get all keyframes under the screen rectangle.\r\n   * @param screenRect screen coordinates to get keyframes.\r\n   */\r\n  _getKeyframesByRectangle = (screenRect: DOMRect): TimelineKeyframe[] => {\r\n    const keyframesModels: Array<TimelineKeyframe> = [];\r\n    this._forEachKeyframe((keyframeViewModel) => {\r\n      const intersects =\r\n        keyframeViewModel.shape === TimelineKeyframeShape.Rect\r\n          ? TimelineUtils.isRectIntersects(keyframeViewModel.size, screenRect)\r\n          : TimelineUtils.isOverlap(keyframeViewModel.size.x, keyframeViewModel.size.y, screenRect);\r\n\r\n      if (intersects) {\r\n        keyframesModels.push(keyframeViewModel.model);\r\n      }\r\n    });\r\n    return keyframesModels;\r\n  };\r\n\r\n  /**\r\n   * Private.\r\n   * Perform timeline click.\r\n   */\r\n  _performClick = (pos: TimelineMouseData, drag: TimelineDraggableData | null): boolean => {\r\n    let isChanged = false;\r\n    if (drag && (drag.type === TimelineElementType.Keyframe || drag.type === TimelineElementType.Group)) {\r\n      let mode = TimelineSelectionMode.Normal;\r\n      if (this._groupSelected) {\r\n        mode = TimelineSelectionMode.Revert;\r\n      }\r\n      if (this._startedDragWithCtrl && this._controlKeyPressed(pos.args)) {\r\n        if (this._controlKeyPressed(pos.args)) {\r\n          mode = TimelineSelectionMode.Revert;\r\n        }\r\n      } else if (this._startedDragWithShiftKey && pos.args.shiftKey) {\r\n        mode = TimelineSelectionMode.Append;\r\n      }\r\n      // Reverse selected keyframe selection by a click:\r\n      const keyframes = this._groupSelected ? drag.target.keyframes : drag.target.keyframe;\r\n      if (keyframes && this._controlKeyPressed(pos.args)) {\r\n        isChanged = this._selectInternal(keyframes || null, mode).selectionChanged || isChanged;\r\n      }\r\n\r\n\r\n      if (pos.args.shiftKey && this._options?.timelineDraggable !== false) {\r\n        // Set current timeline position if it's not a drag or selection rect small or fast click.\r\n        isChanged = this._setTimeInternal(pos.val, TimelineEventSource.User) || isChanged;\r\n      }\r\n    } else {\r\n      // deselect keyframes if any:\r\n\r\n      if (pos.args instanceof MouseEvent && pos.args.button == 0) {\r\n        isChanged = this._selectInternal(null).selectionChanged || isChanged;\r\n      }\r\n\r\n      if (this._options?.timelineDraggable !== false) {\r\n        // change timeline pos:\r\n        // Set current timeline position if it's not a drag or selection rect small or fast click.\r\n        isChanged = this._setTimeInternal(pos.val, TimelineEventSource.User) || isChanged;\r\n      }\r\n    }\r\n\r\n    return isChanged;\r\n  };\r\n  /**\r\n   * Set keyframe value.\r\n   * @param keyframe\r\n   * @param value\r\n   * @return set value.\r\n   */\r\n  _setKeyframePos = (element: TimelineElementDragState, value: number, source: TimelineEventSource = TimelineEventSource.Programmatically): number => {\r\n    if (!element || !element.keyframe) {\r\n      return value;\r\n    }\r\n    value = Math.floor(value);\r\n    if (element.keyframe && element.keyframe.val != value) {\r\n      element.prevVal = element.val;\r\n      element.val = value;\r\n      element.keyframe.val = value;\r\n      const event = this._emitKeyframeChanged(element, source);\r\n      if (event.isPrevented()) {\r\n        element.val = event.prevVal;\r\n        element.keyframe.val = event.prevVal;\r\n      }\r\n\r\n      return value;\r\n    }\r\n\r\n    return value;\r\n  };\r\n\r\n  /**\r\n   * @param cursor to set.\r\n   */\r\n  _setCursor = (cursor: string): void => {\r\n    if (this._canvas && this._canvas.style.cursor != cursor) {\r\n      this._canvas.style.cursor = cursor;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Set component interaction mode.\r\n   */\r\n  public setInteractionMode = (mode: TimelineInteractionMode): void => {\r\n    if (this._interactionMode != mode) {\r\n      this._interactionMode = mode;\r\n      // Avoid any conflicts with other modes, clean current state.\r\n      this._cleanUpSelection(true);\r\n      this.redraw();\r\n    }\r\n  };\r\n  /**\r\n   * Get current interaction mode.\r\n   */\r\n  public getInteractionMode = (): TimelineInteractionMode => {\r\n    return this._interactionMode;\r\n  };\r\n  /**\r\n   * Private.\r\n   * Helper method. Convert model element  to timeline element.\r\n   */\r\n  _convertToTimelineElement = (rowModel: TimelineRow | null, keyframe: TimelineKeyframe): TimelineElement => {\r\n    const data = {\r\n      type: TimelineElementType.Keyframe,\r\n      val: keyframe.val,\r\n      keyframe: keyframe,\r\n      row: rowModel,\r\n    } as TimelineElement;\r\n    return data;\r\n  };\r\n\r\n  public getSelectedKeyframes = (): TimelineKeyframe[] => {\r\n    const selected = this.getSelectedElements();\r\n    return selected.map((p) => p.keyframe) as TimelineKeyframe[];\r\n  };\r\n\r\n  /**\r\n   * Get selected timeline elements.\r\n   */\r\n  public getSelectedElements = (): TimelineElement[] => {\r\n    const selected: TimelineElement[] = [];\r\n    this._forEachKeyframe((keyframe): void => {\r\n      if (keyframe && keyframe.model.selected) {\r\n        selected.push(this._convertToTimelineElement(keyframe.rowViewModel.model, keyframe.model));\r\n      }\r\n      return;\r\n    });\r\n\r\n    return selected;\r\n  };\r\n  /**\r\n   * Get all keyframe models available in the model.\r\n   */\r\n  public getAllKeyframes = (): TimelineKeyframe[] => {\r\n    const keyframes: TimelineKeyframe[] = [];\r\n    this._forEachKeyframe((keyframe): void => {\r\n      keyframes.push(keyframe.model);\r\n    });\r\n\r\n    return keyframes;\r\n  };\r\n\r\n  public selectAllKeyframes = (): TimelineSelectionResults => {\r\n    return this.select(this.getAllKeyframes(), TimelineSelectionMode.Normal);\r\n  };\r\n  public deselectAll = (): TimelineSelectionResults => {\r\n    return this.select(null);\r\n  };\r\n\r\n  private _changeNodeState = (state: TimelineSelectionResults, node: TimelineKeyframe, value: boolean): boolean => {\r\n    if (node.selected !== value) {\r\n      const selectable = typeof node.selectable === 'boolean' ? node.selectable : true;\r\n      if (!value || (value && selectable)) {\r\n        node.selected = value;\r\n        state.changed.push(node);\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  public select = (nodes: TimelineKeyframe[] | TimelineKeyframe | null, mode = TimelineSelectionMode.Normal): TimelineSelectionResults => {\r\n    const results = this._selectInternal(nodes, mode);\r\n    if (results.selectionChanged) {\r\n      this.redraw();\r\n    }\r\n    return results;\r\n  };\r\n\r\n  /**\r\n   * Select keyframes\r\n   * @param nodes keyframe or list of the keyframes to be selected.\r\n   * @param mode selection mode.\r\n   */\r\n  public _selectInternal = (nodes: TimelineKeyframe[] | TimelineKeyframe | null, mode = TimelineSelectionMode.Normal, type = TimelineSelectionType.keyframe): TimelineSelectionResults => {\r\n    if (!nodes) {\r\n      nodes = [];\r\n    }\r\n    if (!Array.isArray(nodes)) {\r\n      nodes = [nodes];\r\n    }\r\n\r\n    const state = {\r\n      selectionChanged: false,\r\n      selected: this.getSelectedKeyframes(),\r\n      changed: [] as Array<any>,\r\n    } as TimelineSelectionResults;\r\n    const nodesArray = nodes as TimelineKeyframe[];\r\n    //const state = this.selectedSubject.getValue();\r\n    if (nodesArray && mode === TimelineSelectionMode.Append) {\r\n      nodes.forEach((node) => {\r\n        const changed = this._changeNodeState(state, node, true);\r\n        if (changed && node.selected) {\r\n          state.selected.push(node);\r\n        }\r\n      });\r\n    } else if (nodesArray && mode === TimelineSelectionMode.Revert) {\r\n      nodes.forEach((node) => {\r\n        if (state.selected.indexOf(node) >= 0) {\r\n          this._changeNodeState(state, node, false);\r\n          TimelineUtils.deleteElement<TimelineKeyframe>(state.selected, node);\r\n        } else {\r\n          this._changeNodeState(state, node, true);\r\n          if (node.selected) {\r\n            state.selected.push(node);\r\n          }\r\n        }\r\n      });\r\n    } else if (mode === TimelineSelectionMode.Normal) {\r\n      const selectedItems: Array<TimelineKeyframe> = [];\r\n      if (nodes) {\r\n        nodes.forEach((node) => {\r\n          this._changeNodeState(state, node, true);\r\n          if (node.selected) {\r\n            selectedItems.push(node);\r\n          }\r\n        });\r\n      }\r\n\r\n      state.selected.forEach((node) => {\r\n        const exists = nodesArray.indexOf(node) >= 0;\r\n        // Deselect\r\n        if (!exists) {\r\n          this._changeNodeState(state, node, false);\r\n        }\r\n      });\r\n\r\n      if (state.changed.length > 0) {\r\n        if (selectedItems) {\r\n          state.selected = selectedItems;\r\n        } else {\r\n          state.selected.length = 0;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (state.changed.length > 0) {\r\n      state.selectionChanged = true;\r\n\r\n      this._emitKeyframesSelected(state);\r\n\r\n    }\r\n\r\n    return state;\r\n  };\r\n\r\n  /**\r\n   * foreach visible keyframe.\r\n   */\r\n  _forEachKeyframe(callback: (keyframe: TimelineKeyframeViewModel, index?: number, newRow?: boolean) => void): void {\r\n    if (!callback) {\r\n      return;\r\n    }\r\n    if (!this._model) {\r\n      return;\r\n    }\r\n\r\n    const calculatedModel = this._generateViewModel();\r\n    if (!calculatedModel) {\r\n      return;\r\n    }\r\n\r\n    calculatedModel?.rowsViewModels?.forEach((rowViewModel) => {\r\n      if (!rowViewModel) {\r\n        return;\r\n      }\r\n\r\n      let nextRow = true;\r\n      rowViewModel.keyframesViewModels.forEach((keyframeViewModel, keyframeIndex) => {\r\n        if (keyframeViewModel) {\r\n          callback(keyframeViewModel, keyframeIndex, nextRow);\r\n        }\r\n\r\n        nextRow = false;\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Private.\r\n   * Create extended mouse position and calculate size of the selection rectangle.\r\n   */\r\n  _trackMousePos(canvas: HTMLCanvasElement, mouseArgs: MouseEvent | TouchEvent): TimelineMouseData {\r\n    const clickArgs = this._getMousePos(canvas, mouseArgs);\r\n    const pos = clickArgs.pos;\r\n    clickArgs.originalVal = this._mousePosToVal(pos.x, false);\r\n    clickArgs.snapVal = this._mousePosToVal(pos.x, true);\r\n    clickArgs.val = clickArgs.originalVal;\r\n    if (this._options && this._options.snapEnabled) {\r\n      clickArgs.val = clickArgs.snapVal;\r\n    }\r\n\r\n    if (this._startPosMouseArgs) {\r\n      if (!this._selectionRect) {\r\n        this._selectionRect = {} as DOMRect;\r\n      }\r\n      const startPos = this._startPosMouseArgs.pos;\r\n      // get the pos with the virtualization:\r\n      const x = Math.floor(startPos.x + ((this._scrollStartPos?.x || 0) - this.scrollLeft));\r\n      const y = Math.floor(startPos.y + ((this._scrollStartPos?.y || 0) - this.scrollTop));\r\n      this._selectionRect.x = Math.min(x, pos.x);\r\n      this._selectionRect.y = Math.min(y, pos.y);\r\n      this._selectionRect.width = Math.max(x, pos.x) - this._selectionRect.x;\r\n      this._selectionRect.height = Math.max(y, pos.y) - this._selectionRect.y;\r\n      // Once mouse was moved outside of the bounds it's not a click anymore\r\n      if (this._clickAllowed) {\r\n        this._clickAllowed = this._selectionRect.height <= this._consts.clickThreshold && this._selectionRect.width <= this._consts.clickThreshold;\r\n      }\r\n    }\r\n\r\n    return clickArgs;\r\n  }\r\n\r\n  /**\r\n   * Get scroll container client width.\r\n   */\r\n  getClientWidth(): number {\r\n    return this._scrollContainer?.clientWidth || 0;\r\n  }\r\n  /**\r\n   * Get scroll container client height.\r\n   */\r\n  getClientHeight(): number {\r\n    return this._scrollContainer?.clientHeight || 0;\r\n  }\r\n  _cleanUpSelection(forcePrevent = false): void {\r\n    if (this._drag) {\r\n      this._emitDragFinishedEvent(this._drag, forcePrevent);\r\n    }\r\n    this._startPosMouseArgs = null;\r\n    this._drag = null;\r\n    this._scrollAreaClickOrDragStarted = false;\r\n    this._startedDragWithCtrl = false;\r\n    this._startedDragWithShiftKey = false;\r\n    this._selectionRect = null;\r\n    this._clickTimeout = null;\r\n    this._scrollStartPos = null;\r\n    this._isPanStarted = false;\r\n    this._clickAllowed = false;\r\n    this._stopAutoPan();\r\n  }\r\n\r\n  /**\r\n   * Check whether click timeout is over.\r\n   */\r\n  _clickTimeoutIsOver(): boolean {\r\n    // Duration before the selection can be tracked.\r\n    if (this._clickTimeout && Date.now() - this._clickTimeout > this._consts.clickDetectionMs) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Automatically pan. Scroll canvas when selection is made and mouse outside of the bounds.\r\n   */\r\n  _startAutoPan = (): void => {\r\n    if (this._consts.autoPanSpeed) {\r\n      if (!this._intervalRef) {\r\n        // Repeat move calls to\r\n        this._intervalRef = window.setInterval(() => {\r\n          this._handleMouseMoveEvent(null);\r\n        }, this._consts.autoPanSpeed);\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Stop current running auto pan\r\n   */\r\n  _stopAutoPan = (): void => {\r\n    if (this._intervalRef) {\r\n      clearInterval(this._intervalRef);\r\n      this._intervalRef = null;\r\n    }\r\n\r\n    this._autoPanLastActionDate = 0;\r\n  };\r\n\r\n  /**\r\n   * Check whether auto pan should be slowed down a bit.\r\n   */\r\n  _checkUpdateSpeedTooFast(): boolean {\r\n    // Slow down updated a bit.\r\n    if (this._autoPanLastActionDate && Date.now() - this._autoPanLastActionDate <= this._consts.autoPanSpeedLimit) {\r\n      return true;\r\n    }\r\n\r\n    this._autoPanLastActionDate = Date.now();\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Scroll virtual canvas when pan mode is enabled.\r\n   */\r\n  _scrollByPan(start: DOMPoint, pos: DOMPoint, scrollStartPos: DOMPoint | null): void {\r\n    if (!start || !pos || !this._scrollContainer) {\r\n      return;\r\n    }\r\n    let x = 0;\r\n    let y = 0;\r\n    if (scrollStartPos) {\r\n      x = scrollStartPos.x;\r\n      y = scrollStartPos.y;\r\n    }\r\n    const offsetX = Math.round(start.x - pos.x);\r\n    const newLeft = x + offsetX;\r\n\r\n    if (offsetX > 0) {\r\n      this._rescaleInternal(newLeft + this._canvasClientWidth());\r\n    }\r\n\r\n    if (offsetX > 0 && newLeft + this._canvasClientWidth() >= this._scrollContainer.scrollWidth - 5) {\r\n      this.scrollLeft = this._scrollContainer.scrollWidth;\r\n    } else {\r\n      this.scrollLeft = newLeft;\r\n    }\r\n    this.scrollTop = Math.round(y + start.y - pos.y);\r\n  }\r\n\r\n  _scrollBySelectionOutOfBounds(pos: DOMPoint): boolean {\r\n    if (!this._scrollContainer) {\r\n      return false;\r\n    }\r\n    const x = pos.x;\r\n    const y = pos.y;\r\n    let isChanged = false;\r\n    let speedX = 0;\r\n    let speedY = 0;\r\n    // Small offset to start auto pan earlier.\r\n    const bounds = this._consts.autoPanByScrollPadding;\r\n    const isLeft = x <= bounds;\r\n    const isRight = x >= this._canvasClientWidth() - bounds;\r\n    const isTop = y <= bounds;\r\n    const isBottom = y >= this._canvasClientHeight() - bounds;\r\n    let newWidth = null;\r\n    let newHeight = null;\r\n    if (isLeft || isRight || isTop || isBottom) {\r\n      // Auto move init\r\n      this._startAutoPan();\r\n\r\n      if (this._checkUpdateSpeedTooFast()) {\r\n        return false;\r\n      }\r\n\r\n      const scrollSpeedMultiplier = isNaN(this._consts.scrollByDragSpeed) ? 1 : this._consts.scrollByDragSpeed;\r\n      if (isLeft) {\r\n        // Get normalized speed.\r\n        speedX = -TimelineUtils.getDistance(x, bounds) * scrollSpeedMultiplier;\r\n      } else if (isRight) {\r\n        // Get normalized speed:\r\n        speedX = TimelineUtils.getDistance(x, this._canvasClientWidth() - bounds) * scrollSpeedMultiplier;\r\n        newWidth = this.scrollLeft + this._canvasClientWidth() + speedX;\r\n      }\r\n\r\n      if (isTop) {\r\n        // Get normalized speed.\r\n        speedY = (-TimelineUtils.getDistance(x, bounds) * scrollSpeedMultiplier) / 4;\r\n      } else if (isBottom) {\r\n        // Get normalized speed:\r\n        speedY = (TimelineUtils.getDistance(x, this._canvasClientHeight() - bounds) * scrollSpeedMultiplier) / 4;\r\n        newHeight = this._scrollContainer.scrollTop + this._canvasClientHeight();\r\n      }\r\n    } else {\r\n      this._stopAutoPan();\r\n    }\r\n\r\n    if (newWidth || newHeight) {\r\n      this._rescaleInternal(newWidth, newHeight, TimelineScrollSource.ScrollBySelection);\r\n    }\r\n\r\n    if (Math.abs(speedX) > 0) {\r\n      this.scrollLeft = this._scrollContainer.scrollLeft + speedX;\r\n      isChanged = true;\r\n    }\r\n\r\n    if (Math.abs(speedY) > 0) {\r\n      this.scrollTop = this._scrollContainer.scrollTop + speedY;\r\n      isChanged = true;\r\n    }\r\n\r\n    return isChanged;\r\n  }\r\n\r\n  /**\r\n   * Convert screen pixel to value.\r\n   */\r\n  public pxToVal(px: number): number {\r\n    if (!this._options) {\r\n      return px;\r\n    }\r\n    let min = this._options.min || 0;\r\n    if (!TimelineUtils.isNumber(min)) {\r\n      min = 0;\r\n    }\r\n    const stepPx = this._options.stepPx || 0;\r\n    if (stepPx === 0) {\r\n      return px;\r\n    }\r\n    min *= this._currentZoom || 1;\r\n    const steps = (this._options.stepVal || 0) * this._currentZoom || 1;\r\n    const val = min + (px / stepPx) * steps;\r\n    return val;\r\n  }\r\n\r\n  /**\r\n   * Convert value to local screen component coordinates.\r\n   */\r\n  _toScreenPx = (val: number): number => {\r\n    return this.valToPx(val) - this.scrollLeft + this._leftMargin();\r\n  };\r\n  /**\r\n   * Convert screen local coordinates to a global value info.\r\n   */\r\n  _fromScreen = (px: number): number => {\r\n    return this.pxToVal(this.scrollLeft + px - this._leftMargin());\r\n  };\r\n  /**\r\n   * Convert area value to global screen pixel coordinates.\r\n   */\r\n  public valToPx = (val: number): number => {\r\n    if (!this._options || !this._options.stepPx) {\r\n      return val;\r\n    }\r\n    let min = this._options.min || 0;\r\n    if (!TimelineUtils.isNumber(min)) {\r\n      min = 0;\r\n    }\r\n    min *= this._currentZoom || 1;\r\n    const steps = (this._options.stepVal || 0) * this._currentZoom || 1;\r\n    return (-min + val) * (this._options.stepPx / steps);\r\n  };\r\n\r\n  /**\r\n   * Snap a value to a nearest grid point.\r\n   */\r\n  public snapVal(val: number): number {\r\n    // Snap a value if configured.\r\n    if (this._options && this._options.snapEnabled && this._options.snapStep) {\r\n      const stops = this._options.snapStep;\r\n      const step = val / stops;\r\n      const stepsFit = Math.round(step);\r\n      const minSteps = Math.abs(this._options.min || 0) / this._options.snapStep;\r\n      const minOffset = TimelineUtils.sign(this._options.min || 1) * (minSteps - Math.floor(minSteps)) * this._options.snapStep;\r\n      val = Math.round(minOffset) + Math.round(stepsFit * stops);\r\n    }\r\n\r\n    val = TimelineUtils.keepInBounds(val, this._options.min, this._options.max);\r\n    return val;\r\n  }\r\n\r\n  /**\r\n   * Convert mouse position to the timeline units considering all the scrolling and offsets.\r\n   */\r\n  _mousePosToVal = (x: number, snapEnabled = false): number => {\r\n    const mousePos = Math.min(x, this._canvasClientWidth());\r\n    let convertedVal = this._fromScreen(mousePos);\r\n    convertedVal = Math.round(convertedVal);\r\n    if (snapEnabled) {\r\n      convertedVal = this.snapVal(convertedVal);\r\n    }\r\n\r\n    return convertedVal;\r\n  };\r\n\r\n  /**\r\n   * Format line gauge text.\r\n   * Default formatting is HMS\r\n   * @param ms milliseconds to convert.\r\n   * @param isSeconds whether seconds are passed.\r\n   */\r\n  _formatUnitsText = (ms: number, isSeconds = false): string => {\r\n    const sign = TimelineUtils.sign(ms) < 0 ? '-' : '';\r\n    ms = Math.abs(ms);\r\n    // 1- Convert to seconds:\r\n    let seconds = ms / 1000;\r\n    if (isSeconds) {\r\n      seconds = ms;\r\n    }\r\n\r\n    const year = Math.floor(seconds / (365 * 86400));\r\n    seconds = seconds % (365 * 86400);\r\n\r\n    const days = Math.floor(seconds / 86400);\r\n    seconds = seconds % 86400;\r\n\r\n    // 2- Extract hours:\r\n    const hours = Math.floor(seconds / 3600); // 3,600 seconds in 1 hour\r\n    seconds = seconds % 3600; // seconds remaining after extracting hours\r\n    // 3- Extract minutes:\r\n    const minutes = Math.floor(seconds / 60); // 60 seconds in 1 minute\r\n    // 4- Keep only seconds not extracted to minutes:\r\n    seconds = seconds % 60;\r\n    let str = '';\r\n    if (year) {\r\n      str += year + ':';\r\n    }\r\n\r\n    if (days) {\r\n      str += days + ':';\r\n    }\r\n\r\n    if (hours) {\r\n      str += hours + ':';\r\n    }\r\n\r\n    if (minutes) {\r\n      str += minutes + ':';\r\n    }\r\n\r\n    if (!isNaN(seconds)) {\r\n      str += seconds;\r\n    }\r\n\r\n    return sign + str;\r\n  };\r\n  /**\r\n   * Left padding of the timeline.\r\n   */\r\n  _leftMargin = (): number => {\r\n    return this._options?.leftMargin || 0;\r\n  };\r\n  /**\r\n   * Private.\r\n   * Render line gauge ticks.\r\n   */\r\n  _renderTicks = (): void => {\r\n    if (!this._ctx || !this._ctx.canvas || this._ctx.canvas.clientWidth <= 0 || this._ctx.canvas.clientHeight <= 0 || !this._options || !this._options.stepPx) {\r\n      return;\r\n    }\r\n    const screenWidth = this._canvasClientWidth() - this._leftMargin();\r\n    let from = this.pxToVal(this.scrollLeft);\r\n    let to = this.pxToVal(this.scrollLeft + screenWidth);\r\n    if (isNaN(from) || isNaN(to) || from === to) {\r\n      return;\r\n    }\r\n\r\n    if (to < from) {\r\n      const wasToVal = to;\r\n      to = from;\r\n      from = wasToVal;\r\n    }\r\n\r\n    const valDistance = TimelineUtils.getDistance(from, to);\r\n    if (valDistance <= 0) {\r\n      return;\r\n    }\r\n\r\n    // Find the nearest 'beautiful' step for a gauge.\r\n    // 'beautiful' step should be dividable by 1/2/5/10!\r\n    const step = TimelineUtils.findGoodStep(valDistance / (screenWidth / this._options.stepPx));\r\n\r\n    // Find beautiful start point:\r\n    const fromVal = Math.floor(from / step) * step;\r\n\r\n    // Find a beautiful end point:\r\n    const toVal = Math.ceil(to / step) * step + step;\r\n\r\n    if (!TimelineUtils.isNumber(step) || step <= 0 || Math.abs(toVal - fromVal) === 0) {\r\n      return;\r\n    }\r\n    let smallStep = 0;\r\n    if (this._options.stepSmallPx) {\r\n      smallStep = TimelineUtils.findGoodStep(valDistance / (screenWidth / this._options.stepSmallPx));\r\n    }\r\n\r\n    let lastTextStart = 0;\r\n    this._ctx.save();\r\n    const headerHeight = TimelineStyleUtils.headerHeight(this._options);\r\n    const tickHeight = headerHeight / 2;\r\n    const smallTickHeight = headerHeight / 1.3;\r\n    for (let i = fromVal; i <= toVal; i += step) {\r\n      // local\r\n      const sharpPos = this._getSharp(this._toScreenPx(i));\r\n      this._ctx.save();\r\n      this._ctx.beginPath();\r\n      this._ctx.setLineDash([4]);\r\n      this._ctx.lineWidth = 1;\r\n      if (this._options.tickColor) {\r\n        this._ctx.strokeStyle = this._options.tickColor;\r\n      }\r\n      TimelineUtils.drawLine(this._ctx, sharpPos, tickHeight, sharpPos, headerHeight);\r\n      this._ctx.stroke();\r\n      if (this._options.labelsColor) {\r\n        this._ctx.fillStyle = this._options.labelsColor;\r\n      }\r\n      if (this._options.font) {\r\n        this._ctx.font = this._options.font;\r\n      }\r\n\r\n      const text = this._formatUnitsText(i);\r\n      const textSize = this._ctx.measureText(text);\r\n\r\n      const textX = sharpPos - textSize.width / 2;\r\n      // skip text render if there is no space for it.\r\n      if (isNaN(lastTextStart) || lastTextStart <= textX) {\r\n        lastTextStart = textX + textSize.width;\r\n        this._ctx.fillText(text, textX, 10);\r\n      }\r\n\r\n      this._ctx.restore();\r\n      if (!TimelineUtils.isNumber(smallStep) || smallStep <= 0) {\r\n        continue;\r\n      }\r\n      // Draw small steps\r\n      for (let x = i + smallStep; x < i + step; x += smallStep) {\r\n        // local\r\n        const nextSharpPos = this._getSharp(this._toScreenPx(x));\r\n        this._ctx.beginPath();\r\n        this._ctx.lineWidth = this._pixelRatio;\r\n        if (this._options.tickColor) {\r\n          this._ctx.strokeStyle = this._options.tickColor;\r\n        }\r\n        TimelineUtils.drawLine(this._ctx, nextSharpPos, smallTickHeight, nextSharpPos, headerHeight);\r\n        this._ctx.stroke();\r\n      }\r\n    }\r\n\r\n    this._ctx.restore();\r\n  };\r\n\r\n  /**\r\n   * Private.\r\n   * Calculate virtual view model.\r\n   * Determine screen positions for the model elements given.\r\n   */\r\n  _generateViewModel = (): TimelineViewModel => {\r\n    const toReturn = {\r\n      size: {\r\n        x: 0,\r\n        y: 0,\r\n        width: 0,\r\n        height: 0,\r\n      } as DOMRect,\r\n      min: null,\r\n      max: null,\r\n      rowsViewModels: [],\r\n      keyframesViewModels: [],\r\n    } as TimelineViewModel;\r\n\r\n    if (!this._model) {\r\n      return toReturn;\r\n    }\r\n    const rows = this._model.rows;\r\n    if (!rows || !Array.isArray(rows) || rows.length <= 0) {\r\n      return toReturn;\r\n    }\r\n    let rowAbsoluteHeight = TimelineStyleUtils.headerHeight(this._options);\r\n    rows.forEach((row, index) => {\r\n      if (!row || row.hidden) {\r\n        return;\r\n      }\r\n\r\n      // draw with scroll virtualization:\r\n      const rowHeight = TimelineStyleUtils.getRowHeight(row.style || null, this._options);\r\n      const marginBottom = TimelineStyleUtils.getRowMarginBottom(row.style || null, this._options);\r\n      const currentRowY = rowAbsoluteHeight - (this._scrollContainer ? this._scrollContainer.scrollTop : 0);\r\n      rowAbsoluteHeight += rowHeight + marginBottom;\r\n      if (index == 0) {\r\n        toReturn.size.y = currentRowY;\r\n      }\r\n\r\n      toReturn.size.height = Math.max(rowAbsoluteHeight + rowHeight, toReturn.size.height);\r\n      const rowSize = { x: 0, y: currentRowY, width: this._canvasClientWidth(), height: rowHeight } as DOMRect;\r\n      const rowViewModel = {\r\n        size: rowSize,\r\n        marginBottom: marginBottom,\r\n        model: row,\r\n        index: index,\r\n        min: null,\r\n        max: null,\r\n        groupsViewModels: [],\r\n        keyframesViewModels: [],\r\n      } as TimelineRowViewModel;\r\n      toReturn.rowsViewModels.push(rowViewModel);\r\n      if (!row.keyframes || !row.keyframes.forEach || row.keyframes.length <= 0) {\r\n        return;\r\n      }\r\n\r\n      // Get min and max ms to draw keyframe rows:\r\n      if (row && row.keyframes) {\r\n        row.keyframes.forEach((keyframe) => {\r\n          if (!keyframe || !TimelineUtils.isNumber(keyframe.val)) {\r\n            console.log('Unexpected null keyframe or having invalid value');\r\n            return;\r\n          }\r\n          if (keyframe.hidden) {\r\n            return;\r\n          }\r\n          let groupViewModel: TimelineGroupViewModel | null = rowViewModel.groupsViewModels?.find((p) => keyframe.group === p.groupModel) || null;\r\n          if (!groupViewModel) {\r\n            groupViewModel = {\r\n              min: keyframe.val,\r\n              max: keyframe.val,\r\n              size: null,\r\n              groupModel: keyframe.group,\r\n              keyframesViewModels: [],\r\n            } as TimelineGroupViewModel;\r\n            // TimelineStyleUtils.groupFillColor(rowViewModel.model.style || null, this._options);\r\n            rowViewModel.groupsViewModels.push(groupViewModel);\r\n          }\r\n          const keyframeShape = TimelineStyleUtils.keyframeShape(keyframe, keyframe.group, row.style || null, this._options);\r\n          const keyframeSize = this._getKeyframePosition(keyframe, groupViewModel, rowViewModel, keyframeShape);\r\n          const keyframeViewModel = {\r\n            model: keyframe,\r\n            rowViewModel: rowViewModel,\r\n            groupViewModel: groupViewModel,\r\n            size: keyframeSize,\r\n            shape: keyframeShape,\r\n          } as TimelineKeyframeViewModel;\r\n\r\n          const min = groupViewModel.min === null ? keyframe.val : Math.min(keyframe.val, groupViewModel.min);\r\n          const max = groupViewModel.max === null ? keyframe.val : Math.max(keyframe.val, groupViewModel.max);\r\n          if (TimelineUtils.isNumber(min)) {\r\n            groupViewModel.min = min;\r\n          }\r\n          if (TimelineUtils.isNumber(max)) {\r\n            groupViewModel.max = max;\r\n          }\r\n          // All keyframes in the row\r\n          rowViewModel.keyframesViewModels.push(keyframeViewModel);\r\n          // All keyframes in the group\r\n          groupViewModel.keyframesViewModels.push(keyframeViewModel);\r\n          // All keyframes in the component\r\n          toReturn.keyframesViewModels.push(keyframeViewModel);\r\n        });\r\n      }\r\n\r\n      rowViewModel.groupsViewModels.forEach((groupViewModel) => {\r\n        // Extend row min max bounds by a group bounds. It's used to notify needed visible bounds for the row.\r\n        TimelineUtils.setMinMax(rowViewModel, groupViewModel, true);\r\n        // get group screen coords\r\n        const groupRect = this._getKeyframesGroupSize(groupViewModel, rowViewModel);\r\n        groupViewModel.size = groupRect;\r\n      });\r\n\r\n      // Extend screen bounds by a current calculation:\r\n      TimelineUtils.setMinMax(toReturn, rowViewModel, true);\r\n    });\r\n    if (TimelineUtils.isNumber(toReturn.max) && (toReturn.max || toReturn.max === 0)) {\r\n      toReturn.size.width = this.valToPx(toReturn.max);\r\n    }\r\n    return toReturn;\r\n  };\r\n\r\n  /**\r\n   * Render timeline rows.\r\n   */\r\n  _renderRows = (): void => {\r\n    if (!this._ctx) {\r\n      return;\r\n    }\r\n    const viewModel = this._generateViewModel();\r\n    if (!viewModel?.rowsViewModels) {\r\n      return;\r\n    }\r\n    try {\r\n      this._ctx.save();\r\n\r\n      viewModel.rowsViewModels.forEach((rowViewModel) => {\r\n        if (!rowViewModel || !this._ctx) {\r\n          return;\r\n        }\r\n\r\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n        //@ts-ignore\r\n        this._ctx.fillStyle = rowViewModel.model.style ? rowViewModel.model.style : TimelineStyleUtils.getRowFillColor(rowViewModel.model.style || null, this._options);\r\n        //this._ctx.fillRect(data.areaRect.x, data.areaRect.y, data.areaRect.w, data.areaRect.h);\r\n        // Note: bounds used instead of the clip while clip is slow!\r\n        const bounds = this._cutBounds(rowViewModel.size);\r\n        if (bounds?.rect) {\r\n          const rect = bounds?.rect;\r\n          this._ctx.fillRect(rect.x, rect.y, rect.width, rect.height);\r\n          if (rowViewModel.model.moveStyle) {\r\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n            //@ts-ignore\r\n            this._ctx.strokeStyle = rowViewModel.model.moveStyle\r\n            this._ctx.lineWidth = 1;\r\n            this._ctx.strokeRect(rect.x, rect.y, rect.width, rect.height);\r\n          }\r\n        }\r\n\r\n        this._renderGroupBounds(rowViewModel);\r\n      });\r\n    } finally {\r\n      this._ctx.restore();\r\n    }\r\n  };\r\n  /**\r\n   * Render group for the row.\r\n   */\r\n  _renderGroupBounds = (rowViewModel: TimelineRowViewModel): void => {\r\n    if (!rowViewModel || !this._ctx) {\r\n      return;\r\n    }\r\n\r\n    rowViewModel?.groupsViewModels?.forEach((groupsViewModels) => {\r\n      if (!this._ctx) {\r\n        return;\r\n      }\r\n      const keyframeLaneColor = TimelineStyleUtils.groupFillColor(this._options, groupsViewModels.groupModel, rowViewModel?.model?.style);\r\n      if (!keyframeLaneColor) {\r\n        return;\r\n      }\r\n      if (!groupsViewModels.size) {\r\n        console.log('Size of the group cannot be calculated');\r\n        return;\r\n      }\r\n\r\n      let selectedNum = 0;\r\n      groupsViewModels.keyframesViewModels.forEach(e => {\r\n        if (e.model.selected) {\r\n          selectedNum++\r\n        }\r\n      })\r\n      const isGroupSelected = selectedNum == groupsViewModels.keyframesViewModels.length;\r\n      // get the bounds on a canvas\r\n      const rectBounds = this._cutBounds(groupsViewModels.size);\r\n      if (rectBounds?.rect) {\r\n        this._ctx.fillStyle = keyframeLaneColor;\r\n        const rect = rectBounds.rect;\r\n        this._ctx.fillRect(rect.x, rect.y, rect.width, rect.height);\r\n        this._ctx.strokeStyle = isGroupSelected ? '#FFEE32' : keyframeLaneColor;\r\n        if (rect.width) {\r\n          this._ctx.lineWidth = 2;\r\n          this._ctx.strokeRect(rect.x, rect.y, rect.width, rect.height);\r\n        }\r\n      }\r\n    });\r\n  };\r\n  /**\r\n   * Method is used for the canvas drawing optimization.\r\n   * Bounds are cut to draw only visible parts for the active canvas.\r\n   */\r\n  _cutBounds = (rect: DOMRect): TimelineCutBoundsRectResults | null => {\r\n    if (!rect) {\r\n      return null;\r\n    }\r\n    // default bounds: minX, maxX, minY, maxY\r\n    const testOffset = 0;\r\n    const minX = 0 + testOffset;\r\n    const maxX = this._canvasClientWidth() - testOffset;\r\n    const minY = TimelineStyleUtils.headerHeight(this._options) + testOffset;\r\n    const maxY = this._canvasClientHeight() - testOffset;\r\n\r\n    return this._cutBoundsWhenOverlap(rect, minX, maxX, minY, maxY);\r\n  };\r\n  _cutBoundsWhenOverlap = (rect: DOMRect, minX: number, maxX: number, minY: number, maxY: number): TimelineCutBoundsRectResults | null => {\r\n    if (!rect) {\r\n      return null;\r\n    }\r\n\r\n    if (\r\n      // At the moment it's a check of top and left intersection.\r\n      TimelineUtils.isRectIntersects(rect, {\r\n        x: minX,\r\n        y: minY,\r\n        width: TimelineUtils.getDistance(minX, maxX),\r\n        height: TimelineUtils.getDistance(minY, maxY),\r\n      } as DOMRect)\r\n    ) {\r\n      const y = Math.max(rect.y, minY);\r\n      const x = Math.max(rect.x, minX);\r\n      const offsetW = rect.x - x;\r\n      const offsetH = rect.y - y;\r\n\r\n      return {\r\n        rect: { height: rect.height + offsetH, width: rect.width + offsetW, x: x, y: y },\r\n        overlapY: Math.abs(offsetH) > 0,\r\n        overlapX: Math.abs(offsetW) > 0,\r\n      } as TimelineCutBoundsRectResults;\r\n    }\r\n    return null;\r\n  };\r\n  /**\r\n   * Calculate keyframe group screen rect size that is used during the rendering.\r\n   * @param row\r\n   * @param rowY row screen coords y position\r\n   */\r\n  _getKeyframesGroupSize = (groupViewModel: TimelineGroupViewModel, rowViewModel: TimelineRowViewModel): DOMRect => {\r\n    const rowY = rowViewModel.size.y;\r\n    const rowHeight = rowViewModel.size.height;\r\n    const groupModel = groupViewModel.groupModel || null;\r\n    let groupHeight = TimelineStyleUtils.groupHeight(this._options, groupModel, rowViewModel?.model?.style);\r\n\r\n    let marginTop = TimelineStyleUtils.groupMarginTop(this._options, groupModel, rowViewModel?.model?.style);\r\n    const isAutoHeight = groupHeight === 'auto';\r\n    if (!groupHeight || isAutoHeight) {\r\n      groupHeight = Math.floor(rowHeight);\r\n    }\r\n    groupHeight = typeof groupHeight === 'string' ? parseInt(groupHeight) : groupHeight;\r\n    if (groupHeight > rowHeight) {\r\n      groupHeight = rowHeight;\r\n    }\r\n    const isAutoMargin = marginTop === 'auto';\r\n    if (typeof marginTop === 'string') {\r\n      if (isAutoMargin) {\r\n        marginTop = (rowHeight - groupHeight) / 2;\r\n      } else {\r\n        marginTop = parseInt(marginTop) || 0;\r\n      }\r\n    }\r\n\r\n    if (!isAutoMargin) {\r\n      if (isAutoHeight) {\r\n        groupHeight -= marginTop * 2;\r\n      }\r\n    }\r\n\r\n    // draw keyframes rows.\r\n    const xMin = this._toScreenPx(groupViewModel.min); // local\r\n    const xMax = this._toScreenPx(groupViewModel.max); // local\r\n\r\n    return {\r\n      x: xMin,\r\n      y: rowY + marginTop,\r\n      height: groupHeight,\r\n      width: TimelineUtils.getDistance(xMin, xMax),\r\n    } as DOMRect;\r\n  };\r\n\r\n  _getKeyframePosition = (keyframe: TimelineKeyframe, groupViewModel: TimelineGroupViewModel, rowViewModel: TimelineRowViewModel, keyframeShape: TimelineKeyframeShape): DOMRect | null => {\r\n    if (!keyframe) {\r\n      console.log('keyframe should be defined.');\r\n      return null;\r\n    }\r\n\r\n    const val = keyframe.val;\r\n    if (!TimelineUtils.isNumber(val)) {\r\n      return null;\r\n    }\r\n\r\n    const rowSize = rowViewModel.size;\r\n    // get center of the lane:\r\n    let y = rowSize.y + rowSize.height / 2;\r\n    const groupModel = groupViewModel?.groupModel || null;\r\n    let height: number | string = TimelineStyleUtils.keyframeHeight(keyframe, groupModel, rowViewModel?.model?.style, this._options);\r\n    let width: number | string = TimelineStyleUtils.keyframeWidth(keyframe, groupModel, rowViewModel?.model?.style, this._options);\r\n\r\n    if (height === 'auto') {\r\n      height = rowSize.height / 3;\r\n    }\r\n    if (width === 'auto') {\r\n      width = height;\r\n    }\r\n    if (height > 0) {\r\n      const x = Math.floor(this._toScreenPx(val));\r\n      y = Math.floor(y);\r\n      const rect = {\r\n        x: x, // local\r\n        y: y,\r\n        height: height,\r\n        width: width,\r\n      } as DOMRect;\r\n      // Rect we are drawing in the center\r\n      if (keyframeShape === TimelineKeyframeShape.Rect) {\r\n        rect.y = rect.y - rect.height / 2;\r\n        rect.x = rect.x - rect.width / 2;\r\n      }\r\n      return rect;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  _renderKeyframes = (): void => {\r\n    this._forEachKeyframe((keyframeViewModel) => {\r\n      if (!this._ctx) {\r\n        return;\r\n      }\r\n      const row = keyframeViewModel.rowViewModel.model;\r\n      const size = keyframeViewModel.size;\r\n      const keyframe = keyframeViewModel.model;\r\n      if (size) {\r\n        const x = this._getSharp(size.x);\r\n        const y = size.y;\r\n        const bounds = this._cutBounds({\r\n          x: x - size.width / 2,\r\n          y: y - size.height / 2,\r\n          width: size.width,\r\n          height: size.height,\r\n        } as DOMRect);\r\n        if (!bounds) {\r\n          return;\r\n        }\r\n\r\n        this._ctx.save();\r\n\r\n        // Performance FIX: use clip only  when we are in the collision! Clip is slow!\r\n        // Other keyframes should be hidden by bounds check.\r\n        if (bounds && bounds.overlapY) {\r\n          this._ctx.beginPath();\r\n          this._ctx.rect(0, TimelineStyleUtils.headerHeight(this._options), this._canvasClientWidth(), this._canvasClientWidth());\r\n          this._ctx.clip();\r\n        }\r\n\r\n        const shape = keyframeViewModel.shape;\r\n        if (shape === TimelineKeyframeShape.None) {\r\n          return;\r\n        }\r\n        const rowStyle = row.style || null;\r\n        const groupModel = keyframeViewModel?.groupViewModel?.groupModel || null;\r\n        const keyframeColor = keyframe.selected\r\n          ? TimelineStyleUtils.keyframeSelectedFillColor(keyframe, groupModel, rowStyle, this._options)\r\n          : TimelineStyleUtils.keyframeFillColor(keyframe, groupModel, rowStyle, this._options);\r\n        const border = TimelineStyleUtils.keyframeStrokeThickness(keyframe, groupModel, rowStyle, this._options);\r\n        let strokeColor = '';\r\n        if (border > 0) {\r\n          if (keyframe.selected) {\r\n            strokeColor = TimelineStyleUtils.keyframeSelectedStrokeColor(keyframe, groupModel, rowStyle, this._options);\r\n          } else {\r\n            strokeColor = TimelineStyleUtils.keyframeStrokeColor(keyframe, groupModel, rowStyle, this._options);\r\n          }\r\n        }\r\n\r\n        if (shape == TimelineKeyframeShape.Rhomb) {\r\n          this._ctx.beginPath();\r\n          this._ctx.translate(x, y);\r\n          this._ctx.rotate((45 * Math.PI) / 180);\r\n          if (border > 0 && strokeColor) {\r\n            this._ctx.fillStyle = strokeColor;\r\n            this._ctx.rect(-size.width / 2, -size.height / 2, size.width, size.height);\r\n            this._ctx.fill();\r\n          }\r\n\r\n          this._ctx.fillStyle = keyframeColor;\r\n          // draw main keyframe data with offset.\r\n          this._ctx.translate(border, border);\r\n          this._ctx.rect(-size.width / 2, -size.height / 2, size.width - border * 2, size.height - border * 2);\r\n          this._ctx.fill();\r\n        } else if (shape == TimelineKeyframeShape.Circle) {\r\n          this._ctx.beginPath();\r\n          if (border > 0 && strokeColor) {\r\n            this._ctx.fillStyle = strokeColor;\r\n            this._ctx.arc(x, y, size.height, 0, 2 * Math.PI);\r\n          }\r\n          this._ctx.fillStyle = keyframeColor;\r\n          this._ctx.arc(x, y, size.height - border, 0, 2 * Math.PI);\r\n          this._ctx.fill();\r\n        } else if (shape == TimelineKeyframeShape.Rect) {\r\n          this._ctx.beginPath();\r\n\r\n          if (border > 0 && strokeColor) {\r\n            this._ctx.fillStyle = strokeColor;\r\n            this._ctx.rect(x, y, size.width, size.height);\r\n            this._ctx.fill();\r\n          }\r\n\r\n          this._ctx.fillStyle = keyframeColor;\r\n          this._ctx.rect(x + border, y + border, size.width - border, size.height - border);\r\n          this._ctx.fill();\r\n        }\r\n\r\n        this._ctx.restore();\r\n      }\r\n    });\r\n  };\r\n\r\n  _renderSelectionRect = (): void => {\r\n    if (this._drag || !this._ctx || !this._canvas) {\r\n      return;\r\n    }\r\n    this._ctx.save();\r\n    const thickness = 1;\r\n    if (this._selectionRect && this._selectionRectEnabled) {\r\n      this._ctx.setLineDash([4]);\r\n      this._ctx.lineWidth = this._pixelRatio;\r\n      const selectionColor = this._options.selectionColor;\r\n      if (selectionColor) {\r\n        this._ctx.strokeStyle = selectionColor;\r\n      }\r\n      this._ctx.strokeRect(\r\n        this._getSharp(this._selectionRect.x, thickness),\r\n        this._getSharp(this._selectionRect.y, thickness),\r\n        Math.floor(this._selectionRect.width),\r\n        Math.floor(this._selectionRect.height),\r\n      );\r\n    }\r\n    this._ctx.restore();\r\n  };\r\n\r\n  _renderBackground = (): void => {\r\n    if (!this._ctx || !this._canvas) {\r\n      return;\r\n    }\r\n    if (this._options.fillColor) {\r\n      this._ctx.save();\r\n      this._ctx.beginPath();\r\n      this._ctx.rect(0, 0, this._canvasClientWidth(), this._canvasClientHeight());\r\n      this._ctx.fillStyle = this._options.fillColor;\r\n      this._ctx.fill();\r\n      this._ctx.restore();\r\n    } else {\r\n      // Clear if bg not set.\r\n      this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\r\n    }\r\n  };\r\n\r\n  _renderTimeline = (): void => {\r\n    if (!this._ctx || !this._options || !this._options.timelineStyle) {\r\n      return;\r\n    }\r\n    const style = this._options.timelineStyle;\r\n    this._ctx.save();\r\n    try {\r\n      const thickness = style.width || 1;\r\n      this._ctx.lineWidth = thickness * this._pixelRatio;\r\n      const timeLinePos = this._getSharp(this._toScreenPx(this._val), thickness);\r\n      if (style.strokeColor) {\r\n        this._ctx.strokeStyle = style.strokeColor;\r\n      }\r\n      if (style.fillColor) {\r\n        this._ctx.fillStyle = style.fillColor;\r\n      }\r\n      const y = style.marginTop || 0;\r\n      const yBottom = style.marginBottom || 0;\r\n      this._ctx.beginPath();\r\n      const canvasHeight = this._canvasClientHeight() - yBottom;\r\n      TimelineUtils.drawLine(this._ctx, timeLinePos, y, timeLinePos, canvasHeight);\r\n      this._ctx.stroke();\r\n      this._renderTimelineCap(timeLinePos, y);\r\n    } finally {\r\n      this._ctx.restore();\r\n    }\r\n  };\r\n  /**\r\n   * Render timeline cap top.\r\n   */\r\n  _renderTimelineCap = (timeLinePos: number, y: number): void => {\r\n    const capStyle = this._options?.timelineStyle?.capStyle;\r\n    if (!this._ctx || !capStyle) {\r\n      return;\r\n    }\r\n    if (capStyle.capType === TimelineCapShape.None) {\r\n      return;\r\n    }\r\n    this._ctx.save();\r\n    try {\r\n      const capSize = capStyle.width || 0;\r\n      const capHeight = capStyle.height || 0;\r\n      if (capSize && capHeight) {\r\n        this._ctx.strokeStyle = capStyle.strokeColor;\r\n        this._ctx.fillStyle = capStyle.fillColor;\r\n        if (capStyle.capType === TimelineCapShape.Triangle) {\r\n          this._ctx.beginPath();\r\n          this._ctx.moveTo(timeLinePos - capSize / 2, y);\r\n          this._ctx.lineTo(timeLinePos + capSize / 2, y);\r\n          this._ctx.lineTo(timeLinePos, capHeight);\r\n          this._ctx.closePath();\r\n          this._ctx.stroke();\r\n        } else if (capStyle.capType === TimelineCapShape.Rect) {\r\n          this._ctx.fillRect(timeLinePos - capSize / 2, y, capSize, capHeight);\r\n          this._ctx.fill();\r\n        }\r\n      }\r\n    } finally {\r\n      this._ctx.restore();\r\n    }\r\n  };\r\n  _renderHeaderBackground = (): void => {\r\n    if (!this._ctx || !this._options) {\r\n      return;\r\n    }\r\n    if (TimelineStyleUtils.headerHeight(this._options)) {\r\n      this._ctx.save();\r\n      // draw ticks background\r\n      this._ctx.lineWidth = this._pixelRatio;\r\n      if (this._options.headerFillColor) {\r\n        // draw ticks background\r\n        this._ctx.lineWidth = this._pixelRatio;\r\n        // draw header background\r\n        this._ctx.fillStyle = this._options.headerFillColor;\r\n        this._ctx.fillRect(0, 0, this._canvasClientWidth(), TimelineStyleUtils.headerHeight(this._options));\r\n      } else {\r\n        this._ctx.clearRect(0, 0, this._canvasClientWidth(), TimelineStyleUtils.headerHeight(this._options));\r\n      }\r\n      this._ctx.restore();\r\n    }\r\n  };\r\n\r\n  redraw = (): void => {\r\n    if (window.requestAnimationFrame) {\r\n      window.requestAnimationFrame(this._redrawInternal);\r\n    } else {\r\n      this._redrawInternal();\r\n    }\r\n  };\r\n\r\n  /**\r\n   * perform scroll to max right.\r\n   */\r\n  public scrollToRightBounds = (): void => {\r\n    if (this._scrollContainer && this._scrollContainer.scrollLeft !== this._scrollContainer.scrollWidth) {\r\n      this.scrollLeft = this._scrollContainer.scrollWidth;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Redraw parts of the component in the specific order.\r\n   */\r\n  _redrawInternal = (): void => {\r\n    if (!this._ctx || !this._scrollContainer) {\r\n      console.log('Context is not initialized');\r\n      return;\r\n    }\r\n    // Rescale when animation is played out of the bounds.\r\n    if (this.valToPx(this._val) > this._scrollContainer.scrollWidth) {\r\n      this.rescale();\r\n      if (!this._isPanStarted && this._drag && this._drag.type !== TimelineElementType.Timeline) {\r\n        this.scrollToRightBounds();\r\n      }\r\n    }\r\n\r\n    this._renderBackground();\r\n    this._renderRows();\r\n    // Render after rows\r\n    this._renderHeaderBackground();\r\n    this._renderTicks();\r\n    this._renderKeyframes();\r\n    this._renderSelectionRect();\r\n    this._renderTimeline();\r\n  };\r\n\r\n  /**\r\n   * Find sharp pixel position\r\n   */\r\n  _getSharp = (pos: number, thickness = 1): number => {\r\n    pos = Math.round(pos);\r\n    if (thickness % 2 == 0) {\r\n      return pos;\r\n    }\r\n\r\n    return pos + this._pixelRatio / 2;\r\n  };\r\n\r\n  /**\r\n   * Get current time:\r\n   */\r\n  public getTime = (): number => {\r\n    return this._val;\r\n  };\r\n\r\n  /**\r\n   * Set current time internal\r\n   * @param val value.\r\n   * @param source event source.\r\n   */\r\n  _setTimeInternal = (val: number, source: TimelineEventSource = TimelineEventSource.Programmatically): boolean => {\r\n    if (!this._options) {\r\n      return false;\r\n    }\r\n    val = Math.round(val);\r\n    val = TimelineUtils.keepInBounds(val, this._options.min);\r\n    if (this._val != val) {\r\n      const prevVal = this._val;\r\n      const timelineEvent = new TimelineTimeChangedEvent();\r\n      timelineEvent.val = val;\r\n      timelineEvent.prevVal = prevVal;\r\n      timelineEvent.source = source;\r\n      this._val = val;\r\n      this.emit(TimelineEvents.TimeChanged, timelineEvent);\r\n      if (timelineEvent.isPrevented()) {\r\n        this._val = prevVal;\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  };\r\n  public setTime = (val: number): boolean => {\r\n    // don't allow to change time during drag:\r\n    if (this._drag && this._drag.type === TimelineElementType.Timeline) {\r\n      return false;\r\n    }\r\n\r\n    const isChanged = this._setTimeInternal(val, TimelineEventSource.SetTimeMethod);\r\n    if (isChanged) {\r\n      this.rescale();\r\n      this.redraw();\r\n    }\r\n\r\n    return isChanged;\r\n  };\r\n\r\n  public getOptions = (): TimelineOptions => {\r\n    return this._options;\r\n  };\r\n\r\n  /**\r\n   * Current scroll left position.\r\n   */\r\n  public get scrollLeft(): number {\r\n    return this._scrollContainer?.scrollLeft || 0;\r\n  }\r\n  public set scrollLeft(value: number) {\r\n    if (this._scrollContainer && this._scrollContainer.scrollLeft !== value) {\r\n      this._scrollProgrammatically = true;\r\n      this._scrollContainer.scrollLeft = value;\r\n    }\r\n  }\r\n  public get scrollTop(): number {\r\n    return this._scrollContainer?.scrollTop || 0;\r\n  }\r\n\r\n  public set scrollTop(value: number) {\r\n    if (this._scrollContainer && this._scrollContainer.scrollTop !== value) {\r\n      this._scrollProgrammatically = true;\r\n      this._scrollContainer.scrollTop = value;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set options and render the component.\r\n   * Note: Options will be merged\\appended with the defaults and component will be invalidated/rendered again.\r\n   */\r\n  public setOptions = (toSet: TimelineOptions): TimelineOptions => {\r\n    this._options = this._setOptions(toSet);\r\n    this.rescale();\r\n    this.redraw();\r\n    // Merged options:\r\n    return this._options;\r\n  };\r\n\r\n  /**\r\n   * Private. Apply html container styles from options if any is set.\r\n   */\r\n  _applyContainersStyles = (): void => {\r\n    if (this._scrollContainer && this._options) {\r\n      const classList = this._scrollContainer.classList;\r\n      if (this._options.scrollContainerClass && !classList.contains(this._options.scrollContainerClass)) {\r\n        classList.add(this._options.scrollContainerClass);\r\n      }\r\n      if (this._options.fillColor) {\r\n        this._scrollContainer.style.background = this._options.fillColor;\r\n      }\r\n    }\r\n  };\r\n  _setOptions = (toSet: TimelineOptions): TimelineOptions => {\r\n    if (!toSet) {\r\n      return this._options || {};\r\n    }\r\n    this._options = TimelineUtils.mergeOptions(this._options, toSet);\r\n    // Normalize and validate spans per value.\r\n    this._options.snapStep = TimelineUtils.keepInBounds(this._options.snapStep || 0, 0, this._options.stepVal || 0);\r\n    this._currentZoom = this._setZoom(this._options.zoom || 0, this._options.zoomMin, this._options.zoomMax);\r\n    this._options.min = TimelineUtils.isNumber(this._options.min) ? this._options.min : 0;\r\n    this._options.max = TimelineUtils.isNumber(this._options.max) ? this._options.max : Number.MAX_VALUE;\r\n    this._applyContainersStyles();\r\n    // Prevent current active dragging of the timeline, while it's set that it's not allowed anymore.\r\n    if (toSet.timelineDraggable === false) {\r\n      if (this._drag && this._drag.type === TimelineElementType.Timeline) {\r\n        this._cleanUpSelection();\r\n      }\r\n    }\r\n    return this._options;\r\n  };\r\n\r\n  /**\r\n   * Get current model.\r\n   */\r\n  public getModel = (): TimelineModel | null => {\r\n    return this._model;\r\n  };\r\n\r\n  /**\r\n   * Set model and redraw application.\r\n   * @param data\r\n   */\r\n  public setModel = (data: TimelineModel): void => {\r\n    this._model = data;\r\n    this.rescale();\r\n    this.redraw();\r\n  };\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  _getMousePos = (canvas: HTMLCanvasElement, e: TouchEvent | MouseEvent | any): TimelineMouseData => {\r\n    let radius = 1;\r\n    let clientX = 0;\r\n    let clientY = 0;\r\n    if (e.changedTouches && e.changedTouches.length > 0) {\r\n      // TODO: implement better touch support\r\n      const touch = e.changedTouches[0];\r\n      clientX = touch.clientX;\r\n      clientY = touch.clientY;\r\n      radius = Math.max(radius, touch.radiusX, touch.radiusY);\r\n    } else {\r\n      clientX = e.clientX;\r\n      clientY = e.clientY;\r\n    }\r\n\r\n    const rect = canvas.getBoundingClientRect(), // abs. size of element\r\n      scaleX = canvas.width / this._pixelRatio / rect.width, // relationship bitmap vs. element for X\r\n      scaleY = canvas.height / this._pixelRatio / rect.height; // relationship bitmap vs. element for Y\r\n\r\n    const x = (clientX - rect.left) * scaleX;\r\n    const y = (clientY - rect.top) * scaleY;\r\n    // scale mouse coordinates after they have been adjusted to be relative to element\r\n    return {\r\n      pos: { x, y } as DOMPoint,\r\n      radius,\r\n      args: e,\r\n    } as TimelineMouseData;\r\n  };\r\n\r\n  /**\r\n   * Apply container div size to the container on changes detected.\r\n   */\r\n  _updateCanvasScale = (): boolean => {\r\n    if (!this._scrollContainer || !this._container || !this._ctx) {\r\n      console.log('Component should be initialized first.');\r\n      return false;\r\n    }\r\n    let changed = false;\r\n    const width = this._scrollContainer.clientWidth * this._pixelRatio;\r\n    const height = this._scrollContainer.clientHeight * this._pixelRatio;\r\n    if (Math.floor(width) != Math.floor(this._ctx.canvas.width)) {\r\n      this._ctx.canvas.width = width;\r\n      changed = true;\r\n    }\r\n\r\n    if (Math.floor(height) != Math.floor(this._ctx.canvas.height)) {\r\n      this._ctx.canvas.height = height;\r\n      changed = true;\r\n    }\r\n\r\n    if (changed) {\r\n      this._ctx.setTransform(this._pixelRatio, 0, 0, this._pixelRatio, 0, 0);\r\n    }\r\n    return changed;\r\n  };\r\n\r\n  /**\r\n   * Rescale and update size of the container.\r\n   */\r\n  public rescale = (): boolean => {\r\n    return this._rescaleInternal();\r\n  };\r\n\r\n  /**\r\n   * This method is used to draw additional space when after there are no keyframes.\r\n   * When scrolled we should allow to indefinitely scroll right, so space should be extended to drag keyframes outside of the current size bounds.\r\n   */\r\n  _rescaleInternal = (newWidth: number | null = null, newHeight: number | null = null, scrollMode = TimelineScrollSource.DefaultMode): boolean => {\r\n    let changed = this._updateCanvasScale();\r\n    if (!this._scrollContent) {\r\n      return changed;\r\n    }\r\n    const data = this._generateViewModel();\r\n    if (data && data.size) {\r\n      const additionalOffset = this._options.stepPx || 0;\r\n      newWidth = newWidth || 0;\r\n      // content should be not less than current timeline position + width of the timeline\r\n      const timelineGlobalPos = this.valToPx(this._val) + this._leftMargin();\r\n      let timelinePos = 0;\r\n      const rightPosition = this.scrollLeft + this.getClientWidth();\r\n\r\n      if (timelineGlobalPos >= rightPosition) {\r\n        if (scrollMode == TimelineScrollSource.ScrollBySelection) {\r\n          // When item (timeline, selection rectangle) is just dragged to the right corner.\r\n          timelinePos = Math.floor(timelineGlobalPos + this._leftMargin());\r\n        } else {\r\n          // When timeline is playing and we need to add next screen (when timeline goes out of the bounds.)\r\n          timelinePos = Math.floor(timelineGlobalPos + this.getClientWidth() + this._leftMargin());\r\n        }\r\n      }\r\n      const keyframeW = data.size.width + this._leftMargin() + additionalOffset;\r\n\r\n      newWidth = Math.max(\r\n        // New expected component width.\r\n        newWidth,\r\n        // keyframes max width\r\n        keyframeW,\r\n        // not less than current scroll position\r\n        rightPosition,\r\n        timelinePos,\r\n      );\r\n\r\n      const minWidthPx = Math.floor(newWidth) + 'px';\r\n      if (minWidthPx != this._scrollContent.style.minWidth) {\r\n        this._scrollContent.style.minWidth = minWidthPx;\r\n        changed = true;\r\n      }\r\n\r\n      newHeight = Math.max(\r\n        // active size\r\n        Math.floor(data.size.height + this._canvasClientHeight() * 0.2),\r\n        (this._scrollContainer?.scrollTop || 0) + this._canvasClientHeight() - 1,\r\n        Math.round(newHeight || 0),\r\n      );\r\n\r\n      const h = Math.floor(newHeight) + 'px';\r\n      if (this._scrollContent.style.minHeight != h) {\r\n        this._scrollContent.style.minHeight = h;\r\n        return changed;\r\n      }\r\n    }\r\n    return changed;\r\n  };\r\n\r\n  /**\r\n   * Filter elements that can be dragged.\r\n   * Filtration is done based on the timeline styles and options.\r\n   */\r\n  _filterDraggableElements = (elements: TimelineElement[]): TimelineElement[] => {\r\n    // filter and sort: Timeline, individual keyframes, groups (distance).\r\n    const filteredElements = elements.filter((element) => {\r\n      if (!element) {\r\n        return false;\r\n      }\r\n      if (element.type === TimelineElementType.Keyframe) {\r\n        if (!TimelineStyleUtils.keyframeDraggable(element.keyframe || null, element.keyframe?.group || null, element?.row || null, this._options)) {\r\n          return false;\r\n        }\r\n      } else if (element.type === TimelineElementType.Group) {\r\n        if (!TimelineStyleUtils.groupDraggable(element.group || null, element.row || null, this._options)) {\r\n          return false;\r\n        }\r\n      } else if (element.type === TimelineElementType.Timeline) {\r\n        if (this._options?.timelineDraggable === false) {\r\n          return false;\r\n        }\r\n      } else if (element.type === TimelineElementType.Row) {\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n    return filteredElements;\r\n  };\r\n  /**\r\n   * Filter and sort draggable elements by the priority to get first draggable element closest to the passed value.\r\n   */\r\n  _findDraggableElement = (elements: TimelineElement[], val: number | null = null): TimelineElement | null => {\r\n    // filter and sort: Timeline, individual keyframes, groups (distance).\r\n    const getPriority = (type: TimelineElementType): number => {\r\n      if (type === TimelineElementType.Timeline) {\r\n        return 1;\r\n      } else if (type === TimelineElementType.Keyframe) {\r\n        return 2;\r\n      } else if (type === TimelineElementType.Group) {\r\n        return 3;\r\n      }\r\n      return -1;\r\n    };\r\n\r\n    const sortDraggable = (a: TimelineElement, b: TimelineElement): number => {\r\n      let prioA = getPriority(a.type);\r\n      let prioB = getPriority(b.type);\r\n      if (prioA === prioB) {\r\n        if (val === null) {\r\n          return 0;\r\n        }\r\n\r\n        // Sort by distance\r\n        prioA = TimelineUtils.getDistance(a.val, val);\r\n        prioB = TimelineUtils.getDistance(b.val, val);\r\n        if (prioA === prioB) {\r\n          return 0;\r\n        }\r\n        return prioA < prioB ? 1 : -1;\r\n      }\r\n\r\n      return prioA < prioB ? 1 : -1;\r\n    };\r\n    const sorted = this._filterDraggableElements(elements).sort(sortDraggable);\r\n    if (sorted.length > 0) {\r\n      return sorted[sorted.length - 1];\r\n    }\r\n\r\n    return null;\r\n  };\r\n  /**\r\n   * get all clickable elements by the given local screen coordinate.\r\n   */\r\n  public elementFromPoint = (pos: DOMPoint, clickRadius: number, onlyTypes?: TimelineElementType[] | null): TimelineElement[] => {\r\n    clickRadius = Math.max(clickRadius, 1);\r\n    const toReturn: TimelineElement[] = [];\r\n\r\n    if (!pos) {\r\n      return toReturn;\r\n    }\r\n\r\n    const headerHeight = TimelineStyleUtils.headerHeight(this._options);\r\n    // Check whether we can drag timeline.\r\n    const timeLinePos = this._toScreenPx(this._val);\r\n    let width = 0;\r\n    const timelineStyle = this._options?.timelineStyle;\r\n    if (timelineStyle) {\r\n      width = Math.max((timelineStyle.width || 1) * this._pixelRatio, (timelineStyle?.capStyle?.width || 0) * this._pixelRatio || 1) + clickRadius;\r\n    }\r\n    // Allow to select timeline only by half of a header to allow select by a selector top most keyframes row.\r\n    if (pos.y <= headerHeight * 0.5 || (pos.x >= timeLinePos - width / 2 && pos.x <= timeLinePos + width / 2)) {\r\n      toReturn.push({\r\n        val: this._val,\r\n        type: TimelineElementType.Timeline,\r\n      } as TimelineElement);\r\n    }\r\n    const snap = this._options.snapEnabled;\r\n    if (pos.y >= headerHeight && this._options.keyframesDraggable) {\r\n      this._forEachKeyframe((keyframeViewModel, _, isNextRow): void => {\r\n        const rowViewModel = keyframeViewModel.rowViewModel;\r\n        // Check keyframes group overlap\r\n        if (isNextRow) {\r\n          const rowOverlapped = TimelineUtils.isOverlap(pos.x, pos.y, rowViewModel.size);\r\n          if (rowOverlapped) {\r\n            const row = {\r\n              val: this._mousePosToVal(pos.x, snap),\r\n              keyframes: rowViewModel.model.keyframes,\r\n              type: TimelineElementType.Row,\r\n              row: rowViewModel.model,\r\n            } as TimelineElement;\r\n            toReturn.push(row);\r\n          }\r\n          if (rowViewModel.groupsViewModels) {\r\n            rowViewModel.groupsViewModels.forEach((groupViewModel) => {\r\n              if (!groupViewModel?.size) {\r\n                return;\r\n              }\r\n              const keyframesGroupOverlapped = TimelineUtils.isOverlap(pos.x, pos.y, groupViewModel.size);\r\n              if (keyframesGroupOverlapped) {\r\n                const keyframesModels = groupViewModel?.keyframesViewModels.map((p) => p.model) || [];\r\n                const groupElement = {\r\n                  // TODO:\r\n                  val: this._mousePosToVal(pos.x, snap),\r\n                  type: TimelineElementType.Group,\r\n                  group: groupViewModel.groupModel,\r\n                  row: rowViewModel.model,\r\n                  keyframes: keyframesModels,\r\n                } as TimelineElement;\r\n\r\n                const snapped = this.snapVal(groupViewModel.min);\r\n                // get snapped mouse pos based on a min value.\r\n                groupElement.val += groupViewModel.min - snapped;\r\n                toReturn.push(groupElement);\r\n              }\r\n            });\r\n          }\r\n        }\r\n\r\n        const keyframePosRect = keyframeViewModel.size;\r\n        if (keyframePosRect) {\r\n          let isMouseOver = false;\r\n          if (keyframeViewModel.shape === TimelineKeyframeShape.Rect) {\r\n            const extendedMouseRect = TimelineUtils.shrinkSelf({ x: pos.x, y: pos.y, height: clickRadius, width: clickRadius } as DOMRect, clickRadius);\r\n            isMouseOver = TimelineUtils.isRectIntersects(extendedMouseRect, keyframePosRect, true);\r\n          } else {\r\n            const dist = TimelineUtils.getDistance(keyframePosRect.x, keyframePosRect.y, pos.x, pos.y);\r\n            isMouseOver = dist <= keyframePosRect.height + clickRadius;\r\n          }\r\n          if (isMouseOver) {\r\n            toReturn.push({\r\n              keyframe: keyframeViewModel.model,\r\n              keyframes: [keyframeViewModel.model],\r\n              val: keyframeViewModel.model.val,\r\n              row: keyframeViewModel.rowViewModel.model,\r\n              type: TimelineElementType.Keyframe,\r\n            } as TimelineElement);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!onlyTypes || onlyTypes.length === 0) {\r\n      return toReturn;\r\n    } else {\r\n      return toReturn.filter((p) => onlyTypes && onlyTypes.includes(p.type));\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Subscribe user callback on time changed.\r\n   */\r\n  public onTimeChanged = (callback: (eventArgs: TimelineTimeChangedEvent) => void): void => {\r\n    this.on(TimelineEvents.TimeChanged, callback);\r\n  };\r\n  /**\r\n   * Subscribe user callback on drag started event.\r\n   */\r\n  public onDragStarted = (callback: (eventArgs: TimelineDragEvent) => void): void => {\r\n    this.on(TimelineEvents.DragStarted, callback);\r\n  };\r\n  /**\r\n   * Subscribe user callback on drag event.\r\n   */\r\n  public onDrag = (callback: (eventArgs: TimelineDragEvent) => void): void => {\r\n    this.on(TimelineEvents.Drag, callback);\r\n  };\r\n  /**\r\n   * Subscribe user callback on drag finished event.\r\n   */\r\n  public onDragFinished = (callback: (eventArgs: TimelineDragEvent) => void): void => {\r\n    this.on(TimelineEvents.DragFinished, callback);\r\n  };\r\n  /**\r\n   * Subscribe user callback on double click.\r\n   */\r\n  public onDoubleClick = (callback: (eventArgs: TimelineClickEvent) => void): void => {\r\n    this.on(TimelineEvents.DoubleClick, callback);\r\n  };\r\n  /**\r\n   * Subscribe user callback on keyframe changed event.\r\n   */\r\n  public onKeyframeChanged = (callback: (eventArgs: TimelineKeyframeChangedEvent) => void): void => {\r\n    this.on(TimelineEvents.KeyframeChanged, callback);\r\n  };\r\n  /**\r\n   * Subscribe user callback on drag finished event.\r\n   */\r\n  public onMouseDown = (callback: (eventArgs: TimelineClickEvent) => void): void => {\r\n    this.on(TimelineEvents.MouseDown, callback);\r\n  };\r\n\r\n  /**\r\n   * Subscribe user callback on selected.\r\n   */\r\n  public onSelected = (callback: (eventArgs: TimelineSelectedEvent) => void): void => {\r\n    this.on(TimelineEvents.Selected, callback);\r\n  };\r\n  /**\r\n   * Subscribe user callback on scroll event\r\n   */\r\n  public onScroll = (callback: (eventArgs: TimelineScrollEvent) => void): void => {\r\n    this.on(TimelineEvents.Scroll, callback);\r\n  };\r\n  /**\r\n * Subscribe user callback on scroll event\r\n */\r\n  public onZoom = (callback: (eventArgs: TimelineScrollEvent) => void): void => {\r\n    this.on(TimelineEvents.Zoom, callback);\r\n  };\r\n  /**\r\n   * Subscribe on scroll finished event.\r\n   */\r\n  public onScrollFinished = (callback: (eventArgs: TimelineScrollEvent) => void): void => {\r\n    this.on(TimelineEvents.ScrollFinished, callback);\r\n  };\r\n  /**\r\n   * Private.\r\n   * Emit internally scroll eve\r\n   */\r\n  _emitScrollEvent = (args: Event | null, scrollProgrammatically: boolean, eventType = TimelineEvents.Scroll): TimelineScrollEvent => {\r\n    const scrollEvent = {\r\n      args: args,\r\n      scrollProgrammatically: scrollProgrammatically,\r\n      scrollLeft: this.scrollLeft,\r\n      scrollTop: this.scrollTop,\r\n      scrollHeight: this._scrollContainer?.scrollHeight || 0,\r\n      scrollWidth: this._scrollContainer?.scrollWidth || 0,\r\n    } as TimelineScrollEvent;\r\n    super.emit(eventType, scrollEvent);\r\n    return scrollEvent;\r\n  };\r\n  /**\r\n   * zoom\r\n   * @param args \r\n   * @param scrollProgrammatically \r\n   * @param eventType \r\n   * @returns \r\n   */\r\n  _emitZoomEvent = (args: Event | null, scrollProgrammatically: boolean, eventType = TimelineEvents.Zoom): TimelineScrollEvent => {\r\n    const zoomEvent = {\r\n      args: args\r\n    } as TimelineScrollEvent;\r\n    super.emit(eventType, zoomEvent);\r\n    return zoomEvent;\r\n  };\r\n  _emitKeyframeChanged = (element: TimelineElementDragState, source: TimelineEventSource = TimelineEventSource.Programmatically): TimelineKeyframeChangedEvent => {\r\n    const args = new TimelineKeyframeChangedEvent();\r\n    args.val = element.val;\r\n    args.prevVal = element.prevVal;\r\n    args.target = element;\r\n    args.source = source;\r\n    this.emit(TimelineEvents.KeyframeChanged, args);\r\n    return args;\r\n  };\r\n  _emitDragStartedEvent = (dragState: TimelineDraggableData): TimelineDragEvent | null => {\r\n    if (!dragState) {\r\n      return null;\r\n    }\r\n    const args = this._getDragEventArgs(dragState, this._currentPos);\r\n    this.emit(TimelineEvents.DragStarted, args);\r\n    if (args.isPrevented()) {\r\n      this._preventDrag(args, dragState, true);\r\n    }\r\n    return args;\r\n  };\r\n  /**\r\n   * Private emit timeline event that dragging element is finished.\r\n   * @param forcePrevent - needed when during dragging components set to the state when they cannot be dragged anymore. (used only as recovery state).\r\n   * @returns\r\n   */\r\n  _emitDragFinishedEvent = (dragState: TimelineDraggableData, forcePrevent = false): TimelineDragEvent | null => {\r\n    if (!dragState || !dragState.changed) {\r\n      return null;\r\n    }\r\n    const args = this._getDragEventArgs(dragState, this._currentPos);\r\n    if (forcePrevent) {\r\n      args.preventDefault();\r\n    }\r\n    this.emit(TimelineEvents.DragFinished, args);\r\n    if (args.isPrevented()) {\r\n      this._preventDrag(args, dragState, true);\r\n    }\r\n    return args;\r\n  };\r\n  _preventDrag = (dragArgs: TimelineDragEvent, data: TimelineDraggableData, toStart = false): void => {\r\n    if (dragArgs.elements) {\r\n      dragArgs.elements.forEach((element) => {\r\n        const toSet = toStart ? element.startedVal : element.prevVal;\r\n        this._setKeyframePos(element, toSet);\r\n      });\r\n    }\r\n    data.val = data.prevVal;\r\n    // Set prev active point\r\n    dragArgs.point = dragArgs.prevPoint;\r\n  };\r\n  _emitDragEvent = (dragState: TimelineDraggableData): TimelineDragEvent | null => {\r\n    if (!dragState) {\r\n      return null;\r\n    }\r\n    const args = this._getDragEventArgs(dragState, this._currentPos);\r\n    this.emit<TimelineDragEvent>(TimelineEvents.Drag, args);\r\n    if (args.isPrevented()) {\r\n      this._preventDrag(args, dragState, false);\r\n    }\r\n    return args;\r\n  };\r\n  _emitGroupSelected = (state: any): TimelineSelectedEvent => {\r\n    const args = new TimelineSelectedEvent();\r\n    args.selected = state.selected;\r\n    args.changed = state.changed;\r\n    args.drag = state.drag;\r\n    args.mode = state.mode;\r\n    this.emit<TimelineSelectedEvent>(TimelineEvents.Selected, args);\r\n    return args;\r\n  };\r\n  _emitKeyframesSelected = (state: TimelineSelectionResults): TimelineSelectedEvent => {\r\n    const args = new TimelineSelectedEvent();\r\n    args.selected = state.selected;\r\n    args.changed = state.changed;\r\n    this.emit<TimelineSelectedEvent>(TimelineEvents.Selected, args);\r\n    return args;\r\n  };\r\n  _getDragEventArgs = (dragState: TimelineDraggableData, point: TimelineMouseData | null): TimelineDragEvent => {\r\n    const draggableArguments = new TimelineDragEvent();\r\n    draggableArguments.point = point;\r\n    // Get cloned list\r\n    draggableArguments.elements = [...(dragState.elements || [])];\r\n    draggableArguments.target = dragState?.target || null;\r\n    return draggableArguments;\r\n  };\r\n}\r\n","// bundle entry point\r\n\r\nexport * from './timeline';\r\nexport * from './timelineEventsEmitter';\r\nexport * from './settings/timelineConsts';\r\n// @ public timeline models.\r\nexport * from './models/timelineRanged';\r\nexport * from './models/timelineModel';\r\nexport * from './models/timelineRow';\r\nexport * from './models/timelineKeyframe';\r\n\r\n// @public styles\r\nexport * from './settings/timelineOptions';\r\nexport * from './settings/styles/timelineKeyframeStyle';\r\nexport * from './settings/styles/timelineRowStyle';\r\nexport * from './settings/styles/timelineStyle';\r\n\r\nexport * from './utils/timelineStyleUtils';\r\nexport * from './utils/timelineUtils';\r\nexport * from './utils/timelineElement';\r\n\r\n// @private helper containers.\r\nexport * from './utils/timelineSelectable';\r\nexport * from './utils/timelineCutBoundsRectResults';\r\nexport * from './utils/timelineSelectionResults';\r\nexport * from './utils/timelinePoint';\r\nexport * from './utils/timelineMouseData';\r\nexport * from './utils/timelineElementDragState';\r\nexport * from './utils/timelineDraggableData';\r\n\r\n// @private virtual model\r\nexport * from './viewModels/timelineGroupViewModel';\r\nexport * from './viewModels/timelineKeyframeViewModel';\r\nexport * from './viewModels/timelineRowViewModel';\r\nexport * from './viewModels/timelineViewModel';\r\n\r\n// @public events\r\nexport * from './utils/events/timelineKeyframeChangedEvent';\r\nexport * from './utils/events/timelineTimeChangedEvent';\r\nexport * from './utils/events/timelineSelectedEvent';\r\nexport * from './utils/events/timelineScrollEvent';\r\nexport * from './utils/events/timelineClickEvent';\r\nexport * from './utils/events/timelineDragEvent';\r\n\r\n// @public enums\r\nexport * from './enums/timelineKeyframeShape';\r\nexport * from './enums/timelineInteractionMode';\r\nexport * from './enums/timelineScrollSource';\r\nexport * from './enums/timelineElementType';\r\nexport * from './enums/timelineCursorType';\r\nexport * from './enums/timelineCapShape';\r\nexport * from './enums/timelineEventSource';\r\nexport * from './enums/timelineSelectionMode';\r\nexport * from './enums/timelineEvents';\r\n// @private defaults are exposed:\r\nexport * from './settings/defaults/defaultTimelineStyle';\r\nexport * from './settings/defaults/defaultTimelineRowStyle';\r\nexport * from './settings/defaults/defaultTimelineOptions';\r\nexport * from './settings/defaults/defaultTimelineKeyframeStyle';\r\nexport * from './settings/defaults/defaultTimelineConsts';\r\nexport * from './settings/defaults/defaultGroupStyle';\r\n"],"names":["TimelineEventsEmitter","topic","callback","_subscriptions","push","before","length","filter","event","args","forEach","TimelineKeyframeShape","denominators","TimelineUtils","ctx","x1","y1","x2","y2","moveTo","lineTo","val","isNaN","Number","isFinite","array","element","index","indexOf","splice","x","y","rectangle","width","height","originalStep","divisionCheck","step","lastDistance","pow","getPowArgument","i","denominator","calculatedStep","Math","distance","getDistance","value","min","max","isNumber","to","from","shrink","fromMin","NaN","toMin","isFromMinNumber","isToMinNumber","fromMax","toMax","isFromMaxNumber","isToMaxNumber","rect","rect2","touch","console","log","right","bottom","undefined","sqrt","abs","p","window","getSelection","selection","removeAllRanges","doc","document","empty","toCheck","category","s","sign","floor","zerosCount","previousOptions","newOptions","toArg","cloneOptions","mergeOptionsDeep","key","Object","prototype","hasOwnProperty","call","JSON","parse","stringify","clonedValue","id","defaultRowHeight","margin","defaultGroupStyle","marginTop","fillColor","defaultTimelineKeyframeStyle","shape","Rhomb","selectedFillColor","strokeColor","selectedStrokeColor","strokeThickness","defaultTimelineRowStyle","marginBottom","keyframesStyle","groupsStyle","undefinedConst","TimelineStyleUtils","groupModel","style","getGroup","defaultValue","params","getValue","returnFalseIfAnyFalse","valuesFound","found","toReturn","getValueOrDefault","keyframe","group","rowStyle","options","getFirstSet","getGroupStyle","rowsStyle","headerHeight","row","findFirstNegativeBool","boolResult","draggable","keyframesDraggable","groupsDraggable","TimelineElementType","TimelineDraggableData","None","TimelineBaseEvent","_prevented","TimelineKeyframeChangedEvent","TimelineEventSource","TimelineTimeChangedEvent","User","TimelineSelectionEventSource","TimelineSelectedEvent","Keyframes","TimelineClickEvent","point","pos","TimelineDragEvent","TimelineInteractionMode","TimelineCursorType","TimelineCapShape","TimelineSelectionMode","TimelineSelectionType","TimelineEvents","TimelineScrollSource","defaultTimelineConsts","autoPanSpeed","scrollByDragSpeed","clickDetectionMs","doubleClickTimeoutMs","scrollFinishedTimeoutMs","autoPanByScrollPadding","clickThreshold","clickDetectionMinRadius","autoPanSpeedLimit","defaultGroupHeight","defaultTimelineStyle","capStyle","capType","Rect","cursor","EWResize","defaultTimelineOptions","snapAllKeyframesOnMove","snapEnabled","timelineStyle","stepPx","stepVal","stepSmallPx","snapStep","leftMargin","headerFillColor","labelsColor","tickColor","selectionColor","font","zoom","zoomSpeed","zoomMin","zoomMax","controlKeyIsMetaKey","scrollContainerClass","timelineDraggable","MAX_VALUE","Timeline","model","Selection","_model","Error","_generateContainers","_options","_setOptions","_subscribeComponentEvents","rescale","redraw","HTMLElement","_container","getElementById","_scrollContainer","createElement","_scrollContent","_canvas","getContext","position","cssText","appendChild","scrollBarWidth","offsetWidth","clientWidth","_ctx","_getCtx","_unsubscribeComponentEvents","addEventListener","_handleWheelEvent","_handleScrollEvent","_handleScrollMouseDownEvent","_handleKeyUp","_handleKeyDown","_handleBlurEvent","_handleWindowResizeEvent","_handleMouseDownEvent","_handleMouseMoveEvent","_handleMouseUpEvent","removeEventListener","warn","offAll","_stopAutoPan","_clearScrollFinishedTimer","_cleanUpSelection","_interactionMode","Zoom","_setZoomCursor","e","_controlKeyPressed","_setCursor","ZoomOut","ZoomIn","_scrollFinishedTimerRef","clearTimeout","_scrollAreaClickOrDragStarted","scrollProgrammatically","_scrollProgrammatically","setTimeout","_isPanStarted","_emitScrollEvent","ScrollFinished","_consts","metaKey","ctrlKey","preventDefault","mousePosArguments","_getMousePos","mousePos","_zoom","deltaY","scrollTop","direction","speed","deltaSpeed","_canvasClientWidth","diff","_fromScreen","_currentZoom","_setZoom","zoomCenter","valToPx","newScrollLeft","round","_rescaleInternal","ZoomMode","scrollLeft","_emitZoomEvent","keepInBounds","prevZoom","getZoom","zoomSet","_selectInternal","radius","clearBrowserSelection","_startPosMouseArgs","_trackMousePos","isDoubleClick","Date","now","_lastClickTime","_lastClickPoint","_scrollStartPos","_clickAllowed","onlyElements","NonInteractivePan","clickRadius","_getClickDetectionRadius","elements","elementFromPoint","target","_findDraggableElement","DoubleClick","MouseDown","_clickTimeout","isPrevented","_currentPos","_drag","type","_setElementDragState","Keyframe","_groupSelected","_startedDragWithCtrl","_startedDragWithShiftKey","shiftKey","selected","getSelectedElements","map","Group","keyframes","Array","isArray","_convertToTimelineElement","state","prevVal","startedVal","buttons","_lastUsedArgs","touchEventArgs","isTouch","changedTouches","_selectionRect","_clickTimeoutIsOver","_selectionRectEnabled","isLeftClicked","isLeftButtonClicked","convertedVal","_setTimeInternal","offset","movedOffset","_moveElements","changed","eventArgs","_emitDragStartedEvent","_emitDragEvent","Pan","Grabbing","_scrollByPan","_scrollBySelectionOutOfBounds","Grab","Default","Pointer","mouseArgs","_performClick","_getKeyframesByRectangle","selectionMode","Append","Normal","select","clientHeight","screenRect","keyframesModels","_forEachKeyframe","keyframeViewModel","intersects","isRectIntersects","size","isOverlap","drag","isChanged","mode","Revert","selectionChanged","MouseEvent","button","source","Programmatically","_emitKeyframeChanged","rowModel","data","rowViewModel","getAllKeyframes","node","selectable","nodes","results","getSelectedKeyframes","nodesArray","_changeNodeState","deleteElement","selectedItems","exists","_emitKeyframesSelected","_intervalRef","setInterval","clearInterval","_autoPanLastActionDate","_leftMargin","px","pxToVal","steps","snapVal","ms","isSeconds","seconds","year","days","hours","minutes","str","canvas","screenWidth","wasToVal","valDistance","findGoodStep","fromVal","toVal","ceil","smallStep","lastTextStart","save","tickHeight","smallTickHeight","sharpPos","_getSharp","_toScreenPx","beginPath","setLineDash","lineWidth","strokeStyle","drawLine","stroke","fillStyle","text","_formatUnitsText","textSize","measureText","textX","fillText","restore","nextSharpPos","_pixelRatio","rowsViewModels","keyframesViewModels","rows","rowAbsoluteHeight","hidden","rowHeight","getRowHeight","getRowMarginBottom","currentRowY","rowSize","groupsViewModels","groupViewModel","find","keyframeShape","keyframeSize","_getKeyframePosition","setMinMax","groupRect","_getKeyframesGroupSize","viewModel","_generateViewModel","getRowFillColor","bounds","_cutBounds","fillRect","moveStyle","strokeRect","_renderGroupBounds","keyframeLaneColor","groupFillColor","selectedNum","isGroupSelected","rectBounds","testOffset","minX","maxX","minY","maxY","_canvasClientHeight","_cutBoundsWhenOverlap","offsetW","offsetH","overlapY","overlapX","rowY","groupHeight","groupMarginTop","isAutoHeight","parseInt","isAutoMargin","xMin","xMax","keyframeHeight","keyframeWidth","clip","keyframeColor","keyframeSelectedFillColor","keyframeFillColor","border","keyframeStrokeThickness","keyframeSelectedStrokeColor","keyframeStrokeColor","translate","rotate","PI","fill","Circle","arc","thickness","clearRect","timeLinePos","_val","yBottom","canvasHeight","_renderTimelineCap","capSize","capHeight","Triangle","closePath","requestAnimationFrame","_redrawInternal","scrollWidth","scrollToRightBounds","_renderBackground","_renderRows","_renderHeaderBackground","_renderTicks","_renderKeyframes","_renderSelectionRect","_renderTimeline","timelineEvent","emit","TimeChanged","SetTimeMethod","toSet","classList","contains","add","background","mergeOptions","_applyContainersStyles","clientX","clientY","radiusX","radiusY","getBoundingClientRect","scaleX","scaleY","left","top","setTransform","newWidth","newHeight","scrollMode","DefaultMode","_updateCanvasScale","additionalOffset","timelineGlobalPos","timelinePos","rightPosition","getClientWidth","ScrollBySelection","keyframeW","minWidthPx","minWidth","h","minHeight","filteredElements","keyframeDraggable","groupDraggable","Row","getPriority","sortDraggable","a","b","prioA","prioB","sorted","_filterDraggableElements","sort","onlyTypes","snap","_","isNextRow","rowOverlapped","_mousePosToVal","keyframesGroupOverlapped","groupElement","snapped","keyframePosRect","isMouseOver","extendedMouseRect","shrinkSelf","dist","includes","on","DragStarted","Drag","DragFinished","KeyframeChanged","Selected","Scroll","eventType","scrollEvent","scrollHeight","zoomEvent","dragState","_getDragEventArgs","_preventDrag","forcePrevent","dragArgs","toStart","_setKeyframePos","prevPoint","draggableArguments","initialize","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","currentBounds","expectedKeyframeValue","newPosition","newValue","calculatedModel","nextRow","keyframeIndex","clickArgs","originalVal","startPos","_emitDragFinishedEvent","start","scrollStartPos","offsetX","newLeft","speedX","speedY","isLeft","isRight","isTop","isBottom","_startAutoPan","_checkUpdateSpeedTooFast","scrollSpeedMultiplier","stops","stepsFit","minSteps","minOffset"],"sourceRoot":""}